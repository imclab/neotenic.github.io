protobowl_app_build = 'Sat Jul 20 2013 20:15:57 GMT-0400 (EDT)';

var io="undefined"==typeof module?{}:module.exports;!function(){if(function(e,t){var n=e;n.version="0.9.11",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(e,o){var i,r,a=n.util.parseUri(e);t&&t.location&&(a.protocol=a.protocol||t.location.protocol.slice(0,-1),a.host=a.host||(t.document?t.document.domain:t.location.hostname),a.port=a.port||t.location.port),i=n.util.uniqueUri(a);var s={host:a.host,secure:"https"==a.protocol,port:a.port||("https"==a.protocol?443:80),query:a.query||""};return n.util.merge(s,o),(s["force new connection"]||!n.sockets[i])&&(r=new n.Socket(s)),!s["force new connection"]&&r&&(n.sockets[i]=r),r=r||n.sockets[i],r.of(a.path.length>1?a.path:"")}}("object"==typeof module?module.exports:io,this),function(e,t){var n=e.util={},o=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(e){for(var t=o.exec(e||""),n={},r=14;r--;)n[i[r]]=t[r]||"";return n},n.uniqueUri=function(e){var n=e.protocol,o=e.host,i=e.port;return"document"in t?(o=o||document.domain,i=i||("https"==n&&"https:"!==document.location.protocol?443:document.location.port)):(o=o||"localhost",i||"https"!=n||(i=443)),(n||"http")+"://"+o+":"+(i||80)},n.query=function(e,t){var o=n.chunkQuery(e||""),i=[];n.merge(o,n.chunkQuery(t||""));for(var r in o)o.hasOwnProperty(r)&&i.push(r+"="+o[r]);return i.length?"?"+i.join("&"):""},n.chunkQuery=function(e){for(var t,n={},o=e.split("&"),i=0,r=o.length;r>i;++i)t=o[i].split("="),t[0]&&(n[t[0]]=t[1]);return n};var r=!1;n.load=function(e){return"document"in t&&"complete"===document.readyState||r?e():(n.on(t,"load",e,!1),void 0)},n.on=function(e,t,n,o){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,o)},n.request=function(e){if(e&&"undefined"!=typeof XDomainRequest&&!n.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||n.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}return null},"undefined"!=typeof window&&n.load(function(){r=!0}),n.defer=function(e){return n.ua.webkit&&"undefined"==typeof importScripts?(n.load(function(){setTimeout(e,100)}),void 0):e()},n.merge=function(e,t,o,i){var r,a=i||[],s="undefined"==typeof o?2:o;for(r in t)t.hasOwnProperty(r)&&n.indexOf(a,r)<0&&("object"==typeof e[r]&&s?n.merge(e[r],t[r],s-1,a):(e[r]=t[r],a.push(t[r])));return e},n.mixin=function(e,t){n.merge(e.prototype,t.prototype)},n.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.intersect=function(e,t){for(var o=[],i=e.length>t.length?e:t,r=e.length>t.length?t:e,a=0,s=r.length;s>a;a++)~n.indexOf(i,r[a])&&o.push(r[a]);return o},n.indexOf=function(e,t,n){for(var o=e.length,n=0>n?0>n+o?0:n+o:n||0;o>n&&e[n]!==t;n++);return n>=o?-1:n},n.toArray=function(e){for(var t=[],n=0,o=e.length;o>n;n++)t.push(e[n]);return t},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return void 0!=e.withCredentials}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),n.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,t){function n(){}e.EventEmitter=n,n.prototype.on=function(e,n){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(n):this.$events[e]=[this.$events[e],n]:this.$events[e]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(e,t){function n(){o.removeListener(e,n),t.apply(this,arguments)}var o=this;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,n){if(this.$events&&this.$events[e]){var o=this.$events[e];if(t.util.isArray(o)){for(var i=-1,r=0,a=o.length;a>r;r++)if(o[r]===n||o[r].listener&&o[r].listener===n){i=r;break}if(0>i)return this;o.splice(i,1),o.length||delete this.$events[e]}else(o===n||o.listener&&o.listener===n)&&delete this.$events[e]}return this},n.prototype.removeAllListeners=function(e){return void 0===e?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},n.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},n.prototype.emit=function(e){if(!this.$events)return!1;var n=this.$events[e];if(!n)return!1;var o=Array.prototype.slice.call(arguments,1);if("function"==typeof n)n.apply(this,o);else{if(!t.util.isArray(n))return!1;for(var i=n.slice(),r=0,a=i.length;a>r;r++)i[r].apply(this,o)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){"use strict";function f(e){return 10>e?"0"+e:e}function date(e){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,o,i,r,a,s=gap,u=t[e];switch(u instanceof Date&&(u=date(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(u)){for(r=u.length,n=0;r>n;n+=1)a[n]=str(n,u)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;r>n;n+=1)"string"==typeof rep[n]&&(o=rep[n],i=str(o,u),i&&a.push(quote(o)+(gap?": ":":")+i));else for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(i=str(o,u),i&&a.push(quote(o)+(gap?": ":":")+i));return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,n){var o;if(gap="",indent="","number"==typeof n)for(o=0;n>o;o+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})},JSON.parse=function(text,reviver){function walk(e,t){var n,o,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(o=walk(i,n),void 0!==o?i[n]=o:delete i[n]);return reviver.call(e,t,i)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var n=e.parser={},o=n.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],i=n.reasons=["transport not supported","client not handshaken","unauthorized"],r=n.advice=["reconnect"],a=t.JSON,s=t.util.indexOf;n.encodePacket=function(e){var t=s(o,e.type),n=e.id||"",u=e.endpoint||"",l=e.ack,c=null;switch(e.type){case"error":var h=e.reason?s(i,e.reason):"",d=e.advice?s(r,e.advice):"";(""!==h||""!==d)&&(c=h+(""!==d?"+"+d:""));break;case"message":""!==e.data&&(c=e.data);break;case"event":var f={name:e.name};e.args&&e.args.length&&(f.args=e.args),c=a.stringify(f);break;case"json":c=a.stringify(e.data);break;case"connect":e.qs&&(c=e.qs);break;case"ack":c=e.ackId+(e.args&&e.args.length?"+"+a.stringify(e.args):"")}var p=[t,n+("data"==l?"+":""),u];return null!==c&&void 0!==c&&p.push(c),p.join(":")},n.encodePayload=function(e){var t="";if(1==e.length)return e[0];for(var n=0,o=e.length;o>n;n++){var i=e[n];t+="�"+i.length+"�"+e[n]}return t};var u=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;n.decodePacket=function(e){var t=e.match(u);if(!t)return{};var n=t[2]||"",e=t[5]||"",s={type:o[t[1]],endpoint:t[4]||""};switch(n&&(s.id=n,s.ack=t[3]?"data":!0),s.type){case"error":var t=e.split("+");s.reason=i[t[0]]||"",s.advice=r[t[1]]||"";break;case"message":s.data=e||"";break;case"event":try{var l=a.parse(e);s.name=l.name,s.args=l.args}catch(c){}s.args=s.args||[];break;case"json":try{s.data=a.parse(e)}catch(c){}break;case"connect":s.qs=e||"";break;case"ack":var t=e.match(/^([0-9]+)(\+)?(.*)/);if(t&&(s.ackId=t[1],s.args=[],t[3]))try{s.args=t[3]?a.parse(t[3]):[]}catch(c){}break;case"disconnect":case"heartbeat":}return s},n.decodePayload=function(e){if("�"==e.charAt(0)){for(var t=[],o=1,i="";o<e.length;o++)"�"==e.charAt(o)?(t.push(n.decodePacket(e.substr(o+1).substr(0,i))),o+=Number(i)+1,i=""):i+=e.charAt(o);return t}return[n.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function n(e,t){this.socket=e,this.sessid=t}e.Transport=n,t.util.mixin(n,t.EventEmitter),n.prototype.heartbeats=function(){return!0},n.prototype.onData=function(e){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e){var n=t.parser.decodePayload(e);if(n&&n.length)for(var o=0,i=n.length;i>o;o++)this.onPacket(n[o])}return this},n.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),"error"==e.type&&"reconnect"==e.advice&&(this.isOpen=!1),this.socket.onPacket(e),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},n.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},n.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function o(e){if(this.options={port:80,secure:!1,document:"document"in n?document:!1,resource:"socket.io",transports:t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var o=this;t.util.on(n,"beforeunload",function(){o.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function i(){}e.Socket=o,t.util.mixin(o,t.EventEmitter),o.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},o.prototype.publish=function(){this.emit.apply(this,arguments);var e;for(var t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},o.prototype.handshake=function(e){function n(t){t instanceof Error?(o.connecting=!1,o.onError(t.message)):e.apply(null,t.split(":"))}var o=this,r=this.options,a=["http"+(r.secure?"s":"")+":/",r.host+":"+r.port,r.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var s=document.getElementsByTagName("script")[0],u=document.createElement("script");u.src=a+"&jsonp="+t.j.length,s.parentNode.insertBefore(u,s),t.j.push(function(e){n(e),u.parentNode.removeChild(u)})}else{var l=t.util.request();l.open("GET",a,!0),this.isXDomain()&&(l.withCredentials=!0),l.onreadystatechange=function(){4==l.readyState&&(l.onreadystatechange=i,200==l.status?n(l.responseText):403==l.status?o.onError(l.responseText):(o.connecting=!1,!o.reconnecting&&o.onError(l.responseText)))},l.send(null)}},o.prototype.getTransport=function(e){for(var n,o=e||this.transports,i=0;n=o[i];i++)if(t.Transport[n]&&t.Transport[n].check(this)&&(!this.isXDomain()||t.Transport[n].xdomainCheck(this)))return new t.Transport[n](this,this.sessionid);return null},o.prototype.connect=function(e){if(this.connecting)return this;var n=this;return n.connecting=!0,this.handshake(function(o,i,r,a){function s(e){return n.transport&&n.transport.clearTimeouts(),n.transport=n.getTransport(e),n.transport?(n.transport.ready(n,function(){n.connecting=!0,n.publish("connecting",n.transport.name),n.transport.open(),n.options["connect timeout"]&&(n.connectTimeoutTimer=setTimeout(function(){if(!n.connected&&(n.connecting=!1,n.options["try multiple transports"])){for(var e=n.transports;e.length>0&&e.splice(0,1)[0]!=n.transport.name;);e.length?s(e):n.publish("connect_failed")}},n.options["connect timeout"]))}),void 0):n.publish("connect_failed")}n.sessionid=o,n.closeTimeout=1e3*r,n.heartbeatTimeout=1e3*i,n.transports||(n.transports=n.origTransports=a?t.util.intersect(a.split(","),n.options.transports):n.options.transports),n.setHeartbeatTimeout(),s(n.transports),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),e&&"function"==typeof e&&e()})}),this},o.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var e=this;this.heartbeatTimeoutTimer=setTimeout(function(){e.transport.onClose()},this.heartbeatTimeout)}},o.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},o.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},o.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},o.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},o.prototype.disconnectSync=function(){var e=t.util.request(),n=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,t.protocol,"",this.sessionid].join("/")+"/?disconnect=1";e.open("GET",n,!1),e.send(null),this.onDisconnect("booted")},o.prototype.isXDomain=function(){var e=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=e},o.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},o.prototype.onOpen=function(){this.open=!0},o.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},o.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},o.prototype.onError=function(e){e&&e.advice&&"reconnect"===e.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},o.prototype.onDisconnect=function(e){var t=this.connected,n=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(t||n)&&(this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},o.prototype.reconnect=function(){function e(){if(n.connected){for(var e in n.namespaces)n.namespaces.hasOwnProperty(e)&&""!==e&&n.namespaces[e].packet({type:"connect"});n.publish("reconnect",n.transport.name,n.reconnectionAttempts)}clearTimeout(n.reconnectionTimer),n.removeListener("connect_failed",t),n.removeListener("connect",t),n.reconnecting=!1,delete n.reconnectionAttempts,delete n.reconnectionDelay,delete n.reconnectionTimer,delete n.redoTransports,n.options["try multiple transports"]=i}function t(){return n.reconnecting?n.connected?e():n.connecting&&n.reconnecting?n.reconnectionTimer=setTimeout(t,1e3):(n.reconnectionAttempts++>=o?n.redoTransports?(n.publish("reconnect_failed"),e()):(n.on("connect_failed",t),n.options["try multiple transports"]=!0,n.transports=n.origTransports,n.transport=n.getTransport(),n.redoTransports=!0,n.connect()):(n.reconnectionDelay<r&&(n.reconnectionDelay*=2),n.connect(),n.publish("reconnecting",n.reconnectionDelay,n.reconnectionAttempts),n.reconnectionTimer=setTimeout(t,n.reconnectionDelay)),void 0):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var n=this,o=this.options["max reconnection attempts"],i=this.options["try multiple transports"],r=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new o(this,"json"),this.ackPackets=0,this.acks={}}function o(e,t){this.namespace=e,this.name=t}e.SocketNamespace=n,t.util.mixin(n,t.EventEmitter),n.prototype.$emit=t.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},n.prototype.send=function(e,t){var n={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=t),this.packet(n)},n.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=t[t.length-1],o={type:"event",name:e};return"function"==typeof n&&(o.id=++this.ackPackets,o.ack="data",this.acks[o.id]=n,t=t.slice(0,t.length-1)),o.args=t,this.packet(o)},n.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(e){function n(){o.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var o=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var i=["message",e.data];"data"==e.ack?i.push(n):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,i);break;case"event":var i=[e.name].concat(e.args);"data"==e.ack&&i.push(n),this.$emit.apply(this,i);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},o.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},o.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function o(){t.Transport.apply(this,arguments)}e.websocket=o,t.util.inherit(o,t.Transport),o.prototype.name="websocket",o.prototype.open=function(){var e,o=t.util.query(this.socket.options.query),i=this;return e||(e=n.MozWebSocket||n.WebSocket),this.websocket=new e(this.prepareUrl()+o),this.websocket.onopen=function(){i.onOpen(),i.socket.setBuffer(!1)},this.websocket.onmessage=function(e){i.onData(e.data)},this.websocket.onclose=function(){i.onClose(),i.socket.setBuffer(!0)},this.websocket.onerror=function(e){i.onError(e)},this},o.prototype.send=t.util.ua.iDevice?function(e){var t=this;return setTimeout(function(){t.websocket.send(e)},0),this}:function(e){return this.websocket.send(e),this},o.prototype.payload=function(e){for(var t=0,n=e.length;n>t;t++)this.packet(e[t]);return this},o.prototype.close=function(){return this.websocket.close(),this},o.prototype.onError=function(e){this.socket.onError(e)},o.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},o.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},o.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.websocket.apply(this,arguments)}e.flashsocket=n,t.util.inherit(n,t.Transport.websocket),n.prototype.name="flashsocket",n.prototype.open=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.open.apply(e,n)}),this},n.prototype.send=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.send.apply(e,n)}),this},n.prototype.close=function(){return WebSocket.__tasks.length=0,t.Transport.websocket.prototype.close.call(this),this},n.prototype.ready=function(e,o){function i(){var t=e.options,i=t["flash policy port"],a=["http"+(t.secure?"s":"")+":/",t.host+":"+t.port,t.resource,"static/flashsocket","WebSocketMain"+(e.isXDomain()?"Insecure":"")+".swf"];n.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=a.join("/")),843!==i&&WebSocket.loadFlashPolicyFile("xmlsocket://"+t.host+":"+i),WebSocket.__initialize(),n.loaded=!0),o.call(r)}var r=this;return document.body?i():(t.util.load(i),void 0)},n.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},n.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),t.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function e(){if(!U){try{var e=N.getElementsByTagName("body")[0].appendChild(g("span"));e.parentNode.removeChild(e)}catch(t){return}U=!0;for(var n=W.length,o=0;n>o;o++)W[o]()}}function t(e){U?e():W[W.length]=e}function n(e){if(typeof q.addEventListener!=D)q.addEventListener("load",e,!1);else if(typeof N.addEventListener!=D)N.addEventListener("load",e,!1);else if(typeof q.attachEvent!=D)y(q,"onload",e);else if("function"==typeof q.onload){var t=q.onload;q.onload=function(){t(),e()}}else q.onload=e}function o(){F?i():r()}function i(){var e=N.getElementsByTagName("body")[0],t=g(A);t.setAttribute("type",O);var n=e.appendChild(t);if(n){var o=0;!function(){if(typeof n.GetVariable!=D){var i=n.GetVariable("$version");i&&(i=i.split(" ")[1].split(","),X.pv=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)])}else if(10>o)return o++,setTimeout(arguments.callee,10),void 0;e.removeChild(t),n=null,r()}()}else r()}function r(){var e=L.length;if(e>0)for(var t=0;e>t;t++){var n=L[t].id,o=L[t].callbackFn,i={success:!1,id:n};if(X.pv[0]>0){var r=m(n);if(r)if(!v(L[t].swfVersion)||X.wk&&X.wk<312)if(L[t].expressInstall&&s()){var c={};c.data=L[t].expressInstall,c.width=r.getAttribute("width")||"0",c.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(c.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(c.align=r.getAttribute("align"));for(var h={},d=r.getElementsByTagName("param"),f=d.length,p=0;f>p;p++)"movie"!=d[p].getAttribute("name").toLowerCase()&&(h[d[p].getAttribute("name")]=d[p].getAttribute("value"));u(c,h,n,o)}else l(r),o&&o(i);else w(n,!0),o&&(i.success=!0,i.ref=a(n),o(i))}else if(w(n,!0),o){var g=a(n);g&&typeof g.SetVariable!=D&&(i.success=!0,i.ref=g),o(i)}}}function a(e){var t=null,n=m(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=D)t=n;else{var o=n.getElementsByTagName(A)[0];o&&(t=o)}return t}function s(){return!B&&v("6.0.65")&&(X.win||X.mac)&&!(X.wk&&X.wk<312)}function u(e,t,n,o){B=!0,C=o||null,x={success:!1,id:n};var i=m(n);if(i){"OBJECT"==i.nodeName?($=c(i),_=null):($=i,_=n),e.id=j,(typeof e.width==D||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==D||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),N.title=N.title.slice(0,47)+" - Flash Player Installation";var r=X.ie&&X.win?["Active"].concat("").join("X"):"PlugIn",a="MMredirectURL="+q.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+N.title;if(typeof t.flashvars!=D?t.flashvars+="&"+a:t.flashvars=a,X.ie&&X.win&&4!=i.readyState){var s=g("div");n+="SWFObjectNew",s.setAttribute("id",n),i.parentNode.insertBefore(s,i),i.style.display="none",function(){4==i.readyState?i.parentNode.removeChild(i):setTimeout(arguments.callee,10)}()}h(e,t,n)}}function l(e){if(X.ie&&X.win&&4!=e.readyState){var t=g("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(c(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(c(e),e)}function c(e){var t=g("div");if(X.win&&X.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(A)[0];if(n){var o=n.childNodes;if(o)for(var i=o.length,r=0;i>r;r++)1==o[r].nodeType&&"PARAM"==o[r].nodeName||8==o[r].nodeType||t.appendChild(o[r].cloneNode(!0))}}return t}function h(e,t,n){var o,i=m(n);if(X.wk&&X.wk<312)return o;if(i)if(typeof e.id==D&&(e.id=n),X.ie&&X.win){var r="";for(var a in e)e[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?t.movie=e[a]:"styleclass"==a.toLowerCase()?r+=' class="'+e[a]+'"':"classid"!=a.toLowerCase()&&(r+=" "+a+'="'+e[a]+'"'));var s="";for(var u in t)t[u]!=Object.prototype[u]&&(s+='<param name="'+u+'" value="'+t[u]+'" />');i.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+s+"</object>",R[R.length]=e.id,o=m(e.id)}else{var l=g(A);l.setAttribute("type",O);for(var c in e)e[c]!=Object.prototype[c]&&("styleclass"==c.toLowerCase()?l.setAttribute("class",e[c]):"classid"!=c.toLowerCase()&&l.setAttribute(c,e[c]));for(var h in t)t[h]!=Object.prototype[h]&&"movie"!=h.toLowerCase()&&d(l,h,t[h]);i.parentNode.replaceChild(l,i),o=l}return o}function d(e,t,n){var o=g("param");o.setAttribute("name",t),o.setAttribute("value",n),e.appendChild(o)}function f(e){var t=m(e);t&&"OBJECT"==t.nodeName&&(X.ie&&X.win?(t.style.display="none",function(){4==t.readyState?p(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function p(e){var t=m(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function m(e){var t=null;try{t=N.getElementById(e)}catch(n){}return t}function g(e){return N.createElement(e)}function y(e,t,n){e.attachEvent(t,n),P[P.length]=[e,t,n]}function v(e){var t=X.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function b(e,t,n,o){if(!X.ie||!X.mac){var i=N.getElementsByTagName("head")[0];if(i){var r=n&&"string"==typeof n?n:"screen";if(o&&(E=null,T=null),!E||T!=r){var a=g("style");a.setAttribute("type","text/css"),a.setAttribute("media",r),E=i.appendChild(a),X.ie&&X.win&&typeof N.styleSheets!=D&&N.styleSheets.length>0&&(E=N.styleSheets[N.styleSheets.length-1]),T=r}X.ie&&X.win?E&&typeof E.addRule==A&&E.addRule(e,t):E&&typeof N.createTextNode!=D&&E.appendChild(N.createTextNode(e+" {"+t+"}"))}}}function w(e,t){if(H){var n=t?"visible":"hidden";U&&m(e)?m(e).style.visibility=n:b("#"+e,"visibility:"+n)}}function k(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=D?encodeURIComponent(e):e}var $,_,C,x,E,T,D="undefined",A="object",S="Shockwave Flash",z="ShockwaveFlash.ShockwaveFlash",O="application/x-shockwave-flash",j="SWFObjectExprInst",I="onreadystatechange",q=window,N=document,M=navigator,F=!1,W=[o],L=[],R=[],P=[],U=!1,B=!1,H=!0,X=function(){var e=typeof N.getElementById!=D&&typeof N.getElementsByTagName!=D&&typeof N.createElement!=D,t=M.userAgent.toLowerCase(),n=M.platform.toLowerCase(),o=n?/win/.test(n):/win/.test(t),i=n?/mac/.test(n):/mac/.test(t),r=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,s=[0,0,0],u=null;if(typeof M.plugins!=D&&typeof M.plugins[S]==A)u=M.plugins[S].description,!u||typeof M.mimeTypes!=D&&M.mimeTypes[O]&&!M.mimeTypes[O].enabledPlugin||(F=!0,a=!1,u=u.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=parseInt(u.replace(/^(.*)\..*$/,"$1"),10),s[1]=parseInt(u.replace(/^.*\.(.*)\s.*$/,"$1"),10),s[2]=/[a-zA-Z]/.test(u)?parseInt(u.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof q[["Active"].concat("Object").join("X")]!=D)try{var l=new(window[["Active"].concat("Object").join("X")])(z);l&&(u=l.GetVariable("$version"),u&&(a=!0,u=u.split(" ")[1].split(","),s=[parseInt(u[0],10),parseInt(u[1],10),parseInt(u[2],10)]))}catch(c){}return{w3:e,pv:s,wk:r,ie:a,win:o,mac:i}}();return function(){X.w3&&((typeof N.readyState!=D&&"complete"==N.readyState||typeof N.readyState==D&&(N.getElementsByTagName("body")[0]||N.body))&&e(),U||(typeof N.addEventListener!=D&&N.addEventListener("DOMContentLoaded",e,!1),X.ie&&X.win&&(N.attachEvent(I,function(){"complete"==N.readyState&&(N.detachEvent(I,arguments.callee),e())}),q==top&&function(){if(!U){try{N.documentElement.doScroll("left")}catch(t){return setTimeout(arguments.callee,0),void 0}e()}}()),X.wk&&function(){return U?void 0:/loaded|complete/.test(N.readyState)?(e(),void 0):(setTimeout(arguments.callee,0),void 0)}(),n(e)))}(),function(){X.ie&&X.win&&window.attachEvent("onunload",function(){for(var e=P.length,t=0;e>t;t++)P[t][0].detachEvent(P[t][1],P[t][2]);for(var n=R.length,o=0;n>o;o++)f(R[o]);for(var i in X)X[i]=null;X=null;for(var r in swfobject)swfobject[r]=null;swfobject=null})}(),{registerObject:function(e,t,n,o){if(X.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=o,L[L.length]=i,w(e,!1)}else o&&o({success:!1,id:e})},getObjectById:function(e){return X.w3?a(e):void 0},embedSWF:function(e,n,o,i,r,a,l,c,d,f){var p={success:!1,id:n};X.w3&&!(X.wk&&X.wk<312)&&e&&n&&o&&i&&r?(w(n,!1),t(function(){o+="",i+="";var t={};if(d&&typeof d===A)for(var m in d)t[m]=d[m];t.data=e,t.width=o,t.height=i;var g={};if(c&&typeof c===A)for(var y in c)g[y]=c[y];if(l&&typeof l===A)for(var b in l)typeof g.flashvars!=D?g.flashvars+="&"+b+"="+l[b]:g.flashvars=b+"="+l[b];if(v(r)){var k=h(t,g,n);t.id==n&&w(n,!0),p.success=!0,p.ref=k}else{if(a&&s())return t.data=a,u(t,g,n,f),void 0;w(n,!0)}f&&f(p)})):f&&f(p)
},switchOffAutoHideShow:function(){H=!1},ua:X,getFlashPlayerVersion:function(){return{major:X.pv[0],minor:X.pv[1],release:X.pv[2]}},hasFlashPlayerVersion:v,createSWF:function(e,t,n){return X.w3?h(e,t,n):void 0},showExpressInstall:function(e,t,n,o){X.w3&&s()&&u(e,t,n,o)},removeSWF:function(e){X.w3&&f(e)},createCSS:function(e,t,n,o){X.w3&&b(e,t,n,o)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=N.location.search||N.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return k(t);for(var n=t.split("&"),o=0;o<n.length;o++)if(n[o].substring(0,n[o].indexOf("="))==e)return k(n[o].substring(n[o].indexOf("=")+1))}return""},expressInstallCallback:function(){if(B){var e=m(j);e&&$&&(e.parentNode.replaceChild($,e),_&&(w(_,!0),X.ie&&X.win&&($.style.display="block")),C&&C(x)),B=!1}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var e=window.console;if(e&&e.log&&e.error||(e={log:function(){},error:function(){}}),!swfobject.hasFlashPlayerVersion("10.0.0"))return e.error("Flash Player >= 10.0.0 is required."),void 0;"file:"==location.protocol&&e.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(e,t,n,o,i){var r=this;r.__id=WebSocket.__nextId++,WebSocket.__instances[r.__id]=r,r.readyState=WebSocket.CONNECTING,r.bufferedAmount=0,r.__events={},t?"string"==typeof t&&(t=[t]):t=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(r.__id,e,t,n||null,o||0,i||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return 0>t?!0:(this.bufferedAmount+=t,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,t){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t){if(e in this.__events)for(var n=this.__events[e],o=n.length-1;o>=0;--o)if(n[o]===t){n.splice(o,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t=this.__events[e.type]||[],n=0;n<t.length;++n)t[n](e);var o=this["on"+e.type];o&&o(e)},WebSocket.prototype.__handleEvent=function(e){"readyState"in e&&(this.readyState=e.readyState),"protocol"in e&&(this.protocol=e.protocol);var t;if("open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close");else{if("message"!=e.type)throw"unknown event type: "+e.type;var n=decodeURIComponent(e.message);t=this.__createMessageEvent("message",n)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,t,null,null,window,null),n}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return e.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf"),void 0;var t=document.createElement("div");t.id="webSocketContainer",t.style.position="absolute",WebSocket.__isFlashLite()?(t.style.left="0px",t.style.top="0px"):(t.style.left="-100px",t.style.top="-100px");var n=document.createElement("div");n.id="webSocketFlash",t.appendChild(n),document.body.appendChild(t),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(t){t.success||e.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var t=WebSocket.__flash.receiveEvents(),n=0;n<t.length;++n)WebSocket.__instances[t[n].webSocketId].__handleEvent(t[n])}catch(o){e.error(o)}},0),!0},WebSocket.__log=function(t){e.log(decodeURIComponent(t))},WebSocket.__error=function(t){e.error(decodeURIComponent(t))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return e&&e.enabledPlugin&&e.enabledPlugin.filename?e.enabledPlugin.filename.match(/flashlite/i)?!0:!1:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}}(),function(e,t,n){function o(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function i(){}e.XHR=o,t.util.inherit(o,t.Transport),o.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},o.prototype.payload=function(e){for(var n=[],o=0,i=e.length;i>o;o++)n.push(t.parser.encodePacket(e[o]));this.send(t.parser.encodePayload(n))},o.prototype.send=function(e){return this.post(e),this},o.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=i,r.posting=!1,200==this.status?r.socket.setBuffer(!1):r.onClose())}function o(){this.onload=i,r.socket.setBuffer(!1)}var r=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=o:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},o.prototype.close=function(){return this.onClose(),this},o.prototype.request=function(e){var n=t.util.request(this.socket.isXDomain()),o=t.util.query(this.socket.options.query,"t="+ +new Date);if(n.open(e||"GET",this.prepareUrl()+o,!0),"POST"==e)try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(i){}return n},o.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},o.check=function(e,o){try{var i=t.util.request(o),r=n.XDomainRequest&&i instanceof XDomainRequest,a=e&&e.options&&e.options.secure?"https:":"http:",s=n.location&&a!=n.location.protocol;if(i&&(!r||!s))return!0}catch(u){}return!1},o.xdomainCheck=function(e){return o.check(e,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.XHR.apply(this,arguments)}e.htmlfile=n,t.util.inherit(n,t.Transport.XHR),n.prototype.name="htmlfile",n.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var e=this.doc.createElement("div");e.className="socketio",this.doc.body.appendChild(e),this.iframe=this.doc.createElement("iframe"),e.appendChild(this.iframe);var n=this,o=t.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+o,t.util.on(window,"unload",function(){n.destroy()})},n.prototype._=function(e,t){this.onData(e);try{var n=t.getElementsByTagName("script")[0];n.parentNode.removeChild(n)}catch(o){}},n.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},n.prototype.close=function(){return this.destroy(),t.Transport.XHR.prototype.close.call(this)},n.check=function(e){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var n=new(window[["Active"].concat("Object").join("X")])("htmlfile");return n&&t.Transport.XHR.check(e)}catch(o){}return!1},n.xdomainCheck=function(){return!1},t.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function o(){t.Transport.XHR.apply(this,arguments)}function i(){}e["xhr-polling"]=o,t.util.inherit(o,t.Transport.XHR),t.util.merge(o,t.Transport.XHR),o.prototype.name="xhr-polling",o.prototype.heartbeats=function(){return!1},o.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},o.prototype.get=function(){function e(){4==this.readyState&&(this.onreadystatechange=i,200==this.status?(r.onData(this.responseText),r.get()):r.onClose())}function t(){this.onload=i,this.onerror=i,r.retryCounter=1,r.onData(this.responseText),r.get()}function o(){r.retryCounter++,!r.retryCounter||r.retryCounter>3?r.onClose():r.get()}if(this.isOpen){var r=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=t,this.xhr.onerror=o):this.xhr.onreadystatechange=e,this.xhr.send(null)}},o.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=i;try{this.xhr.abort()}catch(e){}this.xhr=null}},o.prototype.ready=function(e,n){var o=this;t.util.defer(function(){n.call(o)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function o(){t.Transport["xhr-polling"].apply(this,arguments),this.index=t.j.length;var e=this;t.j.push(function(t){e._(t)})}var i=n.document&&"MozAppearance"in n.document.documentElement.style;e["jsonp-polling"]=o,t.util.inherit(o,t.Transport["xhr-polling"]),o.prototype.name="jsonp-polling",o.prototype.post=function(e){function n(){o(),i.socket.setBuffer(!1)}function o(){i.iframe&&i.form.removeChild(i.iframe);try{a=document.createElement('<iframe name="'+i.iframeId+'">')}catch(e){a=document.createElement("iframe"),a.name=i.iframeId}a.id=i.iframeId,i.form.appendChild(a),i.iframe=a}var i=this,r=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var a,s=document.createElement("form"),u=document.createElement("textarea"),l=this.iframeId="socketio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="0px",s.style.left="0px",s.style.display="none",s.target=l,s.method="POST",s.setAttribute("accept-charset","utf-8"),u.name="d",s.appendChild(u),document.body.appendChild(s),this.form=s,this.area=u}this.form.action=this.prepareUrl()+r,o(),this.area.value=t.JSON.stringify(e);try{this.form.submit()}catch(c){}this.iframe.attachEvent?a.onreadystatechange=function(){"complete"==i.iframe.readyState&&n()}:this.iframe.onload=n,this.socket.setBuffer(!0)},o.prototype.get=function(){var e=this,n=document.createElement("script"),o=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.prepareUrl()+o,n.onerror=function(){e.onClose()};var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r),this.script=n,i&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},o.prototype._=function(e){return this.onData(e),this.isOpen&&this.get(),this},o.prototype.ready=function(e,n){var o=this;return i?(t.util.load(function(){n.call(o)}),void 0):n.call(this)},o.check=function(){return"document"in n},o.xdomainCheck=function(){return!0},t.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),"function"==typeof define&&define.amd&&define([],function(){return io})}(),jade=function(e){function t(e){return null!=e}return Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),e.merge=function(e,n){var o=e["class"],i=n["class"];(o||i)&&(o=o||[],i=i||[],Array.isArray(o)||(o=[o]),Array.isArray(i)||(i=[i]),o=o.filter(t),i=i.filter(t),e["class"]=o.concat(i).join(" "));for(var r in n)"class"!=r&&(e[r]=n[r]);return e},e.attrs=function(t,n){var o=[],i=t.terse;delete t.terse;var r=Object.keys(t),a=r.length;if(a){o.push("");for(var s=0;a>s;++s){var u=r[s],l=t[u];"boolean"==typeof l||null==l?l&&(i?o.push(u):o.push(u+'="'+u+'"')):0==u.indexOf("data")&&"string"!=typeof l?o.push(u+"='"+JSON.stringify(l)+"'"):"class"==u&&Array.isArray(l)?o.push(u+'="'+e.escape(l.join(" "))+'"'):n&&n[u]?o.push(u+'="'+e.escape(l)+'"'):o.push(u+'="'+l+'"')}}return o.join(" ")},e.escape=function(e){return String(e).replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e.rethrow=function(e,t,n){if(!t)throw e;throw e.path=t,e.message=(t||"Jade")+":"+n+"\n"+e.message,e},e}({}),jade.settings=function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div class="span3 thumbnail"><h5><i class="icon-wrench"></i>Settings</h5><div style="text-align: center; padding-right: 4px; padding-left: 4px; padding-top: 4px"><div class="localsettings"><div class="expando"><div class="input-prepend"><span style="width:21px" title="Public name" rel="tooltip" class="generate-name add-on"><i class="icon-user"></i></span><input id="username" type="text" value="" disabled="disabled"/></div></div><div style="display:none" class="expando set-team"><div class="input-prepend"><span style="width:21px" title="Teams" rel="tooltip" class="add-on"><i class="icon-group"></i></span><select class="input teams"><option value="">Individual</option></select></div></div><div style="display:none" class="expando reset-score"><div class="input-prepend"><span style="width:21px" title="Reset my score" rel="tooltip" class="add-on"><i class="icon-trash"></i></span><button class="btn input score-reset">Reset My Score </button></div></div><div style="display:none" class="expando relinquish-command"><div class="input-prepend"><span style="width:21px" title="Relinquish dominance over this room" rel="tooltip" class="add-on"><i class="icon-eye-close"></i></span><button class="btn input lose-command">Relinquish Command</button></div></div><label class="checkbox"><input type="checkbox" class="movingwindow"/>Points earned in last 20 questions</label><label class="checkbox"><input type="checkbox" class="adhd"/>Enable distraction free mode</label><div class="microwave"><label class="checkbox"><input type="checkbox" checked="checked" class="livechat"/>Show chat messages while typing</label></div><label class="checkbox"><input type="checkbox" class="sounds"/>Play sound on successful buzz</label><div style="display:none;white-space:nowrap;" class="lockvote"><label class="checkbox"><input type="checkbox" class="lock"/>Lock settings <span class=\'electorate\'>0/1 votes</span><i style="padding-left: 5px" class="icon-unlock status_icon"></i></label></div></div><hr/><div class="globalsettings"><div class="expando"><div class="input-prepend"><span style="width:21px" title="Read speed" rel="tooltip" class="add-on"><i class="icon-step-forward"></i></span><input type="range" value="200" min="60" max="600" class="speed"/></div></div><div class="expando"><div class="input-prepend"><span style="width:21px" title="Difficulty/Category" rel="tooltip" class="add-on"><i class="icon-briefcase"></i></span><select style="width: 60px; border-right: 0" class="padd-on difficulties"></select><select style="border-left: 0" class="input categories"></select></div></div><div style="display:none" class="custom-category"></div><label class="checkbox"><input type="checkbox" class="showbonus"/>Show bonus questions</label><label class="checkbox"><input type="checkbox" checked="checked" class="multibuzz"/>Allow players to buzz multiple times</label><label class="checkbox"><input type="checkbox" checked="checked" class="allowskip"/>Allow players to skip questions</label><label style="display: none" class="checkbox"><input type="checkbox" checked="checked" class="allowpause"/>Allow players to pause questions</label><div class="request-access"><button class="btn btn-large"><i class="icon-cog"></i>&nbsp; Request Access</button></div></div></div></div>');return buf.join("")},jade.update=function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div class="well"><a href="" class="btn btn-primary pull-right">Reload</a>A <strong>new version</strong> of this application has been downloaded. Please reload the application now.</div>');return buf.join("")},window.Modernizr=function(e,t,n){function o(e){p.cssText=e}function i(e,t){return typeof e===t}var r,a,s,u="2.6.1",l={},c=!0,h=t.documentElement,d="modernizr",f=t.createElement(d),p=f.style,m=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),g={},y=[],v=y.slice,b=function(e,n,o,i){var r,a,s,u=t.createElement("div"),l=t.body,c=l?l:t.createElement("body");if(parseInt(o,10))for(;o--;)s=t.createElement("div"),s.id=i?i[o]:d+(o+1),u.appendChild(s);return r=["&#173;",'<style id="s',d,'">',e,"</style>"].join(""),u.id=d,(l?u:c).innerHTML+=r,c.appendChild(u),l||(c.style.background="",h.appendChild(c)),a=n(u,e),l?u.parentNode.removeChild(u):c.parentNode.removeChild(c),!!a},w={}.hasOwnProperty;s=i(w,"undefined")||i(w.call,"undefined")?function(e,t){return t in e&&i(e.constructor.prototype[t],"undefined")}:function(e,t){return w.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=v.call(arguments,1),o=function(){if(this instanceof o){var i=function(){};i.prototype=t.prototype;var r=new i,a=t.apply(r,n.concat(v.call(arguments)));return Object(a)===a?a:r}return t.apply(e,n.concat(v.call(arguments)))};return o}),g.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:b(["@media (",m.join("touch-enabled),("),d,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=9===e.offsetTop}),n};for(var k in g)s(g,k)&&(a=k.toLowerCase(),l[a]=g[k](),y.push((l[a]?"":"no-")+a));return l.addTest=function(e,t){if("object"==typeof e)for(var o in e)s(e,o)&&l.addTest(o,e[o]);else{if(e=e.toLowerCase(),l[e]!==n)return l;t="function"==typeof t?t():t,c&&(h.className+=" "+(t?"":"no-")+e),l[e]=t}return l},o(""),f=r=null,function(e,t){function n(e,t){var n=e.createElement("p"),o=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",o.insertBefore(n.lastChild,o.firstChild)}function o(){var e=y.elements;return"string"==typeof e?e.split(" "):e}function i(e){var t=g[e[p]];return t||(t={},m++,e[p]=m,g[m]=t),t}function r(e,n,o){if(n||(n=t),c)return n.createElement(e);o||(o=i(n));var r;return r=o.cache[e]?o.cache[e].cloneNode():f.test(e)?(o.cache[e]=o.createElem(e)).cloneNode():o.createElem(e),r.canHaveChildren&&!d.test(e)?o.frag.appendChild(r):r}function a(e,n){if(e||(e=t),c)return e.createDocumentFragment();n=n||i(e);for(var r=n.frag.cloneNode(),a=0,s=o(),u=s.length;u>a;a++)r.createElement(s[a]);return r}function s(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return y.shivMethods?r(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+o().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(y,t.frag)}function u(e){e||(e=t);var o=i(e);return y.shivCSS&&!l&&!o.hasCSS&&(o.hasCSS=!!n(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),c||s(e,o),e}var l,c,h=e.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^<|^(?:a|b|button|code|div|fieldset|form|h1|h2|h3|h4|h5|h6|i|iframe|img|input|label|li|link|ol|option|p|param|q|script|select|span|strong|style|table|tbody|td|textarea|tfoot|th|thead|tr|ul)$/i,p="_html5shiv",m=0,g={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",l="hidden"in e,c=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(n){l=!0,c=!0}}();var y={elements:h.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:h.shivCSS!==!1,supportsUnknownElements:c,shivMethods:h.shivMethods!==!1,type:"default",shivDocument:u,createElement:r,createDocumentFragment:a};e.html5=y,u(t)}(this,t),l._version=u,l._prefixes=m,l.testStyles=b,h.className=h.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(c?" js "+y.join(" "):""),l}(this,this.document),function(e,t,n){function o(e){return"[object Function]"==g.call(e)}function i(e){return"string"==typeof e}function r(){}function a(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function s(){var e=y.shift();v=1,e?e.t?p(function(){("c"==e.t?d.injectCss:d.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),s()):v=0}function u(e,n,o,i,r,u,l){function c(t){if(!f&&a(h.readyState)&&(b.r=f=1,!v&&s(),h.onload=h.onreadystatechange=null,t)){"img"!=e&&p(function(){k.removeChild(h)},50);for(var o in E[n])E[n].hasOwnProperty(o)&&E[n][o].onload()}}var l=l||d.errorTimeout,h=t.createElement(e),f=0,g=0,b={t:o,s:n,e:r,a:u,x:l};1===E[n]&&(g=1,E[n]=[]),"object"==e?h.data=n:(h.src=n,h.type=e),h.width=h.height="0",h.onerror=h.onload=h.onreadystatechange=function(){c.call(this,g)},y.splice(i,0,b),"img"!=e&&(g||2===E[n]?(k.insertBefore(h,w?null:m),p(c,l)):E[n].push(h))}function l(e,t,n,o,r){return v=0,t=t||"j",i(e)?u("c"==t?_:$,e,t,this.i++,n,o,r):(y.splice(this.i++,0,e),1==y.length&&s()),this}function c(){var e=d;return e.loader={load:l,i:0},e}var h,d,f=t.documentElement,p=e.setTimeout,m=t.getElementsByTagName("script")[0],g={}.toString,y=[],v=0,b="MozAppearance"in f.style,w=b&&!!t.createRange().compareNode,k=w?f:m.parentNode,f=e.opera&&"[object Opera]"==g.call(e.opera),f=!!t.attachEvent&&!f,$=b?"object":f?"script":"img",_=f?"script":$,C=Array.isArray||function(e){return"[object Array]"==g.call(e)},x=[],E={},T={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};d=function(e){function t(e){var t,n,o,e=e.split("!"),i=x.length,r=e.pop(),a=e.length,r={url:r,origUrl:r,prefixes:e};for(n=0;a>n;n++)o=e[n].split("="),(t=T[o.shift()])&&(r=t(r,o));for(n=0;i>n;n++)r=x[n](r);return r}function a(e,i,r,a,s){var u=t(e),l=u.autoCallback;u.url.split(".").pop().split("?").shift(),u.bypass||(i&&(i=o(i)?i:i[e]||i[a]||i[e.split("/").pop().split("?")[0]]),u.instead?u.instead(e,i,r,a,s):(E[u.url]?u.noexec=!0:E[u.url]=1,r.load(u.url,u.forceCSS||!u.forceJS&&"css"==u.url.split(".").pop().split("?").shift()?"c":n,u.noexec,u.attrs,u.timeout),(o(i)||o(l))&&r.load(function(){c(),i&&i(u.origUrl,s,a),l&&l(u.origUrl,s,a),E[u.url]=2})))}function s(e,t){function n(e,n){if(e){if(i(e))n||(h=function(){var e=[].slice.call(arguments);d.apply(this,e),f()}),a(e,h,t,0,l);else if(Object(e)===e)for(u in s=function(){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(),e)e.hasOwnProperty(u)&&(!n&&!--s&&(o(h)?h=function(){var e=[].slice.call(arguments);d.apply(this,e),f()}:h[u]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),f()}}(d[u])),a(e[u],h,t,u,l))}else!n&&f()}var s,u,l=!!e.test,c=e.load||e.both,h=e.callback||r,d=h,f=e.complete||r;n(l?e.yep:e.nope,!!c),c&&n(c)}var u,l,h=this.yepnope.loader;if(i(e))a(e,0,h,0);else if(C(e))for(u=0;u<e.length;u++)l=e[u],i(l)?a(l,0,h,0):C(l)?d(l):Object(l)===l&&s(l,h);else Object(e)===e&&s(e,h)},d.addPrefix=function(e,t){T[e]=t},d.addFilter=function(e){x.push(e)},d.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",h=function(){t.removeEventListener("DOMContentLoaded",h,0),t.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=s,e.yepnope.injectJs=function(e,n,o,i,u,l){var c,h,f=t.createElement("script"),i=i||d.errorTimeout;f.src=e;for(h in o)f.setAttribute(h,o[h]);n=l?s:n||r,f.onreadystatechange=f.onload=function(){!c&&a(f.readyState)&&(c=1,n(),f.onload=f.onreadystatechange=null)},p(function(){c||(c=1,n(1))},i),u?f.onload():m.parentNode.insertBefore(f,m)},e.yepnope.injectCss=function(e,n,o,i,a,u){var l,i=t.createElement("link"),n=u?s:n||r;i.href=e,i.rel="stylesheet",i.type="text/css";for(l in o)i.setAttribute(l,o[l]);a||(m.parentNode.insertBefore(i,m),p(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("csscalc",function(e,t,n){return t="width:",n="calc(10px);",e=document.createElement("div"),e.style.cssText=t+Modernizr._prefixes.join(n+t),!!e.style.length}),!function(e){e(function(){"use strict";e.support.transition=function(){var e=function(){var e,t=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(e in n)if(void 0!==t.style[e])return n[e]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";function t(){e(o).each(function(){n(e(this)).removeClass("open")})}function n(t){var n,o=t.attr("data-target");return o||(o=t.attr("href"),o=o&&/#/.test(o)&&o.replace(/.*(?=#[^\s]*$)/,"")),n=o&&e(o),n&&n.length||(n=t.parent()),n}var o="[data-toggle=dropdown]",i=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};i.prototype={constructor:i,toggle:function(){var o,i,r=e(this);if(!r.is(".disabled, :disabled"))return o=n(r),i=o.hasClass("open"),t(),i||o.toggleClass("open"),r.focus(),!1},keydown:function(t){var i,r,a,s,u;if(/(38|40|27)/.test(t.keyCode)&&(i=e(this),t.preventDefault(),t.stopPropagation(),!i.is(".disabled, :disabled"))){if(a=n(i),s=a.hasClass("open"),!s||s&&27==t.keyCode)return 27==t.which&&a.find(o).focus(),i.click();r=e("[role=menu] li:not(.divider):visible a",a),r.length&&(u=r.index(r.filter(":focus")),38==t.keyCode&&u>0&&u--,40==t.keyCode&&u<r.length-1&&u++,~u||(u=0),r.eq(u).focus())}}};var r=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),o=n.data("dropdown");o||n.data("dropdown",o=new i(this)),"string"==typeof t&&o[t].call(n)})},e.fn.dropdown.Constructor=i,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=r,this},e(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown-menu",function(e){e.stopPropagation()}).on("click.dropdown.data-api",o,i.prototype.toggle).on("keydown.dropdown.data-api",o+", [role=menu]",i.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(e("body").addClass("modal-open"),this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1).focus(),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")}))},hide:function(t){t&&t.preventDefault(),t=e.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,e("body").removeClass("modal-open"),this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]===e.target||t.$element.has(e.target).length||t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){27==t.which&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=e.support.transition&&n;this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body),"static"!=this.options.backdrop&&this.$backdrop.click(e.proxy(this.hide,this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),o?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(this.removeBackdrop,this)):this.removeBackdrop()):t&&t()}},e.fn.modal=function(n){return this.each(function(){var o=e(this),i=o.data("modal"),r=e.extend({},e.fn.modal.defaults,o.data(),"object"==typeof n&&n);i||o.data("modal",i=new t(this,r)),"string"==typeof n?i[n]():r.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),o=n.attr("href"),i=e(n.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),r=i.data("modal")?"toggle":e.extend({remote:!/#/.test(o)&&o},i.data(),n.data());t.preventDefault(),i.modal(r).one("hide",function(){n.focus()})})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,o){var i,r;this.type=t,this.$element=e(n),this.options=this.getOptions(o),this.enabled=!0,"click"==this.options.trigger?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):"manual"!=this.options.trigger&&(i="hover"==this.options.trigger?"mouseenter":"focus",r="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(r+"."+this.type,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t
},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);return n.options.delay&&n.options.delay.show?(clearTimeout(this.timeout),n.hoverState="in",this.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show),void 0):n.show()},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),n.options.delay&&n.options.delay.hide?(n.hoverState="out",this.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide),void 0):n.hide()},show:function(){var e,t,n,o,i,r,a;if(this.hasContent()&&this.enabled){switch(e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),r="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(r),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),n=this.getPosition(t),o=e[0].offsetWidth,i=e[0].offsetHeight,t?r.split(" ")[1]:r){case"bottom":a={top:n.top+n.height,left:n.left+n.width/2-o/2};break;case"top":a={top:n.top-i,left:n.left+n.width/2-o/2};break;case"left":a={top:n.top+n.height/2-i/2,left:n.left-o};break;case"right":a={top:n.top+n.height/2-i/2,left:n.left+n.width}}e.css(a).addClass(r).addClass("in")}},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function t(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.remove()})}var n=this.tip();return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?t():n.remove(),this},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}},e.fn.tooltip=function(n){return this.each(function(){var o=e(this),i=o.data("tooltip"),r="object"==typeof n&&n;i||o.data("tooltip",i=new t(this,r)),"string"==typeof n&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!0}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content > *")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||("function"==typeof n.content?n.content.call(t[0]):n.content)},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}}),e.fn.popover=function(n){return this.each(function(){var o=e(this),i=o.data("popover"),r="object"==typeof n&&n;i||o.data("popover",i=new t(this,r)),"string"==typeof n&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function n(){o.trigger("closed").remove()}var o,i=e(this),r=i.attr("data-target");r||(r=i.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),o=e(r),t&&t.preventDefault(),o.length||(o=i.hasClass("alert")?i:i.parent()),o.trigger(t=e.Event("close")),t.isDefaultPrevented()||(o.removeClass("in"),e.support.transition&&o.hasClass("fade")?o.on(e.support.transition.end,n):o.slideUp("normal",function(){n()}))},e.fn.alert=function(t){return this.each(function(){var o=e(this),i=o.data("alert");i||o.data("alert",i=new n(this)),"string"==typeof t&&i[t].call(o)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,o=n.data(),i=n.is("input")?"val":"html";e+="Text",o.resetText||n.data("resetText",n[i]()),n[i](o[e]||this.options[e]),setTimeout(function(){"loadingText"==e?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(n){return this.each(function(){var o=e(this),i=o.data("button"),r="object"==typeof n&&n;i||o.data("button",i=new t(this,r)),"toggle"==n?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(){var t;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(t=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,t?this.process(t):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){for(var t,n=[],o=[],i=[];t=e.shift();)t.toLowerCase().indexOf(this.query.toLowerCase())?~t.indexOf(this.query)?o.push(t):i.push(t):n.push(t);return n.concat(o,i)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,o){return t=e(n.options.item).attr("data-value",o),t.find("a").html(n.highlighter(o)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(){var t=this.$menu.find(".active").removeClass("active"),n=t.next();n.length||(n=e(this.$menu.find("li")[0])),n.addClass("active")},prev:function(){var e=this.$menu.find(".active").removeClass("active"),t=e.prev();t.length||(t=this.$menu.find("li").last()),t.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),(e.browser.chrome||e.browser.webkit||e.browser.msie)&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},move:function(e){if(this.shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=!~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){this.suppressKeyPressRepeat||this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},blur:function(){var e=this;setTimeout(function(){e.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(n){return this.each(function(){var o=e(this),i=o.data("typeahead"),r="object"==typeof n&&n;i||o.data("typeahead",i=new t(this,r)),"string"==typeof n&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);n.data("typeahead")||(t.preventDefault(),n.typeahead(n.data()))})})}(window.jQuery);var e,t,o;o=function(){var e,t,n,i,r,a,s,u,l;return r=1e3,e=5,n=60,t=60*n,i=["January","February","March","April","May","June","July","August","September","October","November","December"],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],u=function(e){var t,n,o,i,r,a;return a=e.getMinutes(),r=e.getHours(),t=r>12?"pm":"am",n=0===r||12===r?"12":""+r%12,o=10>a?"0"+a:""+a,i=""+n+":"+o+t},s=function(e){return i[e.getMonth()]},l=function(e){return a[e.getDay()]},o=function(o){var i,a,c,h,d,f,p,m,g,y,v,b,w,k,$,_,C,x,E;return d=new Date,f=(d.getTime()-o.getTime())/r,h=new Date(d.getFullYear()+1,0,1),a=new Date(d.getFullYear(),d.getMonth(),d.getDate()+(7-d.getDay())),C=new Date(d.getFullYear(),d.getMonth(),d.getDate()+1),g=new Date(d.getFullYear(),d.getMonth(),d.getDate()+2),$=new Date(d.getFullYear(),d.getMonth(),d.getDate()),E=new Date(d.getFullYear(),d.getMonth(),d.getDate()-1),v=new Date(d.getFullYear(),d.getMonth(),d.getDate()-d.getDay()),w=new Date(d.getFullYear(),0,1),c=(d.getTime()-h.getTime())/r,i=(d.getTime()-a.getTime())/r,m=(d.getTime()-g.getTime())/r,_=(d.getTime()-C.getTime())/r,k=(d.getTime()-$.getTime())/r,x=(d.getTime()-E.getTime())/r,y=(d.getTime()-v.getTime())/r,b=(d.getTime()-w.getTime())/r,p=f>=0?e>f?"A few seconds ago":n>f?""+Math.floor(f)+" seconds ago":2*n>f?"About a minute ago":t>f?""+Math.floor(f/n)+" minutes ago":2*t>f?"About an hour ago":k>f?""+Math.floor(f/t)+" hours ago":x>f?"Yesterday at "+u(o):y>f?""+l(o)+" at "+u(o):b>f?""+s(o)+" "+o.getDate()+" at "+u(o):""+s(o)+" "+o.getDate()+", "+o.getFullYear()+" at "+u(o):f>-e?"In a few seconds":f>-n?"In "+Math.floor(-f)+" seconds":f>2*-n?"In about a minute":f>-t?"In "+Math.floor(-f/n)+" minutes":f>2*-t?"In about an hour":f>_?"In "+Math.floor(-f/t)+" hours":f>m?"Tomorrow at "+u(o):f>i?""+l(o)+" at "+u(o):f>c?""+s(o)+" "+o.getDate()+" at "+u(o):""+s(o)+" "+o.getDate()+", "+o.getFullYear()+" at "+u(o)}}(),e=function(e){var t;return t=new Date,t.setTime(e),o(t)},t=function(e){var t;return t=new Date,t.setTime(e),t.getHours()%12+":"+("0"+t.getMinutes()).substr(-2,2)+(t.getHours()>12?"pm":"am")},function(e,t,n){"function"==typeof define&&define.amd?define(["jquery"],function(o){return n(o,e,t),o.mobile}):n(e.jQuery,e,t)}(this,document,function(e,t,n){!function(e){var t={touch:"ontouchend"in n};e.mobile=e.mobile||{},e.mobile.support=e.mobile.support||{},e.extend(e.support,t),e.extend(e.mobile.support,t)}(e),function(e,t,n,o){function i(e){for(;e&&"undefined"!=typeof e.originalEvent;)e=e.originalEvent;return e}function r(t,n){var r,a,s,u,l,c,h,d,f,p=t.type;if(t=e.Event(t),t.type=n,r=t.originalEvent,a=e.event.props,p.search(/^(mouse|click)/)>-1&&(a=A),r)for(h=a.length,u;h;)u=a[--h],t[u]=r[u];if(p.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==p.search(/^touch/)&&(s=i(r),p=s.touches,l=s.changedTouches,c=p&&p.length?p[0]:l&&l.length?l[0]:o))for(d=0,f=T.length;f>d;d++)u=T[d],t[u]=c[u];return t}function a(t){for(var n,o,i={};t;){n=e.data(t,C);for(o in n)n[o]&&(i[o]=i.hasVirtualBinding=!0);t=t.parentNode}return i}function s(t,n){for(var o;t;){if(o=e.data(t,C),o&&(!n||o[n]))return t;t=t.parentNode}return null}function u(){M=!1}function l(){M=!0}function c(){R=0,q.length=0,N=!1,l()}function h(){u()}function d(){f(),z=setTimeout(function(){z=0,c()},e.vmouse.resetTimerDuration)}function f(){z&&(clearTimeout(z),z=0)}function p(t,n,o){var i;return(o&&o[t]||!o&&s(n.target,t))&&(i=r(n,t),e(n.target).trigger(i)),i}function m(t){var n=e.data(t.target,x);if(!(N||R&&R===n)){var o=p("v"+t.type,t);o&&(o.isDefaultPrevented()&&t.preventDefault(),o.isPropagationStopped()&&t.stopPropagation(),o.isImmediatePropagationStopped()&&t.stopImmediatePropagation())}}function g(t){var n,o,r=i(t).touches;if(r&&1===r.length&&(n=t.target,o=a(n),o.hasVirtualBinding)){R=L++,e.data(n,x,R),f(),h(),I=!1;var s=i(t).touches[0];O=s.pageX,j=s.pageY,p("vmouseover",t,o),p("vmousedown",t,o)}}function y(e){M||(I||p("vmousecancel",e,a(e.target)),I=!0,d())}function v(t){if(!M){var n=i(t).touches[0],o=I,r=e.vmouse.moveDistanceThreshold,s=a(t.target);I=I||Math.abs(n.pageX-O)>r||Math.abs(n.pageY-j)>r,I&&!o&&p("vmousecancel",t,s),p("vmousemove",t,s),d()}}function b(e){if(!M){l();var t,n=a(e.target);if(p("vmouseup",e,n),!I){var o=p("vclick",e,n);o&&o.isDefaultPrevented()&&(t=i(e).changedTouches[0],q.push({touchID:R,x:t.clientX,y:t.clientY}),N=!0)}p("vmouseout",e,n),I=!1,d()}}function w(t){var n,o=e.data(t,C);if(o)for(n in o)if(o[n])return!0;return!1}function k(){}function $(t){var n=t.substr(1);return{setup:function(){w(this)||e.data(this,C,{});var o=e.data(this,C);o[t]=!0,S[t]=(S[t]||0)+1,1===S[t]&&W.bind(n,m),e(this).bind(n,k),F&&(S.touchstart=(S.touchstart||0)+1,1===S.touchstart&&W.bind("touchstart",g).bind("touchend",b).bind("touchmove",v).bind("scroll",y))},teardown:function(){--S[t],S[t]||W.unbind(n,m),F&&(--S.touchstart,S.touchstart||W.unbind("touchstart",g).unbind("touchmove",v).unbind("touchend",b).unbind("scroll",y));var o=e(this),i=e.data(this,C);i&&(i[t]=!1),o.unbind(n,k),w(this)||o.removeData(C)}}}var _,C="virtualMouseBindings",x="virtualTouchID",E="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),T="clientX clientY pageX pageY screenX screenY".split(" "),D=e.event.mouseHooks?e.event.mouseHooks.props:[],A=e.event.props.concat(D),S={},z=0,O=0,j=0,I=!1,q=[],N=!1,M=!1,F="addEventListener"in n,W=e(n),L=1,R=0;e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(var P=0;P<E.length;P++)e.event.special[E[P]]=$(E[P]);F&&n.addEventListener("click",function(t){var n,o,i,r,a,s,u=q.length,l=t.target;if(u)for(n=t.clientX,o=t.clientY,_=e.vmouse.clickDistanceThreshold,i=l;i;){for(r=0;u>r;r++)if(a=q[r],s=0,i===l&&Math.abs(a.x-n)<_&&Math.abs(a.y-o)<_||e.data(i,x)===a.touchID)return t.preventDefault(),t.stopPropagation(),void 0;i=i.parentNode}},!0)}(e,t,n),function(e,t,o){function i(t,n,o){var i=o.type;o.type=n,e.event.handle.call(t,o),o.type=i}e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)},e.attrFn&&(e.attrFn[n]=!0)});var r=e.mobile.support.touch,a="touchmove scroll",s=r?"touchstart":"mousedown",u=r?"touchend":"mouseup",l=r?"touchmove":"mousemove";e.event.special.scrollstart={enabled:!0,setup:function(){function t(e,t){n=t,i(r,n?"scrollstart":"scrollstop",e)}var n,o,r=this,s=e(r);s.bind(a,function(i){e.event.special.scrollstart.enabled&&(n||t(i,!0),clearTimeout(o),o=setTimeout(function(){t(i,!1)},50))})}},e.event.special.tap={tapholdThreshold:750,setup:function(){var t=this,o=e(t);o.bind("vmousedown",function(r){function a(){clearTimeout(l)}function s(){a(),o.unbind("vclick",u).unbind("vmouseup",a),e(n).unbind("vmousecancel",s)}function u(e){s(),c===e.target&&i(t,"tap",e)}if(r.which&&1!==r.which)return!1;var l,c=r.target;r.originalEvent,o.bind("vmouseup",a).bind("vclick",u),e(n).bind("vmousecancel",s),l=setTimeout(function(){i(t,"taphold",e.Event("taphold",{target:c}))},e.event.special.tap.tapholdThreshold)})}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,setup:function(){var t=this,n=e(t);n.bind(s,function(t){function i(t){if(s){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t;r={time:(new Date).getTime(),coords:[n.pageX,n.pageY]},Math.abs(s.coords[0]-r.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault()}}var r,a=t.originalEvent.touches?t.originalEvent.touches[0]:t,s={time:(new Date).getTime(),coords:[a.pageX,a.pageY],origin:e(t.target)};n.bind(l,i).one(u,function(){n.unbind(l,i),s&&r&&r.time-s.time<e.event.special.swipe.durationThreshold&&Math.abs(s.coords[0]-r.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(s.coords[1]-r.coords[1])<e.event.special.swipe.verticalDistanceThreshold&&s.origin.trigger("swipe").trigger(s.coords[0]>r.coords[0]?"swipeleft":"swiperight"),s=r=o})})}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)}}})}(e,this)});var i=window.bootbox||function(e,t){function n(e,t){return null==t&&(t=o),"string"==typeof h[t][e]?h[t][e]:t!=i?n(e,i):e}var o="en",i="en",r=!0,a="static",s="javascript:;",u="",l={},c={};c.setLocale=function(e){for(var t in h)if(t==e)return o=e,void 0;throw new Error("Invalid locale: "+e)},c.addLocale=function(e,t){"undefined"==typeof h[e]&&(h[e]={});for(var n in t)h[e][n]=t[n]},c.setIcons=function(e){l=e,("object"!=typeof l||null==l)&&(l={})},c.alert=function(){var e="",t=n("OK"),o=null;switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"function"==typeof arguments[1]?o=arguments[1]:t=arguments[1];break;case 3:e=arguments[0],t=arguments[1],o=arguments[2];break;default:throw new Error("Incorrect number of arguments: expected 1-3")}return c.dialog(e,{label:t,icon:l.OK,callback:o},{onEscape:o||!0})},c.confirm=function(){var e="",t=n("CANCEL"),o=n("CONFIRM"),i=null;switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"function"==typeof arguments[1]?i=arguments[1]:t=arguments[1];break;case 3:e=arguments[0],t=arguments[1],"function"==typeof arguments[2]?i=arguments[2]:o=arguments[2];break;case 4:e=arguments[0],t=arguments[1],o=arguments[2],i=arguments[3];break;default:throw new Error("Incorrect number of arguments: expected 1-4")}var r=function(){"function"==typeof i&&i(!1)},a=function(){"function"==typeof i&&i(!0)};return c.dialog(e,[{label:t,icon:l.CANCEL,callback:r},{label:o,icon:l.CONFIRM,callback:a}],{onEscape:r})},c.prompt=function(){var e="",o=n("CANCEL"),i=n("CONFIRM"),r=null,a="";switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"function"==typeof arguments[1]?r=arguments[1]:o=arguments[1];break;case 3:e=arguments[0],o=arguments[1],"function"==typeof arguments[2]?r=arguments[2]:i=arguments[2];break;case 4:e=arguments[0],o=arguments[1],i=arguments[2],r=arguments[3];break;case 5:e=arguments[0],o=arguments[1],i=arguments[2],r=arguments[3],a=arguments[4];break;default:throw new Error("Incorrect number of arguments: expected 1-5")}var s=e,u=t("<form></form>");u.append("<input autocomplete=off type=text value='"+a+"' />");var h=function(){"function"==typeof r&&r(null)},d=function(){"function"==typeof r&&r(u.find("input[type=text]").val())},f=c.dialog(u,[{label:o,icon:l.CANCEL,callback:h},{label:i,icon:l.CONFIRM,callback:d}],{header:s,show:!1,onEscape:h});return f.on("shown",function(){u.find("input[type=text]").focus(),u.on("submit",function(e){e.preventDefault(),f.find(".btn-primary").click()})}),f.modal("show"),f},c.dialog=function(n,o,i){var l="",c=[],i=i||{};null==o?o=[]:"undefined"==typeof o.length&&(o=[o]);for(var h=o.length;h--;){var d=null,f=null,p=null,m="",g=null;if("undefined"==typeof o[h].label&&"undefined"==typeof o[h]["class"]&&"undefined"==typeof o[h].callback){var y=0,v=null;for(var b in o[h])if(v=b,++y>1)break;1==y&&"function"==typeof o[h][b]&&(o[h].label=v,o[h].callback=o[h][b])}"function"==typeof o[h].callback&&(g=o[h].callback),o[h]["class"]?p=o[h]["class"]:h==o.length-1&&o.length<=2&&(p="btn-primary"),d=o[h].label?o[h].label:"Option "+(h+1),o[h].icon&&(m="<i class='"+o[h].icon+"'></i> "),f=o[h].href?o[h].href:s,l="<a data-handler='"+h+"' class='btn "+p+"' href='"+f+"'>"+m+d+"</a>"+l,c[h]=g}var w=["<div class='bootbox modal' tabindex='-1' style='overflow:hidden;'>"];if(i.header){var k="";("undefined"==typeof i.headerCloseButton||i.headerCloseButton)&&(k="<a href='"+s+"' class='close'>&times;</a>"),w.push("<div class='modal-header'>"+k+"<h3>"+i.header+"</h3></div>")}w.push("<div class='modal-body'></div>"),l&&w.push("<div class='modal-footer'>"+l+"</div>"),w.push("</div>");var $=t(w.join("\n")),_="undefined"==typeof i.animate?r:i.animate;_&&$.addClass("fade");var C="undefined"==typeof i.classes?u:i.classes;return C&&$.addClass(C),$.find(".modal-body").html(n),$.on("hidden",function(){$.remove()}),$.on("keyup.dismiss.modal",function(e){27==e.which&&i.onEscape&&("function"==typeof i.onEscape&&i.onEscape(),$.modal("hide"))}),$.on("shown",function(){$.find("a.btn-primary:first").focus()}),$.on("click",".modal-footer a, a.close",function(e){var n=t(this).data("handler"),i=c[n],r=null;("undefined"==typeof n||"undefined"==typeof o[n].href)&&(e.preventDefault(),"function"==typeof i&&(r=i()),r!==!1&&$.modal("hide"))}),t("body").append($),$.modal({backdrop:"undefined"==typeof i.backdrop?a:i.backdrop,keyboard:!1,show:!1}),$.on("show",function(){t(e).off("focusin.modal")}),("undefined"==typeof i.show||i.show===!0)&&$.modal("show"),$},c.modal=function(){var e,n,o,i={onEscape:null,keyboard:!0,backdrop:a};switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0],"object"==typeof arguments[1]?o=arguments[1]:n=arguments[1];break;case 3:e=arguments[0],n=arguments[1],o=arguments[2];break;default:throw new Error("Incorrect number of arguments: expected 1-3")}return i.header=n,o="object"==typeof o?t.extend(i,o):i,c.dialog(e,[],o)},c.hideAll=function(){t(".bootbox").modal("hide")},c.animate=function(e){r=e},c.backdrop=function(e){a=e},c.classes=function(e){u=e};var h={en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"}};return c}(document,window.jQuery);window.bootbox=i,String.prototype.toTitleCase=function(){var e=/^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;return this.replace(/([^\W_]+[^\s-]*) */g,function(t,n,o,i){return o>0&&o+n.length!==i.length&&n.search(e)>-1&&":"!==i.charAt(o-2)&&i.charAt(o-1).search(/[^\s-]/)<0?t.toLowerCase():n.substr(1).search(/[A-Z]|\../)>-1?t:t.charAt(0).toUpperCase()+t.substr(1)})};var n,a,r=[].slice;window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(function(){return e(+new Date)},1e3/60)}),Date.now||(Date.now=function(){return(new Date).valueOf()}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),window.clone_shallow=function(e){var t,n;n={};for(t in e)n[t]=e[t];return n},RegExp.quote=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},jQuery.fn.disable=function(e){return e=!!e,$(this).each(function(){return $(this).prop("disabled")!==e?$(this).prop("disabled",e):void 0})},function(){var e,t,n,o,i,r,a,s,u,l,c;for(o=null!=(u=window.location.search)?u.substr(1):void 0,r=o.split("&"),n=function(){var n,o,a,s;for(s=[],n=0,o=r.length;o>n;n++)t=r[n],s.push((a=t.split("="),e=a[0],i=a[1],a));return s}(),window.location.query={},c=[],a=0,s=n.length;s>a;a++)l=n[a],e=l[0],i=l[1],c.push(window.location.query[e]=i);return c}(),jQuery.cookie=function(e,t,n){var o,i,r,a,s,u,l,c,h,d;if("undefined"!=typeof t)return n=n||{},null===t&&(t="",n.expires=-1),u="",n.expires&&("number"==typeof n.expires||n.expires.toUTCString)&&("number"==typeof n.expires?(a=new Date,a.setTime(a.getTime()+1e3*60*60*24*n.expires)):a=n.expires,u="; expires="+a.toUTCString()),l=n.path?"; path="+n.path:"",s=n.domain?"; domain="+n.domain:"",c=n.secure?"; secure="+n.secure:"",document.cookie=[e,"=",encodeURIComponent(t),u,l,s,c].join("");if(i=null,document.cookie&&""!==document.cookie)for(r=document.cookie.split(";"),h=0,d=r.length;d>h;h++)if(o=r[h],o=jQuery.trim(o),o.substring(0,e.length+1)===""+e+"="){i=decodeURIComponent(o.substring(e.length+1));break}return i},jQuery.fn.capQueue=function(){var e;return e=$(this).queue("fx"),e&&e.splice(1,e.length),$(this)},jQuery.fn.firework=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,f,p;for(f=this.position(),l=f.top,i=f.left,i+=jQuery(window).width()*Math.random(),l+=jQuery(window).height()*Math.random(),this.dequeue(),p=[],o=d=0;50>d;o=++d)t=6.294*Math.random(),u=Math.min(100,150*Math.random()),c=u*Math.cos(t),h=u*Math.sin(t),r=2*Math.random(),a=5,n=Math.random()*a,s=jQuery("<div>").css({position:"fixed","background-color":e,width:a,height:a,"border-radius":a,top:l,left:i}),"#fff"===e&&s.css("box-shadow","0px 0px 5px #000"),p.push(s.appendTo("body").animate({left:"+="+c*r,top:"+="+h*r,width:n,height:n},{duration:1e3*r,complete:function(){return $(this).remove()}}));return p},jQuery.fn.fireworks=function(e,t){var n,o,i,r,a,s=this;for(null==e&&(e=5),n=0,a=[],i=r=0;e>=0?e>r:r>e;i=e>=0?++r:--r)o=0===i?500:2e3*Math.random(),a.push(this.delay(o).queue(function(){var e;return e=t?t(n):"#"+Math.random().toString(16).slice(2,8),s.firework(e),n++}));return a},$(window).resize(function(){return $(".expando").each(function(){var e,t,n,o,i,r,a,s;for(e=0,s=$(this).find(".add-on, .padd-on"),r=0,a=s.length;a>r;r++)t=s[r],e+=$(t).outerWidth();return i=$(this).width(),n=$(this).find("input, .input"),o=n.hasClass("input")?0:n.outerWidth()-n.width(),Modernizr.csscalc?(n.css("width","-webkit-calc(100% - "+(o+e)+"px)"),n.css("width","-moz-calc(100% - "+(o+e)+"px)"),n.css("width","-o-calc(100% - "+(o+e)+"px)"),n.css("width","calc(100% - "+(o+e)+"px)")):n.width(i-o-e)})}),$(window).resize(),setTimeout(function(){return $(window).resize()},762),setTimeout(function(){return $(window).resize()},2718),setTimeout(function(){return $(window).resize()},6022),function(){var e,t,n;return t=new Date,t.setFullYear(t.getFullYear()+1),t.setHours(0),t.setMonth(0),t.setMinutes(0),t.setSeconds(0),t.setDate(1),n=t-Date.now(),2147483647>n&&setTimeout(function(){return $("body").fireworks(25)},n),e=new Date,e.setHours(16),e.setMinutes(20),e.setSeconds(0),e.setMonth(3),e.setDate(20),n=e-Date.now(),2147483647>n&&n>0&&setTimeout(function(){return wt("pass the weed, man")},n),e=new Date,e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMonth(8),e.setDate(5),n=e-Date.now(),2147483647>n&&n>0?setTimeout(function(){return w($("<div>").addClass("alert alert-info").html("Today is protobowl developer <b>Ben Vest</b>'s birthday. Send him an email at <code>vestben@gmail.com</code> or something."))},n):void 0}(),a=function(e){var t,n;if(null!=e?e.split:void 0)return n=e.split("."),t=function(){var e,t,o,i,a,s,u,l;for(a=1<=arguments.length?r.call(arguments,0):[],s=0,l=a.length;l>s;s++){for(o=a[s],i=o.split("."),t=0,e=u=0;4>=u;e=++u)"x"!==i[e]&&i[e]!==n[e]&&t++;if(0===t)return!0}return!1},t("129.65.x.x","207.62.x.x","198.188.x.x")?$("a.brand strong").text("Poly"):void 0},n=function(){var e,t,o;return e=new Date,24!==(o=e.getDate())&&25!==o||11!==e.getMonth()?1===e.getMonth()&&0===e.getDay()&&e.getDate()<=7?$("a.brand strong").text("Super"):3===e.getMonth()&&22===e.getDate()?($("body").addClass("earthday"),$("a.brand .motto").text("growing one thing and growing it well")):7===e.getMonth()&&28===e.getDate()?$("a.brand .motto").text("on August 28, 2012, protobowl was first <a href='http://hsquizbowl.org/forums/viewtopic.php?f=123&t=13478'>announced</a>"):5===e.getMonth()&&30===e.getDate()?$("a.brand .motto").text("protobowl's precursor, <a href='https://github.com/polarcuke/its-ac-attack'>its-ac-attack</a> was started June 30, 2012"):6===e.getMonth()&&20===e.getDate()?$("a.brand .motto").text("the first line of protobowl code was written July 20, 2012"):6===e.getMonth()&&4===e.getDate()?($("body").addClass("murrica"),$("a.brand .motto").text("Happy "+(e.getFullYear()-1776)+"th Birthday, America!").click(function(e){return $("body").fireworks(3,function(e){return["#9d0101","#fff","#447ba9"][e]}),e.preventDefault()})):3===e.getMonth()&&1===e.getDate()?($("a.brand").html('<u><b>Quizbowl DB</b></u> <em style="font-size:small">Welcome to Quizbowl DB, the best way to get better at quizbowl!</em>'),$("body").addClass("aprilfools")):(t=new Date,t.setDate(e.getDate()+1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),setTimeout(n,Math.max(100,t-Date.now()))):$("body").addClass("christmas")},n(),("undefined"==typeof console||null===console)&&(window.console={log:function(){return null},warn:function(){return null},debug:function(){return null},time:function(){return null},timeEnd:function(){return null},dir:function(){return null},assert:function(){return null},trace:function(){return null},error:function(){return null}}),Array.prototype.map||(Array.prototype.map=function(e,t){var n,o,i,r,a,s,u;if(i=void 0,n=void 0,r=void 0,"undefined"==typeof this||null===this)throw new TypeError(" this is null or not defined");if(o=Object(this),s=o.length>>>0,"function"!=typeof e)throw new TypeError(e+" is not a function");for(t&&(i=t),n=new Array(s),r=0;s>r;)a=void 0,u=void 0,r in o&&(a=o[r],u=e.call(i,a,r,o),n[r]=u),r++;return n});var s,u,l,h,c;s=null,u=null,l=function(e){var t,n,o,i;e?jQuery.cookie("protoauth",e):"undefined"!=typeof e&&jQuery.cookie("protoauth","");try{i=jQuery.cookie("protoauth").split("&"),o=i[0],t=i[1],u=JSON.parse(decodeURIComponent(t))}catch(r){n=r,u=null}return $("body").toggleClass("authenticated",!!u),$("#userinfo").is(":hidden")||!!u===$("#user").is(":hidden")?$("#userinfo").fadeOut("normal",function(){return u?($("#signin").hide(),$(".user-name").text(u.email),$("#user").show(),$("#userinfo").fadeIn()):($("#signin").show(),$("#user").hide(),$("#userinfo").fadeIn())}):void 0},l(),$(document).ready(function(){var e;return("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.auth:void 0)?"undefined"!=typeof navigator&&null!==navigator?null!=(e=navigator.id)?e.watch({loggedInUser:null!=u?u.email:void 0,onlogin:function(e){return s=e,Nt()&&Ut?Wt.link(s):void 0
},onlogout:function(){return s=null,u&&(z({verb:"logging out of the current authenticated session"}),c()),l(null)}}):void 0:void 0:void 0}),h=function(e){var t;return s=null,"okay"!==(null!=e?e.status:void 0)?(z({verb:"server rejected login request: "+(null!=e?e.reason:void 0)}),"undefined"!=typeof navigator&&null!==navigator?null!=(t=navigator.id)?t.logout():void 0:void 0):(u||Wt.accelerate_cleanup(),z({verb:"logging in and beginning a new authenticated session"}),"function"==typeof l&&l(e.cookie),c())},c=function(){return eo?(console.log("merpity werpity"),eo.hide_disconnect=!0,eo.socket.disconnect(),Xt.users={},eo.socket.reconnect(),eo.hide_disconnect=!1):void 0},$("a[href='#signin']").click(function(e){var t;return"undefined"!=typeof navigator&&null!==navigator&&null!=(t=navigator.id)&&t.request(),e.preventDefault()}),$("a[href='#logout']").click(function(e){var t;return"undefined"!=typeof navigator&&null!==navigator&&null!=(t=navigator.id)&&t.logout(),e.preventDefault()});var d,f=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},r=[].slice;d=function(){function e(e,t){this.id=t,this.room=e,this.corrects={},this.wrongs={},this.prompts=0,this.earlyseen=0,this.seen=0,this.streak=0,this.streak_record=0,this.negstreak=0,this.negstreak_record=0,this.history=[],this.time_spent=0,this.last_action=this.room.serverTime(),this.last_session=this.room.serverTime(),this.created=this.room.serverTime(),this.idle=!1,this.times_buzzed=0,this.team="",this.banned=0,this.auth=null,this.moderator=!1,this.bubble=0,this.prefs={typing:!0},this.room.dystopia&&(this.prefs.distraction=!0),this.lock=!1,this.muwave=!1,this.__recent_actions=[],this.__rate_limited=0}return e.prototype.link=function(){return this.room.log("QuizPlayer.link(name) not implemented")},e.prototype.emit=function(){return this.room.log("QuizPlayer.emit(name, data) not implemented")},e.prototype.touch=function(e){var t,n;return this.idle=!1,t=this.room.serverTime(),e||(n=t-this.last_action,6e5>n&&(this.time_spent+=n)),this.last_action=t,this.room.touch(),this.room.check_timeout()},e.prototype.active=function(){return this.online()&&this.room.serverTime()-this.last_action<6e5&&!this.idle},e.prototype.online=function(){return!0},e.prototype.level=function(){var e,t;return e=this.room.acl,"_"===this.id[0]?e.ninja:this.moderator?e.moderator:(null!=(t=this.elect)?t.term:void 0)>this.room.serverTime()?e.elected:this.room.locked()?this.score()>=50?e.fifty:this.score()>0?e.positive:e.baseline:e.unlocked},e.prototype.authorized=function(e){return null==e&&(e=this.room.escalate),"string"==typeof e&&(e=this.room.acl[e]),this.level()>=e},e.prototype.score=function(){var e,t,n,o,i,r;o=0,i=this.room.scoring;for(e in i)r=i[e],n=r[0],t=r[1],o+=(this.corrects[e]||0)*n+(this.wrongs[e]||0)*t;return o},e.prototype.metrics=function(){var e,t,n,o,i,r;return t=.001,o=this.room.scoring,e=function(e){var t,n;n=0;for(t in o)n+=e[t]||0;return n},n={score:this.score(),seen:this.seen,correct:e(this.corrects),wrong:e(this.wrongs)},n.guesses=n.correct+n.wrong,n.precision=n.correct/(n.guesses+t),n.recall=n.correct/(n.seen+t),n.f1=2*n.precision*n.recall/(n.precision+n.recall+t),(null!=(i=this.room)?null!=(r=i.scoring)?r.interrupt:void 0:void 0)&&(n.interrupts=(this.wrongs.interrupt||0)+(this.wrongs.early||0),n.early=this.corrects.early||0),n},e.prototype.reset_score=function(){var e;return e=this.metrics(),this.verb("was reset from "+this.score()+" points ("+e.correct+" correct, "+e.wrong+" wrong, "+e.guesses+" guesses)"),this.negstreak_record=this.negstreak=this.streak_record=this.streak=this.earlyseen=this.seen=0,this.wrongs={},this.corrects={},this.history=[],this.sync(!0)},e.prototype.bookmark=function(e){var t,n;return n=e.value,t=e.id,0},e.prototype.ban=function(){return 1},e.prototype.rate_limited=function(){var e,t,n,o,i,r,a,s,u,l,c,h,d;if(l=function(){var e,t;e=this.room.users,t=[];for(n in e)s=e[n],"_"!==n[0]&&s.active()&&t.push(n);return t}.call(this),e=856,l.length<=2&&(e=612),r=316,u=10,t=this.room.serverTime(),this.__recent_actions=this.__recent_actions.slice(-u),this.__recent_actions.length===u){for(i=0,d=this.__recent_actions,c=0,h=d.length;h>c;c++)a=d[c],i+=a;if(o=t-i/u,u*r/2>o&&this.throttle(),u*e/2>o)return!0}},e.prototype.throttle=function(){var e;return e=this.room.serverTime()+5e3,e-this.__rate_limited>762&&(this.emit("throttle",this.__rate_limited),this.__recent_actions.push(this.room.serverTime())),this.__rate_limited=e},e.prototype.rate_limit=function(){return this.__recent_actions.push(this.room.serverTime()),this.rate_limited()?this.create_tribunal():void 0},e.prototype.reprimand=function(e){var t,n,o;return n=e.user,t=e.reason,this.reprimand_embargo>this.room.serverTime()?(this.notify("can not reprimand anyone for "+Math.ceil((this.reprimand_embargo-this.room.serverTime())/1e3)+" seconds"),void 0):(this.authorized(this.room.acl.moderator)||(this.reprimand_embargo=this.room.serverTime()+6e4,this.sync()),null!=(o=this.room.users[n])?o.emit("reprimand",{trigger:this.id,time:this.room.serverTime(),reason:t}):void 0)},e.prototype.gestapo=function(e){var t,n,o,i;if("string"==typeof e&&this.room.dystopia){for(i=[/ni+gg+e+r/i,/n\s*i\s*g\s*g\s*e\s*r/i,/nigga/i],n=0,o=i.length;o>n;n++)if(t=i[n],e.match(t))return this.ban(3e5),this.sync(!0),!0;return!1}},e.prototype.nominate=function(){var e,t,n,o,i=this;return this.touch(),this.room.escalate>this.room.acl.unlocked?void 0:this.elect_embargo&&this.elect_embargo>this.room.serverTime()?(this.notify("can not run for reelection for another "+Math.ceil((this.elect_embargo-this.room.serverTime())/6e4)+" minutes"),void 0):this.elect?void 0:(e=this.room.serverTime(),o=function(){var e,o;e=this.room.users,o=[];for(t in e)n=e[t],"_"!==t[0]&&n.active()&&!n.prefs.distraction&&o.push(t);return o}.call(this),this.__elect_timeout=setTimeout(function(){return i.verb("got romneyed",!0),i.elect_embargo=i.room.serverTime()+24e4,i.elect=null,i.sync(!0)},6e4),this.elect={votes:[],against:[],time:e,witnesses:o},this.vote_election({user:this.id,position:"elect"}))},e.prototype.create_tribunal=function(e){var t,n,o,i,r,a,s=this;if(null==e&&(e=!1),this.touch(),!this.tribunal){if(t=this.room.serverTime(),i=function(){var e,t;e=this.room.users,t=[];for(n in e)o=e[n],"_"!==n[0]&&o.active()&&!o.prefs.distraction&&t.push(n);return t}.call(this),i.length<=1)return;return this.room.users[null!=(r=this.tribunal)?r.initiator:void 0]&&!this.room.users[null!=(a=this.tribunal)?a.initiator:void 0].authorized("moderator")&&(this.room.users[this.tribunal.initiator].tribunal_embargo=this.room.serverTime()+6e4),this.__tribunal_timeout=setTimeout(function(){var e,t;return s.room.users[null!=(e=s.tribunal)?e.initiator:void 0]&&!s.room.users[null!=(t=s.tribunal)?t.initiator:void 0].authorized("moderator")&&(s.room.users[s.tribunal.initiator].tribunal_embargo=s.room.serverTime()+24e4,s.room.users[s.tribunal.initiator].sync()),s.verb("survived the tribunal",!0),s.tribunal=null,s.sync(!0)},6e4),this.tribunal={votes:[],against:[],time:t,witnesses:i,term:0,initiator:e},this.sync(!0)}},e.prototype.trigger_tribunal=function(e){var t,n;return this.touch(),e&&(null!=(t=this.room)?t.users[e]:void 0)?e===this.id?(this.notify("is somewhat of a masochist"),void 0):this.tribunal_embargo&&this.tribunal_embargo>this.room.serverTime()?(this.notify("can not trigger a ban tribunal for another "+Math.ceil((this.tribunal_embargo-this.room.serverTime())/6e4)+" minutes"),void 0):this.room.users[e].authorized("moderator")?(this.notify("cannot fell a god with a mortal sword"),void 0):(this.verb("created a ban tribunal for !@"+e),null!=(n=this.room.users[e])?n.create_tribunal(this.id):void 0):void 0},e.prototype.ban_user=function(e){var t,n,o;return this.authorized("moderator")?((!(null!=(t=this.room.users[e])?t.banned:void 0)||this.room.serverTime()>(null!=(n=this.room.users[e])?n.banned:void 0))&&this.verb("banned !@"+e+" from /"+this.room.name),null!=(o=this.room.users[e])?o.ban(3e5):void 0):void 0},e.prototype.vote_election=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,p,m,g,y,v,b;if(l=e.user,r=e.position,this.touch(),n=null!=(p=this.room.users[l])?p.elect:void 0){if(!n.term){if(c=n.votes,t=n.against,d=n.witnesses,m=this.id,f.call(d,m)<0)return;if(g=this.id,f.call(c,g)>=0||(y=this.id,f.call(t,y)>=0))return;return"elect"===r?c.push(this.id):"deny"===r?t.push(this.id):this.verb("voted from a diebold machine"),c.length>d.length/2+t.length&&(a=6e4,d=function(){var e,t;e=this.room.users,t=[];for(o in e)s=e[o],"_"!==o[0]&&s.active()&&t.push(o);return t}.call(this),this.room.users[l].elect={impeach:[],witnesses:d,term:this.room.serverTime()+a},this.room.users[l].inaugurate()),u=d.length-t.length-c.length,c.length+u<=d.length/2+t.length&&(this.room.users[l].verb("was not elected",!0),this.room.users[l].elect_embargo=this.room.serverTime()+72e4,this.room.users[l].impeach()),this.room.users[l].sync(!0)}if(n.term>this.room.serverTime()){if(i=n.impeach,d=n.witnesses,v=this.id,f.call(d,v)<0)return;if(b=this.id,f.call(i,b)>=0)return;if("impeach"===r)return i.push(this.id),h=Math.floor(d.length/2+1)-i.length,0>=h?(this.room.users[l].verb("was impeached from office",!0),this.room.users[l].impeach()):this.room.users[l].sync(!0)}}},e.prototype.inaugurate=function(){var e,t=this;if(null!=(e=this.elect)?e.term:void 0)return clearTimeout(this.__elect_timeout),this.__elect_timeout=setTimeout(function(){return t.verb("is no longer commander in chief",!0),t.impeach()},this.elect.term-this.room.serverTime())},e.prototype.impeach=function(){return this.elect=null,clearTimeout(this.__elect_timeout),this.sync(!0)},e.prototype.finish_term=function(){var e;if(null!=(e=this.elect)?e.term:void 0)return this.verb("has finished tenure in office",!0),this.impeach()},e.prototype.vote_tribunal=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,p;if(r=e.user,n=e.position,o=null!=(u=this.room.users[r])?u.tribunal:void 0){if(a=o.votes,t=o.against,s=o.witnesses,l=this.id,f.call(s,l)<0)return;if(c=this.id,f.call(a,c)>=0||(h=this.id,f.call(t,h)>=0))return;return"ban"===n?(a.push(this.id),this.verb("voted to ban !@"+r)):"free"===n?(t.push(this.id),this.verb("voted to free !@"+r)):this.verb("voted with a hanging chad"),a.length>(s.length-1)/2+t.length&&(this.room.users[r].verb("got voted off the island",!0),clearTimeout(this.room.users[r].__tribunal_timeout),this.room.users[r].tribunal=null,this.room.users[r].ban(9e5)),i=s.length-t.length-a.length-1,a.length+i<=(s.length-1)/2+t.length&&(this.room.users[null!=(d=this.room.users[r])?null!=(p=d.tribunal)?p.initiator:void 0:void 0]&&(this.room.users[this.room.users[r].tribunal.initiator].tribunal_embargo=this.room.serverTime()+48e4),this.room.users[r].verb("was freed because of a hung jury",!0),this.room.users[r].tribunal=null,clearTimeout(this.room.users[r].__tribunal_timeout)),this.room.users[r].sync(!0)}},e.prototype.verb=function(e,t){return"_"===this.id.toString()[0]?this.notify(e):(t||this.rate_limit(),this.room.emit("log",{user:this.id,verb:e,time:this.room.serverTime()}))},e.prototype.notify=function(e){return this.emit("log",{user:this.id,verb:e,time:this.room.serverTime(),notify:!0})},e.prototype.disconnect_all=function(){return this.room.log("QuizPlayer::disconnect_all() not implemented")},e.prototype.disconnected=function(){var e;return this.touch(),0===this.sockets.length&&(e=(this.room.serverTime()-this.last_session)/1e3,e>90?this.verb("left the room (logged on "+Math.round(e/60)+" minutes ago)"):e>1?this.verb("left the room (logged on "+Math.round(e)+" seconds ago)"):this.verb("left the room")),this.sync(!0)},e.prototype.echo=function(e,t){return e.avg&&e.std&&e.n&&(this.__latency=[e.avg,e.std,e.n]),t(this.room.serverTime())},e.prototype.buzz=function(e,t){return this.touch(),this.room.qid===e&&this.room.buzz(this.id,t)?this.rate_limit():void 0},e.prototype.guess=function(e){return this.touch(),this.room.guess(this.id,e),this.gestapo(null!=e?e.text:void 0)},e.prototype.command=function(e,t){var n,o;return"auth"===e?(null!=(n=t[0])?n.trim().toLowerCase():void 0)===("function"==typeof this._password?this._password():void 0)?this._apotheify():this.notify("has an invalid password"):"ragequit"===e||"qq"===e||"corgi"===e||"super"===e||"quit"===e||"dog"===e||"cute"===e?this.emit("redirect","http://i.imgur.com/4Dx75Bq.jpg"):"deauth"===e||"unauth"===e?this.cincinnatus():"rename"===e||"name"===e?this.set_name(null!=(o=t[0])?o.trim():void 0):this.notify("no command named `"+e+"` exists")},e.prototype.chat=function(e){var t,n,o,i,a,s,u,l,c,h,d,f,p,m,g;if(h=e.text,o=e.done,i=e.first,c=e.session,this.touch(),"string"==typeof h&&(this.gestapo(h)&&(h="****"),this.authorized(this.room.mute))){if("@$>"===h.substr(0,3)&&o)return p=h.substr(3).trim().split(" "),u=p[0],n=2<=p.length?r.call(p,1):[],this.command(u,n),void 0;if(h=h.slice(0,1e4),a=this.id,"_"===a[0]&&(a="__"+this.name.replace(/\s+/g,"_")),l={text:h,session:c,user:a,first:i,done:o,time:this.room.serverTime()},i){t={};for(s in l)f=l[s],t[s]=f;t.text="(typing)"}if(this.room.serverTime()<this.bubble)return this.emit("chat",l),void 0;if(o||"(typing)"===h)return this.rate_limit(),this.room.emit("chat",l);m=this.room.users,g=[];for(a in m)d=m[a],d.prefs.typing&&!d.muwave?g.push(d.emit("chat",l)):i?g.push(d.emit("chat",t)):g.push(void 0);return g}},e.prototype.skip=function(){return this.touch(),this.room.attempt||this.room.no_skip?void 0:(this.room.new_question(),this.verb("skipped a question"))},e.prototype.next=function(){return this.touch(),this.room.next()},e.prototype.finish=function(){return this.touch(),this.attempt||this.room.no_skip||this.room.time()>=this.room.end_time||this.room.time_freeze?void 0:(this.verb("skipped to the end of a question"),this.room.finish(),this.room.sync())},e.prototype.preempt=function(){return this.touch()},e.prototype.pause=function(){return this.touch(),this.room.no_pause||this.room.time_freeze?void 0:!this.room.attempt&&this.room.time()<this.room.end_time?(this.rate_limit(),this.verb("paused the game"),this.room.freeze(),this.room.sync()):void 0},e.prototype.unpause=function(){var e;return this.touch(),this.room.time_freeze?(this.room.question?this.room.attempt||(e=Math.round((this.room.offsetTime()-this.room.time_freeze)/1e3),e>2?this.verb("resumed the game (paused for "+e+" seconds}"):this.verb("resumed the game"),this.room.unfreeze()):(this.room.new_question(),this.room.unfreeze()),this.room.sync()):void 0},e.prototype.accelerate_cleanup=function(){return this.score()<=20?this.room.delete_user(this.id):void 0},e.prototype.set_distribution=function(e){var t,n,o,i,r=this;if(this.touch(),this.authorized()&&e){i=[],o=[];for(t in e)n=e[t],0===this.room.distribution[t]&&n>0&&i.push(t),this.room.distribution[t]>0&&0===n&&o.push(t);return this.room.distribution=e,this.room.sync(4),this.room.get_size(function(e){return i.length>0&&r.verb("enabled "+i.join(", ")+" ("+e+" questions)"),o.length>0?r.verb("disabled "+o.join(", ")+" ("+e+" questions)"):void 0})}},e.prototype.set_difficulty=function(e){var t=this;return this.touch(),this.authorized()?(this.room.difficulty=e,this.room.sync(4),this.room.get_size(function(n){return t.verb("set difficulty to "+(e||"everything")+" ("+n+" questions)"),0===n&&t.room.category?t.set_category(""):void 0})):void 0},e.prototype.set_category=function(e){var t=this;return this.touch(),this.authorized()?(this.room.category=e,e||this.room.reset_distribution(),"custom"===e?this.room.sync(4):this.room.sync(1),this.room.get_size(function(n){return"custom"===e?t.verb("enabled a custom category distribution ("+n+" questions)"):t.verb("set category to "+(e.toLowerCase()||"potpourri")+" ("+n+" questions)")})):void 0},e.prototype.set_max_buzz=function(e){return this.touch(),this.authorized()?(this.room.max_buzz!==e&&(e?1===e?this.verb("restricted players and teams to a single buzz per question"):e>1&&this.verb("restricted players and teams to "+e+" buzzes per question"):this.verb("allowed players to buzz multiple times")),this.room.max_buzz=e,this.room.sync(1)):void 0},e.prototype.set_skip=function(e){return this.touch(),this.authorized()?(this.room.no_skip=!e,this.room.sync(1),this.room.no_skip?this.verb("disabled question skipping"):this.verb("enabled question skipping")):void 0},e.prototype.set_pause=function(e){return this.touch(),this.authorized()?(this.unpause(),e?this.verb("enabled pausing questions"):this.verb("disabled pausing questions"),this.room.no_pause=!e,this.room.sync(1)):void 0},e.prototype.set_bonus=function(e){return this.touch(),this.authorized()?(this.room.show_bonus=!!e,this.room.show_bonus?this.verb("enabled showing bonus questions"):this.verb("disabled showing bonus questions"),this.room.sync(1)):void 0},e.prototype.set_speed=function(e){return this.touch(),!this.authorized()||isNaN(e)||0>=e?void 0:(this.room.set_speed(e),this.room.sync(1))},e.prototype.set_duration=function(e){return this.touch(),!this.authorized("ninja")||isNaN(e)||0>=e?void 0:(this.room.answer_duration=e,this.room.set_speed(this.room.rate),this.room.sync(1))},e.prototype.set_prompt_duration=function(e){return this.touch(),!this.authorized("ninja")||isNaN(e)||0>=e?void 0:(this.room.prompt_duration=e,this.room.sync(1))},e.prototype.set_attempt_duration=function(e){return this.touch(),!this.authorized("ninja")||isNaN(e)||0>=e?void 0:(this.room.attempt_duration=e,this.room.sync(1))},e.prototype.set_scoring=function(e){return this.touch(),this.authorized("ninja")?(this.verb("changed scoring matrix"),this.room.scoring=e,this.room.sync(4)):void 0},e.prototype.set_semi=function(e){return this.touch(),this.authorized("ninja")?(e?this.verb("enabled semi-transparent readouts"):this.verb("disabled semi-transparent readouts"),this.room.semi=!!e,this.room.sync(1)):void 0},e.prototype.set_type=function(e){var t=this;return this.touch(),this.authorized("ninja")?"string"!=typeof e?this.notify("error `"+state+"` is not string"):e?(this.room.type=e,this.room.category="",this.room.difficulty="",this.room.sync(4),this.room.get_size(function(n){return t.verb("changed the question type to "+e+" ("+n+" questions)")})):void 0:void 0},e.prototype.set_escalate=function(e){return this.touch(),this.authorized("ninja")?"number"!=typeof e?this.notify("error `"+e+"` is not number"):(this.room.escalate=e,this.room.sync(2),this.verb("changed minimum escalation permission level to `"+e+"`")):void 0},e.prototype.set_mute=function(e){return this.touch(),this.authorized("ninja")?"number"!=typeof e?this.notify("error `"+e+"` is not number"):(this.room.mute=e,this.room.sync(1)):void 0},e.prototype.set_topic=function(e){return this.touch(),this.authorized("ninja")?"string"!=typeof e?this.notify("error `"+state+"` is not string"):(this.room.topic=e,this.room.sync(4)):void 0},e.prototype.set_dystopia=function(e){return this.touch(),this.authorized("ninja")?(this.room.dystopia=e,this.room.sync(4),this.verb("set dystopia mode to "+e)):void 0},e.prototype.pref=function(e,t){return this.touch(),"string"==typeof e&&"toString"!==e&&"toLocaleString"!==e&&"valueOf"!==e&&"hasOwnProperty"!==e&&"isPrototypeOf"!==e&&"propertyIsEnumerable"!==e&&"constructor"!==e?"_"!==e[0]?(this.prefs[e]=t,this.sync(!0)):void 0:void 0},e.prototype.set_team=function(e){return this.touch(),e?this.verb("switched to team "+e):e!==this.name&&this.verb("is playing as an individual"),this.team=e,this.sync(!0)},e.prototype.set_idle=function(e){return this.idle=!!e},e.prototype.set_lock=function(e){return this.lock=!!e,this.touch(),this.sync(!0)},e.prototype.set_name=function(e){var t;return this.touch(),this.gestapo(e),(e+"").trim().length>0?(t=140,this.room.dystopia&&(t=30),this.name=e.trim().slice(0,t).replace(/\u202e|\u2606|\u2605|\u269d/g,""),this.sync(!0)):void 0},e.prototype.report_question=function(){return this.verb("QuizPlayer::report_question({id, tags}) not implemented")},e.prototype.tag_question=function(){return this.verb("QuizPlayer::tag_question({id, tags}) not implemented")},e.prototype.change_bold=function(){return this.verb("QuizPlayer::change_bold({id, answer}) not implemented")},e.prototype.report_answer=function(){return this.verb("QuizPlayer::report_answer(data) not implemented")},e.prototype.check_public=function(){return this.verb("QuizPlayer::check_public() not implemented")},e.prototype._apotheify=function(){return this.moderator?void 0:(this.verb("is now an administrator of this room"),this.admin_name=this.name,this.moderator=!0,this.room.sync(2))},e.prototype.cincinnatus=function(){return this.moderator?(this.verb("is no longer an administrator of this room"),this.moderator=!1,this.admin_name="",this.room.sync(2)):void 0},e.prototype.serialize=function(){var e,t,n,o;n={},t=["sockets","room","times_buzzed"];for(e in this)f.call(t,e)<0&&"function"!=(o=typeof this[e])&&"_"!==e[1]&&(n[e]=this[e]);return n},e.prototype.deserialize=function(e){var t,n,o;n=["tribunal","elect","times_buzzed"];for(t in e)o=e[t],"_"!==t[1]&&f.call(n,t)<0&&(this[t]=o);return this.correct||this.interrupts||this.early||this.guesses?(this.verb("was upgraded to the new scoring system"),this.corrects.normal=this.correct,this.wrongs.normal=this.guesses-this.correct,delete this.correct,this.corrects.early=this.early,this.wrongs.early=0,delete this.early,this.corrects.interrupt=0,this.wrongs.interrupt=this.interrupts,delete this.interrupts,delete this.guesses,this.sync(!0)):void 0},e.prototype.update=function(){return 1},e.prototype.sync=function(e){return null==e&&(e=!1),e&&"_"!==this.id[0]?this.room.emit("sync",this.room.sync(this)):this.emit("sync",this.room.sync(this))},e}(),"undefined"!=typeof exports&&null!==exports&&(exports.QuizPlayer=d);var m,p,y,f=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};y={category:"$0x40000",difficulty:"segmentation fault",num:"NaN",tournament:"Guru Meditation Cup",question:"This type of event occurs when the queried database returns an invalid question and is frequently indicative of a set of constraints which yields a null set. Certain manifestations of this kind of event lead to significant monetary loss and often result in large public relations campaigns to recover from the damaged brand valuation. This type of event is most common with computer software and hardware, and one way to diagnose this type of event when it happens on the bootstrapping phase of a computer operating system is by looking for the POST information. Kernel varieties of this event which are unrecoverable are referred to as namesake panics in the BSD/Mach hybrid microkernel which powers Mac OS X. The infamous Disk Operating System variety of this type of event is known for its primary color backdrop and continues to plague many of the contemporary descendents of DOS with code names such as Whistler, Longhorn and Chidori. For 10 points, name this event which happened right now.",answer:"error",year:1970,round:"0x080483ba"},p={category:"Mission Accomplished",difficulty:"null",num:"undefined",tournament:"magic smoke",question:"This question has not yet been written.",answer:"failure",year:2003,round:"1"},m=function(){function e(e){null==e&&(e="temporary"),this.name=e,this.type="qb",this.realm=null,this.answer_duration=5e3,this.attempt_duration=8e3,this.prompt_duration=1e4,this.time_offset=0,this.sync_offset=0,this.start_offset=0,this.last_action=0,this.time_spent=0,this.seen=0,this.end_time=0,this.begin_time=0,this.question="",this.value=null,this.answer="",this.info={},this.qid=null,this.timing=[],this.cumulative=[],this.rate=60,this.__timeout={},this.distribution=null,this.freeze(),this.users={},this.difficulty="",this.category="",this.max_buzz=null,this.attempt=null,this.no_skip=!1,this.show_bonus=!1,this.semi=!1,this.no_pause=!1,this.dystopia=0,this.created=this.serverTime(),this.scoring={normal:[10,0],early:[20,-5],interrupt:[10,-5]},this.acl={baseline:100,positive:110,fifty:120,unlocked:200,elected:230,moderator:300,admin:310,ninja:400},this.mute=this.acl.baseline,this.escalate=this.acl.unlocked}return e.prototype.touch=function(){var e,t;return e=this.serverTime(),t=e-this.last_action,18e4>t&&(this.time_spent+=t),this.last_action=e},e.prototype.log=function(e){return this.emit("log",{verb:e})},e.prototype.locked=function(){var e,t,n,o,i,r;if(this.escalate&&this.escalate>this.acl.unlocked)return!0;t=0,n=0,r=this.users;for(e in r)i=r[e],i.active()&&i.active()&&(t++,i.lock&&n++);return o=Math.floor(t/2+1),2>=t?!1:n>=o?!0:!1},e.prototype.admin_online=function(){var e,t,n;n=this.users;for(e in n)if(t=n[e],t.active()&&t.authorized("moderator"))return!0;return!1},e.prototype.active_count=function(){var e,t,n,o;e=0,o=this.users;for(t in o)n=o[t],n.active()&&e++;return e},e.prototype.get_parameters=function(e,t,n){return this.emit("log",{verb:"NOT IMPLEMENTED (async get params)"}),n(["HS","MS"],["Science","Trash"])},e.prototype.count_questions=function(){return this.log("NOT IMPLEMENTED (question counting)")},e.prototype.get_size=function(e,t,n,o){return null==t&&(t=this.type),null==n&&(n=this.difficulty),null==o&&(o=this.category),this.count_questions(t,n,"custom"===o?this.distribution:o,function(t){return e(t)})},e.prototype.get_question=function(e){var t=this;return setTimeout(function(){return"__error_bonus"===t.next_id?e(p):e(y)},10),this.log("NOT IMPLEMENTED (async get question)")},e.prototype.emit=function(){return console.log("room.emit(name, data) not implemented")},e.prototype.reset_distribution=function(){var e,t,n,o=this;return e={},n=function(t){var n,o,i,r,a,s;a={},i=0,o=0,s=0;for(n in e)r=e[n],a[n]=Math.round(r/t),o+=a[n],s+=r,i+=Math.abs(a[n]*t-r);return[a,i/s+o/20]},t=function(){var t,o,i,r,a,s,u,l;a=1/0;for(o in e)s=e[o],a>s&&s>1&&(a=s);return r=a,l=n(r),u=l[0],i=l[1],t=l[2],u},this.get_parameters(this.type,this.difficulty,function(n,i){var r;return r=function(){var n;return n=i.shift(),n?o.count_questions(o.type,o.difficulty,n,function(t){return e[n]=t,r()}):o.distribution=t()},r()})},e.prototype.time=function(){return this.time_freeze?this.time_freeze:this.offsetTime()},e.prototype.offsetTime=function(){return this.serverTime()-this.time_offset},e.prototype.serverTime=function(){return new Date-this.sync_offset},e.prototype.set_time=function(e){return this.time_offset=this.serverTime()-e},e.prototype.freeze=function(){return this.time_freeze=this.time()},e.prototype.unfreeze=function(){return this.time_freeze?(this.set_time(this.time_freeze),this.time_freeze=0):void 0},e.prototype.timeout=function(e,t){return this.clear_timeout(),this.__timeout=setTimeout(t,e)},e.prototype.clear_timeout=function(){return clearTimeout(this.__timeout)},e.prototype.check_timeout=function(){return this.attempt&&this.serverTime()>this.attempt.realTime+this.attempt.duration?(this.clear_timeout(),this.end_buzz(this.attempt.session)):void 0},e.prototype.new_question=function(){var e=this;return this.generating_question=this.serverTime(),this.get_question(function(t){var n,o,i,r,a,s,u,l;t&&t.question&&t.answer||(t=y),delete e.generating_question,e.generated_time=e.serverTime(),e.attempt=null,e.clear_timeout(),e.next_id=t.next||null,e.info={category:t.category,difficulty:t.difficulty,tournament:t.tournament,num:t.num,year:t.year,date:t.date,group:t.group,tags:t.tags,round:t.round},e.value=t.value||null,e.question=t.question.replace(/FTP/g,"For 10 points").replace(/^\[.*?\]/,"").replace(/\n/g," ").replace(/\s+/g," "),e.answer=t.answer.replace(/\<\w\w\>/g,"").replace(/\[\w\w\]/g,""),e.qid=(null!=t?null!=(u=t._id)?u.toString():void 0:void 0)||(null!=t?t.qid:void 0)||(null!=t?t.id:void 0)||"question_id",e.begin_time=e.time()+e.start_offset,r="undefined"!=typeof yo&&null!==yo?yo:require("./lib/syllable").syllables,e.timing=function(){var e,t,n,o;for(n=this.question.split(" "),o=[],e=0,t=n.length;t>e;e++)s=n[e],i=+r(s)||0,s.split(".").length>1&&(i+=s.lenth>2?4:2),s.split(",").length>1&&(i+=2),o.push(1+i);return o}.call(e),e.set_speed(e.rate),n=e.question.indexOf("*")>5,e.seen++,l=e.users;for(o in l)a=l[o],a.times_buzzed=0,a.active()&&(a.seen++,n&&a.earlyseen++),a.history.push(a.score()),a.history=a.history.slice(-30);return e.journal(),e.sync(3)})},e.prototype.set_speed=function(e){var t,n,o,i,r,a,s;if(e)return t=function(e,t){var n,o,i,r,a,s;for(o=0,a=[5].concat(e).slice(0,-1),s=[],i=0,r=a.length;r>i;i++)n=a[i],s.push(o+=Math.round(n*t));return s},a=this.time(),this.cumulative=t(this.timing,this.rate),i=a-this.begin_time,o=this.cumulative[this.cumulative.length-1],n=i/o,s=0,n>1&&(s=i-o,n=1),this.rate=e,this.cumulative=t(this.timing,this.rate),r=this.cumulative[this.cumulative.length-1],this.begin_time=Math.round(a-r*n-s),this.end_time=Math.round(this.begin_time+r+this.answer_duration),isNaN(this.begin_time)&&(this.begin_time=0),isNaN(this.end_time)?this.end_time=0:void 0},e.prototype.finish=function(){return this.emit("finish_question",this.time()),this.set_time(this.end_time)},e.prototype.next=function(){if(!(this.attempt||this.time()<=this.end_time)){if(this.generating_question&&this.serverTime()-this.generating_question>2e3)return delete this.generating_question,void 0;if(!this.generating_question)return this.unfreeze(),this.new_question()}},e.prototype.check_answer=function(){return Math.random()>.8?"prompt":Math.random()>.3},e.prototype.end_buzz=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,f,p,m=this;if((null!=(h=this.attempt)?h.session:void 0)===e){if(l=this.users[null!=(d=this.attempt)?d.user:void 0],!this.attempt||!l)return this.attempt=null,this.sync(),void 0;if(this.attempt.prompt?(this.attempt.done=!0,this.attempt.correct=this.check_answer(this.attempt.text,this.answer,this.question),"prompt"===this.attempt.correct&&(this.attempt.correct=!1),this.sync()):(this.clear_timeout(),this.attempt.done=!0,this.attempt.correct=this.check_answer(this.attempt.text,this.answer,this.question),n=!1,"prompt"===this.attempt.correct&&(n=!0,this.attempt.correct=!1),n===!0&&(this.attempt.correct="prompt",this.sync(),this.attempt.prompt=!0,this.attempt.done=!1,this.attempt.realTime=this.serverTime(),this.attempt.start=this.time(),this.attempt.text=this.attempt.text.trim()+" ",this.attempt.duration=this.prompt_duration,this.timeout(this.attempt.duration,function(){return m.end_buzz(e)}),l.prompts++),this.sync()),this.attempt.done){if(this.unfreeze(),c=this.value,null===c&&(c="normal",this.attempt.interrupt&&(c="interrupt"),this.attempt.early&&(c="early")),c in this.scoring||this.log("Warning: entry `"+c+"` does not exist in the scoring matrix and will not be counted. Please contact info@protobowl.com to resolve this issue."),this.attempt.correct){l.streak++,l.streak_record=Math.max(l.streak,l.streak_record),f=this.users;for(o in f)u=f[o],o!==this.attempt.user&&(u.streak=0);l.negstreak=0,("number"!=typeof l.corrects[c]||isNaN(l.corrects[c]))&&(l.corrects[c]=0),l.corrects[c]++,this.finish()}else{l.streak=0,l.negstreak++,l.negstreak_record=Math.max(l.negstreak,l.negstreak_record),("number"!=typeof l.wrongs[c]||isNaN(l.wrongs[c]))&&(l.wrongs[c]=0),l.wrongs[c]++,t=0,i=0,a={},p=this.users;for(o in p)u=p[o],"_"!==o[0]&&u.active()&&(a[u.team||o]=a[u.team||o]||0,a[u.team||o]+=u.times_buzzed);for(r in a)s=a[r],s>=this.max_buzz&&this.max_buzz&&t++,i++;this.max_buzz&&t>=i&&this.finish()}return this.journal(),this.attempt=null,this.sync(2)}}},e.prototype.buzz=function(e,t){var n,o,i,r,a,s,u,l=this;if(a=0,!(e in this.users))return!1;s=this.users;for(o in s)i=s[o],(i.team||o)===(this.users[e].team||e)&&(a+=i.times_buzzed);if(this.max_buzz&&this.users[e].times_buzzed>=this.max_buzz)t&&t("THE BUZZES ARE TOO DAMN HIGH"),this.attempt||this.emit("log",{user:e,verb:"has already buzzed"});else if(this.max_buzz&&a>=this.max_buzz)t&&t("THE BUZZES ARE TOO DAMN HIGH"),this.emit("log",{user:e,verb:"is in a team which has already buzzed"});else if(!(null!=(u=this.scoring)?u.interrupt:void 0)&&this.time()<=this.end_time-this.answer_duration)this.emit("log",{user:e,verb:"attempted an illegal interrupt"}),t&&t("THE GAME");else{if(!this.attempt&&this.time()<=this.end_time)return t&&t("http://www.whosawesome.com/"),r=Math.random().toString(36).slice(2),n=this.question.replace(/[^ \*]/g,"").indexOf("*"),this.attempt={user:e,realTime:this.serverTime(),start:this.time(),duration:this.attempt_duration,session:r,text:"",early:-1!==n&&this.time()<this.begin_time+this.cumulative[n],interrupt:this.time()<this.end_time-this.answer_duration,done:!1},this.users[e].times_buzzed++,this.freeze(),this.sync(2),this.timeout(this.attempt.duration,function(){return l.end_buzz(r)
}),!0;this.attempt?(this.emit("log",{user:e,verb:"lost the buzzer race"}),t&&t("THE GAME")):(this.emit("log",{user:e,verb:"attempted an invalid buzz"}),t&&t("THE GAME"))}return!1},e.prototype.guess=function(e,t){var n;return(null!=(n=this.attempt)?n.user:void 0)===e?(this.attempt.text=t.text.slice(0,200),t.done?this.end_buzz(this.attempt.session):this.sync(-1)):void 0},e.prototype.sync=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,p,m,g,y,v,b,w=this;for(null==e&&(e=0),o={real_time:this.serverTime()},l=["time_offset","time_freeze","attempt"],c=0,p=l.length;p>c;c++)t=l[c],o[t]=this[t];if(n=["cumulative","users","sync_offset","generating_question"],r=["question","answer","timing","info","generated_time"],a=["realm","created","topic","acl","scoring"],u=["sockets","room"],e.id){s={};for(t in e)f.call(u,t)<0&&"function"!=(y=typeof e[t])&&"_"!==t[0]&&(s[t]=e[t]);return s.online_state=e.online(),o.users=[s],o}if(e>=1)for(t in this)"function"!=typeof this[t]&&f.call(n,t)<0&&f.call(r,t)<0&&f.call(a,t)<0&&"_"!==t[0]&&(o[t]=this[t]);if(e>=2&&(o.users=function(){var e,n;n=[];for(i in this.users)if("_"!==i[0]){s={};for(t in this.users[i])f.call(u,t)<0&&"function"!=(e=typeof this.users[i][t])&&"_"!==t[0]&&(s[t]=this.users[i][t]);s.online_state=this.users[i].online(),n.push(s)}return n}.call(this)),e>=3)for(h=0,m=r.length;m>h;h++)t=r[h],o[t]=this[t];if(e>=4){for(d=0,g=a.length;g>d;d++)t=a[d],o[t]=this[t];return this.distribution||this.reset_distribution(),this.get_parameters(this.type,this.difficulty,function(e,t){var n,i,r,a;if(o.difficulties=e,o.categories=t,w.distribution){for(r=0,a=t.length;a>r;r++)n=t[r],w.distribution[n]=w.distribution[n]||0;for(i in w.distribution)f.call(t,i)<0&&delete w.distribution[i];o.distribution=w.distribution}return w.emit("sync",o)}),this.journal()}if(0>e){v=this.users,b=[];for(i in v)s=v[i],s.muwave||b.push(s.emit("sync",o));return b}return this.emit("sync",o)},e.prototype.journal=function(){return 0},e.prototype.delete_user=function(e){return this.users[e]?("_"!==e[0]&&this.emit("delete_user",e),this.users[e]=null,delete this.users[e]):!1},e.prototype.serialize=function(){var e,t,n,o,i,r;n={},t=["users","attempt","generating_question","acl"];for(e in this)f.call(t,e)<0&&"function"!=(r=typeof this[e])&&"_"!==e[1]&&(n[e]=this[e]);return n.users=function(){var e,t;e=this.users,t=[];for(o in e)i=e[o],t.push(i.serialize());return t}.call(this),n},e}(),"undefined"!=typeof exports&&null!==exports&&(exports.QuizRoom=m);var g,w,b,v,k,_,E,C,x,A,D,T,O,I,S,z,f=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};C=function(e,t,n){var o;return null==n&&(n=5e3),o=$("<div>").addClass("alert").hide(),o.append($("<button>",{"data-dismiss":"alert",type:"button"}).html("&times;").addClass("close")),o.append($("<strong>").text(e)),o.append(" "),o.append(t),setTimeout(function(){return o.slideDown()},10),setTimeout(function(){return o.slideUp().queue(function(){return $(this).dequeue(),$(this).remove()})},n),o},g=function(e,t){var n,o;return null==t&&(t="undefined"!=typeof sync&&null!==sync?sync.name:void 0),$(".bundle .ruling").tooltip("destroy"),o=$(".room-"+(t||"").replace(/[^a-z0-9]/g,"")),0===o.length&&(o=$("#history .bundle.active")),n=o.eq(0).find(".annotations"),0===n.length&&(n=$("#history .annotations").eq(0)),e.prependTo(n),e.hasClass("annoying")&&Wt.prefs.distraction||e.css("display","none").slideDown(),e},w=function(e){return $(".bundle .ruling").tooltip("destroy"),0!==$("#history .bundle.active .sticky").length?e.css("display","none").prependTo($("#history .bundle.active .sticky")):e.css("display","none").prependTo($("#history .sticky:first")),e.slideDown(),e},S=function(e,t){var n,o,i,r,a;return r="undefined"!=typeof Xt&&null!==Xt?Xt.users[e]:void 0,i=$(document.createElement("span")).data("id",e),"__"===e.slice(0,2)?i.text(e.slice(2).replace(/_/g," ")):i.text((null!=r?r.name:void 0)||"[name missing]"),o=function(e){return i.prepend("<i class='icon-"+e+" user-prefix'></i>")},"__"===e.slice(0,2)?/ninja/.test(e)?o("magic"):o("bullhorn"):(null!=r?r.banned:void 0)&&r.banned>Xt.serverTime()?o("ban-circle"):(null!=r?r.authorized("moderator"):void 0)?o("star-empty"):(null!=r?null!=(a=r.prefs)?a.distraction:void 0:void 0)?(o("eye-close"),i.attr("title","This user has enabled distraction-free mode.")):(null!=r?r.auth:void 0)&&i.addClass("auth"),(null!=r?r._suffix:void 0)&&(i.append(" "),i.append($('<span style="color: rgb(150, 150, 150)">').text(r._suffix))),n="userhash-"+encodeURIComponent(i.attr("class")+i.html()).replace(/[^a-z0-9]/g,""),i.addClass("username user-"+e),t&&$(".user-"+e+":not(."+n+")").replaceWith(function(){return i.clone()}),i},O=function(e){var t,n,o,i;return e||($(".tooltip").remove(),$(".banham").each(function(){return O($(this))})),e&&(n=e.hasClass("full"),o=e.data("uid"),"_"!==o[0]&&Nt()&&(e.html(""),Xt.users[o]))?(t="",o===Wt.id?(t="identity",e.append($("<span>",{title:"This post can be used against you",rel:"tooltip"}).addClass("pull-right banhammer").append($("<i>").addClass("icon-legal")))):(Wt.reprimand_embargo<Xt.serverTime()||Wt.authorized("elected"))&&(t="reprimand"),6e5>(i=Date.now()-Xt.users[o].__reprimanded)&&i>1e4&&Wt.tribunal_embargo<Xt.serverTime()&&!Xt.admin_online()&&(t="tribunal"),n||Wt.authorized("moderator")||(Xt.users[o].banned>Xt.serverTime()?(e.append($("<span>").addClass("pull-right banhammer").css("color","#c83025").append($("<i>").addClass("icon-ban-circle"))),t=""):""===t&&e.append($("<span>").addClass("pull-right banhammer").append($("<i>").addClass("icon-legal")))),("reprimand"===t||n)&&e.append($("<a>",{href:"#",title:"Reprimand this user",rel:"tooltip","data-id":o}).addClass("label label-info pull-right banhammer reprimand").append($("<i>").addClass("icon-thumbs-down"))),("tribunal"===t||n)&&e.append($("<a>",{href:"#",title:"Initiate ban tribunal for this user",rel:"tooltip","data-id":o}).addClass("label label-warning pull-right banhammer make-tribunal").append($("<i>").addClass("icon-legal"))),n||Wt.authorized("moderator")?e.append($("<a>",{href:"#",title:"Instantly ban this user for 10 minutes",rel:"tooltip","data-id":o}).addClass("label label-important pull-right banhammer instaban").append($("<i>").addClass("icon-ban-circle"))):void 0):void 0},b=function(e,t){var n;return null==t&&(t=!1),n=$("<span>").addClass("banham banham-"+e).attr("data-uid",e),"boolean"==typeof t&&t===!0&&n.addClass("full"),"string"==typeof t&&t&&n.attr("data-reason",t),O(n),n},x=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,f,p,m,g,y,v,w,k,_,x,E,T;return y=e.session,v=e.text,w=e.user,a=e.done,i=e.correct,l=e.interrupt,s=e.early,f=e.prompt,u=""+w+"-"+y+"-"+(f?"prompt":"guess"),$("#"+u).length>0?c=$("#"+u):(c=$("<p>").attr("id",u).addClass("guess"),f?(p=$("<a>").addClass("label prompt label-info").text("Prompt"),c.append(" "),c.append(p)):(h=$("<span>").addClass("label").text("Buzz"),s||(l?h.addClass("label-important"):h.addClass("label-info")),c.append(h)),c.append(" "),c.append(S(w)),c.append(document.createTextNode(" ")),$("<span>").addClass("comment").appendTo(c),g=$("<a>").addClass("label ruling").hide().attr("href","#").attr("title","Click to Report").data("placement","right"),c.append(" "),c.append(g),t=$("#history .bundle:first .annotations"),0===t.length&&(t=$("#history .annotations:first")),c.css("display","none").prependTo(t),c.slideDown()),a?""===v?c.find(".comment").html("<em>(blank)</em>"):c.find(".comment").text(v):Wt.muwave?c.find(".comment").html('<em style="color:gray">(typing...)</em>'):c.find(".comment").text(v),a&&(g=c.find(".ruling").css("display","none"),r="","prompt"===i?(g.addClass("label-info").text("Prompt"),r="prompt"):i?(r="correct",g.addClass("label-success").text("Correct"),(null!=(k=Xt.users[w])?k.streak:void 0)>3&&Xt.active_count()>2&&c.prepend(b(w)),w===Wt.id&&(d=Wt.score(),o=function(){var e,t,n,i,r;return n=Wt.score(),n===d?(setTimeout(o,100),void 0):(e=1e3,t=Math.round(d/e)*e,0!==t?t>0&&t>d&&n>=t&&(null!=(i=Xt.scoring)?null!=(r=i.normal)?r[0]:void 0:void 0)<20?($("body").fireworks(10*(t/e)),C("Congratulations","You have over "+t+" points! Here's some fireworks.").addClass("alert-success").insertAfter(g.parents(".bundle").find(".annotations"))):void 0:void 0)},o())):(r="wrong",g.addClass("label-warning").text("Wrong"),(((null!=(_=Xt.users[w])?_.negstreak:void 0)>3||(null!=(x=Xt.users[w])?x.score():void 0)<0)&&Xt.active_count()>2||("function"==typeof ho?ho(v):void 0))&&c.prepend(b(w,"bad language")),w===Wt.id&&Wt.id in Xt.users&&(d=Wt.score(),-50>d&&(null!=(E=Xt.scoring)?null!=(T=E.normal)?T[0]:void 0:void 0)<20&&C("you suck","like seriously you really really suck. you are a turd.").addClass("alert-info").insertAfter(g.parents(".bundle").find(".annotations")))),g.fadeIn().css("display","inline"),n=Xt.answer,m=Xt.qid,g.click(function(){return Wt.report_answer({guess:v,answer:n,ruling:r,qid:m}),C("Reported Answer","You have successfully told me that my algorithm sucks. Thanks, I'll fix it eventually. ").addClass("alert-success").insertAfter(g.parents(".bundle").find(".annotations")),!1}),"guess"===st&&$t("")),c},_=function(e){var n,o,i,r,a,s,u,l,c,h,d,p,m,y,v,w,k,_,C,x,E,T,D;c=e.session,m=e.text,k=e.user,i=e.done,y=e.time,c||(c="auto-"+Math.random().toString(36).slice(3)),s=k+"-"+c,$("#"+s).length>0?u=$("#"+s):(u=$("<p>").attr("id",s).addClass("chat annoying"),u.append($("<span>").addClass("author").append(S(k).attr("title",t(y)))),u.append($("<span>").addClass("timecolon").append(" ("+t(y)+"): ")),u.append(document.createTextNode(" ")),$("<span>").addClass("comment").appendTo(u),g(u,null!=(C=Xt.users[k])?null!=(x=C.room)?x.name:void 0:void 0)),_=[],w=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,r=m.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(^|\s+)(\/[a-z0-9\-]+\/?[a-z0-9\-]*)(\s+|$)/g,function(e,t,n,o){return t+("<a href='"+n+"'>"+n+"</a>")+o}).replace(w,function(e){var t;return t=e,/:\//.test(e)||(t="http://"+e),/\.(jpe?g|gif|png)$/i.test(e)?"<a href='"+t+"' class='show_image' target='_blank'>"+e+"</a> (click to show) 				<div style='display:none;overflow:hidden' class='chat_image'>					<img src='"+t+"' alt='"+e+"'>				</div>":"<a href='"+t+"' target='_blank'>"+e+"</a>"}).replace(/!@([a-z0-9]+)/g,function(e,t){return _.push(t),S(t).wrap("<span>").parent().addClass("recipient").clone().wrap("<div>").parent().html()}),p={},E=Xt.users;for(a in E)v=E[a],p[v.team||"individuals"]=1;d=[];for(h in p)r=r.replace(new RegExp("\\*@("+RegExp.quote(h)+")","g"),function(e,t){return d.push(t),$("<span>").text(t).addClass("team-recipient").wrap("<div>").parent().html()});return i?(u.removeClass("buffer"),T=Wt.team||"individuals",l=f.call(d,T)>=0||(D=Wt.id,f.call(_,D)>=0)||"_"===Wt.id[0]||k===Wt.id,n="@"!==m[0]||l,l&&u.removeClass("annoying"),""!==m&&n?("@"===m.slice(0,1)&&(d.length>0?u.prepend('<i class="icon-group"></i> '):u.prepend('<i class="icon-user"></i> ')),o="function"==typeof ho?ho(m):void 0,o&&"lobby"===Xt.name&&(r=r.replace(/nigger/gi,"******")),u.find(".comment").html(r),k in Xt.users&&(o?u.prepend(b(k,"bad language")):m.length>70&&u.prepend(b(k,"spamming")))):(u.find(".comment").html("<em>(no message)</em>"),u.slideUp("normal",function(){return u.remove()}))):$(".livechat")[0].checked&&"(typing)"!==m?(u.removeClass("buffer"),u.find(".comment").html(r)):(u.addClass("buffer"),u.find(".comment").text(" is typing...")),u.toggleClass("typing",!i),u.data("last_update",y)},I=function(e){var t,n,o,i;return o=e.time,i=e.trigger,n=e.reason,setTimeout(function(){return $(".bundle .ruling").tooltip("destroy")},100),t=$("<p>").addClass("log"),t.prepend('<i class="icon-thumbs-down"></i> '),"_"!==(null!=i?i[0]:void 0)&&Xt.users[i]?(t.append(S(i)),t.append(" has issued you a warning for "),n?t.append(n):t.append("your behavior"),t.append(" ")):(t.append("your behavior has been reprimanded"),n&&(t.append(" for "),t.append(n))),g(t)},v=function(e){var n,o,i,r,a;return a=e.user,i=e.qid,r=e.time,n=e.answer,setTimeout(function(){return $(".bundle .ruling").tooltip("destroy")},100),o=$("<p>").addClass("log"),o.append(S(a).attr("title",t(r))),o.append(" changed the answer line to "),o.append(n.replace(/\{/g,"<strong>").replace(/\}/g,"</strong>")),$(".bundle.qid-"+i+" .annotations").prepend(o.hide()),o.slideDown()},z=function(e){var n,o,i,r,a,s,u,l;return s=e.user,u=e.verb,a=e.time,i=e.notify,setTimeout(function(){return $(".bundle .ruling").tooltip("destroy")},100),l="verb-"+s+"-"+u.replace(/[^a-z]/gi," ").split(" ").slice(0,2).join("-"),o=$("<p>").addClass("log annoying"),o.addClass(l),s?(s!==Wt.id||/skip|pause|resume/.test(u)||o.removeClass("annoying"),i&&o.prepend('<i class="icon-user"></i> '),o.append(S(s).attr("title",t(a))),o.append(" "+u.replace(/!@([a-z0-9]+)/g,function(e,t){return S(t).clone().wrap("<div>").parent().html()}))):o.append(u),(/paused the/.test(u)||/skipped/.test(u)||/category/.test(u)||/difficulty/.test(u)||/ban tribunal/.test(u)||"_"===Wt.id[0])&&o.prepend(b(s)),n=$(".bundle.active .verb-"+s+"-left-the"),"joined"===u.split(" ")[0]&&n.length>0?(n.slideUp("normal",function(){return $(this).remove()}),z({user:s,verb:"reloaded the page",time:a}),void 0):(r=$(".bundle.active ."+l),r.length>0?(o.data("count",r.data("count")+1),o.hide(),o.prepend($('<span style="margin-right:5px">').addClass("badge").text(o.data("count")+"x")),r.slideUp("normal",function(){return $(this).remove()}),g(o)):(o.data("count",1),g(o)))},A=function(e){var t;return t=$("<pre>"),t.append(e),$("#history").prepend(t.hide().slideDown())},T=function(){return g($('<iframe width="420" height="315" src="http://www.youtube.com/embed/6bMLrA_0O5I?rel=0" frameborder="0" allowfullscreen></iframe>'))},D=function(){var e,t;return t=$("<span>").html('<b>Like Protobowl?</b> Consider liking us on <a href="https://www.facebook.com/protobowl">Facebook</a>. '),e=$('<iframe src="https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2Fprotobowl&amp;send=false&amp;layout=button_count&amp;width=450&amp;show_faces=false&amp;font&amp;colorscheme=light&amp;action=like&amp;height=21&amp;appId=111694105666039" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:150px; height:21px;" allowTransparency="true"></iframe>'),$("body").append(e.css("vertical-align","bottom").hide()),setTimeout(function(){return g($("<p>").append(t).append(e.show()))},1e3)},k=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,p,m;return o=e.id,u=e.tribunal,l=u.votes,s=u.time,h=u.witnesses,t=u.against,i=u.initiator,d=Wt.id,f.call(h,d)<0&&"_"!==Wt.id[0]?void 0:(c=Math.floor((h.length-1)/2+1)-l.length+t.length,r=$("<div>").addClass("alert").addClass("troll-"+o),i&&"_"===i[0]&&(i=""),o===Wt.id?(i?(r.append(S(i)),r.append(" has complained about your behavior and created a ban tribunal. ")):r.text("Protobowl has detected abnormally high activity from your computer.\n"),r.append(" <strong> Currently "+l.length+" of "+(h.length-1)+" users have voted</strong> ("+c+" more votes are needed to ban you from this room).")):(r.append($("<strong>").append("Is ").append(S(o)).append(" trolling? ")),i?(r.append(S(i)),r.append(" has created a ban tribunal for "),r.append(S(o)),r.append(". ")):(r.append("Protobowl has detected abnormally high rates of activity from "),r.append(S(o)),r.append(". ")),r.append("<br>"),n=$("<button>").addClass("btn btn-small").text("Ban this user"),r.append(n),r.append(" "),a=$("<button>").addClass("btn btn-small").text("Don't ban"),r.append(a),r.append(" <strong> Currently "+l.length+" of "+(h.length-1)+" users have voted</strong> ("+c+" more votes needed)"),n.click(function(){return Wt.vote_tribunal({user:o,position:"ban"})}),a.click(function(){return Wt.vote_tribunal({user:o,position:"free"})}),n.add(a).disable((p=Wt.id,f.call(l,p)>=0||(m=Wt.id,f.call(t,m)>=0)))),$(".troll-"+o).length>0&&$(".troll-"+o).parents(".active").length>0?$(".troll-"+o).replaceWith(r):($(".troll-"+o).slideUp("normal",function(){return $(this).remove()}),w(r)))},E=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,p,m,y,v,b,w,k;if(i=e.id,n=e.elect,s=$("<div>").addClass("alert alert-info").addClass("elect-"+i),n.term){if(p=n.witnesses,r=n.impeach,y=Wt.id,f.call(p,y)<0&&"_"!==Wt.id[0])return;if(d=Math.floor((p.length-1)/2+1)-r.length,Xt.serverTime()>n.term)return $(".elect-"+i).slideUp("normal",function(){return $(this).remove()}),void 0;i===Wt.id?(c=function(){var e;return e=Math.round(Math.max(0,Wt.elect.term-Xt.serverTime())/1e3),$(".term-timeout").text(e),e>0?setTimeout(c,1e3):void 0},s.html("You have access to the settings for <b>the next <span class='term-timeout'>60</span> seconds</b>. \n"),c(),o=$("<button>").addClass("btn btn-small").text("Done"),o.click(function(){return Wt.finish_term()}),s.append(o)):(a=$("<button>").addClass("btn btn-small").text("Impeach"),a.click(function(){return Wt.vote_election({user:i,position:"impeach"})}),s.append(a.disable((v=Wt.id,f.call(r,v)>=0))),s.append(" <strong> "+r.length+" of "+(p.length-1)+" users have voted to impeach </strong>"),s.append(S(i).css("font-weight","bold")),s.append(" ("+d+" more votes needed)"))}else{if(h=n.votes,l=n.time,p=n.witnesses,t=n.against,b=Wt.id,f.call(p,b)<0&&"_"!==Wt.id[0])return;d=Math.floor(p.length/2+1)-h.length+t.length,i===Wt.id?s.append(" <strong>"+h.length+" of "+p.length+" users have voted</strong> ("+d+" more votes are needed)"):(s.append($("<strong>").append("Is ").append(S(i)).append(" trustworthy? ")),s.append("Grant control over the room settings if you believe the motives of "),s.append(S(i)),s.append(" are pure. Elected terms are 1 minute. <br>"),m=$("<button>").addClass("btn btn-small").text("Grant access"),s.append(m),s.append(" "),u=$("<button>").addClass("btn btn-small").text("Deny"),s.append(u),s.append(" <strong> "+h.length+" of "+p.length+" users have voted</strong> ("+d+" more votes needed)"),m.click(function(){return Wt.vote_election({user:i,position:"elect"})}),u.click(function(){return Wt.vote_election({user:i,position:"deny"})}),m.add(u).disable((w=Wt.id,f.call(h,w)>=0||(k=Wt.id,f.call(t,k)>=0))))}return $(".elect-"+i).length>0?$(".elect-"+i).replaceWith(s):g(s)};var F,j,N,M,q,L,U,R,H,B,P,Y,W,G,K,Q,J,V,X,Z,et,tt,ot,it,nt,at,rt,f=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},r=[].slice;et=function(){var e,t,n,o,i,r,a,s,u,l,c,h;if($(".custom-category").empty(),Xt.distribution){i=0,l=Xt.distribution;for(e in l)r=l[e],i+=r;for(c=Xt.categories,h=[],s=0,u=c.length;u>s;s++)e=c[s],t=$("<div>").addClass("category-item").appendTo(".custom-category").data("value",e),$("<span>").addClass("name").text(e).appendTo(t),o=$("<div>").addClass("btn-group pull-right dist-picker").appendTo(t),$("<button>").addClass("btn btn-small decrease disabled").append($("<i>").addClass("icon-minus")).appendTo(o),$("<button>").addClass("btn btn-small increase disabled").append($("<i>").addClass("icon-plus")).appendTo(o),$("<span>").addClass("percentage pull-right").css("color","gray").appendTo(t),a=$(t).data("value"),n=Xt.distribution[a]/i,$(t).find(".percentage").html(""+Math.round(100*n)+"% &nbsp;"),$(t).find(".increase").removeClass("disabled"),n>0&&i>1?$(t).find(".decrease").removeClass("disabled"):($(t).find(".decrease").addClass("disabled"),$(t).find(".name").css("font-weight","normal")),n>0?h.push($(t).find(".name").css("font-weight","bold")):h.push(void 0);return h}},$(".dist-picker .increase").live("click",function(){var e,t;if(Xt.distribution)return e=$(this).parents(".category-item"),t=clone_shallow(Xt.distribution),t[$(e).data("value")]++,Wt.set_distribution(t)}),$(".dist-picker .decrease").live("click",function(){var e,t,n,o,i,r;if(Xt.distribution){t=$(this).parents(".category-item"),o=0,r=Xt.distribution;for(e in r)i=r[e],o+=i;return n=clone_shallow(Xt.distribution),n[$(t).data("value")]>0&&o>1?(n[$(t).data("value")]--,Wt.set_distribution(n)):void 0}}),Q=function(){var e,t,n,o,i,r,a,s;for($(".difficulties option").remove(),$(".difficulties")[0].options.add(new Option("Any","")),a=Xt.difficulties,n=0,i=a.length;i>n;n++)t=a[n],$(".difficulties")[0].options.add(new Option(t,t));for($(".categories option").remove(),$(".categories")[0].options.add(new Option("Everything","")),$(".categories")[0].options.add(new Option("Custom","custom")),s=Xt.categories,o=0,r=s.length;r>o;o++)e=s[o],$(".categories")[0].options.add(new Option(e,e));return et(),Xt.topic?($(".topic .thumbnail").html(Xt.topic),$(".topic").slideDown()):$(".topic").slideUp()},X=function(){var e,t,n;if("custom"===Xt.category?(et(),$(".custom-category").slideDown()):$(".custom-category").slideUp(),$(".categories").val(Xt.category),$(".difficulties").val(Xt.difficulty),$(".multibuzz").prop("checked",!Xt.max_buzz),$(".allowskip").prop("checked",!Xt.no_skip),$(".allowpause").prop("checked",!Xt.no_pause),$(".adhd").prop("checked",!!Wt.prefs.distraction),$("body").toggleClass("distraction",!!Wt.prefs.distraction),$(".settings").is(":hidden")&&($(".settings").slideDown(),$(window).resize()),$(".bundle.active").toggleClass("semi",Xt.semi),Wt.id in Xt.users&&"prefs"in Xt.users[Wt.id]&&(!$(".timer-widget").data("hidden")!=!Wt.prefs.timer_hide&&(Wt.prefs.timer_hide?($(".timer-widget").data("hidden",!0),$(".timer, .progress").slideUp().queue(function(){return $(this).css("opacity","").dequeue(),$(".expand-timer").fadeIn()})):($(".timer-widget").data("hidden",!1),$(".expand-timer").fadeOut(),$(".timer, .progress").slideDown().animate({opacity:.7}).queue(function(){return $(this).css("opacity","").dequeue()}))),$(".livechat").prop("checked",!!Wt.prefs.typing),$(".sounds").prop("checked",!!Wt.prefs.sounds),$(".lock").prop("checked",!!Wt.lock),$(".teams").val(Wt.team),$(".microwave").toggle(!Wt.muwave),Wt.metrics().guesses>0?$(".reset-score").slideDown():$(".reset-score").slideUp(),Wt.authorized("moderator")&&!Wt.authorized("admin")?$(".relinquish-command").slideDown():$(".relinquish-command").slideUp(),e=function(){var e;e=[];for(t in Xt.users)e.push(1);return e}().length,e>1?$(".set-team").slideDown():$(".set-team").slideUp()),Wt.id&&"_"===Wt.id[0]&&($("a.brand").prop("href","/stalkermode"),$("div.navbar-inner").css("background","rgb(224, 235, 225)"),$(".motto").text("omg did you know im a ninja?")),Xt.attempt&&x(Xt.attempt),n=Math.round(12e3/Xt.rate),(!$(".speed").data("last_update")||new Date-$(".speed").data("last_update")>1337)&&Math.abs($(".speed").val()-n)>1&&$(".speed").val(n),Xt.attempt&&Xt.attempt.user===Wt.id){if(Xt.attempt.prompt){if("prompt"!==st)return $t("prompt"),$(".prompt_input").val(Xt.attempt.text).focus()}else if("guess"!==st)return $t("guess")}else if("guess"===st||"prompt"===st)return $t("")},P=0,J=function(){var e,t,n;if(!((!Xt.time_freeze||Xt.attempt)&&Xt.time()<Xt.end_time&&(requestAnimationFrame(J),new Date-P<50)))return P=+new Date,Xt.question?(0!==$(".start-page").length&&$(".start-page").slideUp("normal",function(){return $(this).remove()}),e=$("#history .bundle:first").data("info"),((null!=e?e.generated_time:void 0)!==("undefined"!=typeof Xt&&null!==Xt?Xt.generated_time:void 0)||("undefined"!=typeof Xt&&null!==Xt?Xt.question:void 0)!==(null!=e?e.question:void 0))&&(j(),Lt(Xt.qid,function(e){return ui(e)}))):0===$(".start-page").length&&(t=$("<div>").addClass("start-page").hide().prependTo("#history"),n=$("<div>").addClass("well").appendTo(t),$("<button>").addClass("btn btn-success btn-large").text("Start the Question").appendTo(n).click(function(){return Wt.next()}),t.slideDown()),nt(),V()},V=function(){var e,t,n,o,i,r,a,s,u,l,c,h,d;return Xt.end_time&&Xt.begin_time?$(".timer").removeClass("disabled"):$(".timer").addClass("disabled"),h=Math.max(Xt.begin_time,Xt.time()),Nt()||("undefined"!=typeof eo&&null!==eo?eo.hide_disconnect:void 0)?$(".offline-badge").capQueue().fadeOut():$(".offline-badge").capQueue().fadeIn(),$(".chatbtn").disable(!Wt.authorized(Xt.mute)),Xt.time_freeze?($(".buzzbtn").disable(!0),Xt.attempt?($(".label.pause").hide(),$(".label.buzz").capQueue().fadeIn()):($(".label.pause").capQueue().fadeIn(),$(".label.buzz").hide(),$(".pausebtn").hasClass("btn-warning")&&($(".pausebtn .resume").show(),$(".pausebtn .pause").hide(),$(".pausebtn").addClass("btn-success").removeClass("btn-warning")))):($(".label.pause").capQueue().fadeOut(),$(".label.buzz").capQueue().fadeOut(),$(".pausebtn").hasClass("btn-success")&&($(".pausebtn .resume").hide(),$(".pausebtn .pause").show(),$(".pausebtn").addClass("btn-warning").removeClass("btn-success"))),h>=Xt.end_time&&!Xt.time_freeze?$(".label.finished").capQueue().fadeIn():$(".label.finished").capQueue().fadeOut(),h>=Xt.end_time?$(".nextbtn").is(":hidden")&&($(".nextbtn").show(),$(".skipbtn").hide()):$(".nextbtn").is(":hidden")||($(".nextbtn").hide(),$(".skipbtn").show()),$(".timer").toggleClass("buzz",!!Xt.attempt),$(".primary-bar").toggleClass("bar-warning",!(!Xt.time_freeze||Xt.attempt)),$(".primary-bar").toggleClass("bar-danger",!!Xt.attempt),$(".progress").toggleClass("active",!!Xt.attempt),Xt.attempt?(n=Xt.serverTime()-Xt.attempt.realTime,r=Xt.attempt.duration-n,s=n/Xt.attempt.duration,$(".pausebtn, .buzzbtn, .skipbtn, .nextbtn").disable(!0)):(r=Xt.end_time-h,n=h-Xt.begin_time,s=n/(Xt.end_time-Xt.begin_time),$(".skipbtn, .nextbtn").disable(!1),$(".pausebtn").disable(0>r||Xt.no_pause),Xt.time_freeze||(!(null!=(d=Xt.scoring)?d.interrupt:void 0)&&h<Xt.end_time-Xt.answer_duration?$(".buzzbtn").disable(!0):$(".buzzbtn").disable(0>r||100>n)),0>r&&($(".bundle.active").addClass("revealed"),at(),u=$(".bundle.active").find(".ruling"),u.data("shown_tooltip")||(u.data("shown_tooltip",!0),t=$(".bundle.active").find(".ruling").first().tooltip({trigger:"manual"}),t.tooltip("show")))),Xt.no_skip&&$(".skipbtn").disable(!0),$(".timer-widget").data("hidden")?void 0:(Xt.attempt||Xt.time_freeze?($(".progress .primary-bar").width(100*s+"%"),$(".progress .aux-bar").width("0%")):(o=100*(1-Xt.answer_duration/(Xt.end_time-Xt.begin_time)),$(".progress .primary-bar").width(Math.min(100*s,o)+"%"),$(".progress .aux-bar").width(Math.min(100-o,Math.max(0,100*s-o))+"%")),r=Math.max(0,r),c="",0>r&&(c="+"),l=Math.abs(r)/1e3,isNaN(l)?($(".timer .face").text("00:00"),$(".timer .fraction").text(".0")):(e=(l%1).toFixed(1).slice(1),$(".timer .fraction").text(e),i=l/60,a=function(e){var t;for(t=Math.floor(e).toString();t.length<2;)t="0"+t;return t},$(".timer .face").text(c+a(i)+":"+a(l%60))))},B=function(e){var t,n;return e?(n=0,n=e.members?zt(function(){var n,o,i,r;for(i=e.members,r=[],n=0,o=i.length;o>n;n++)t=i[n],r.push(B(t));return r}()):Wt.prefs.movingwindow?e.score()-[0].concat(e.history).slice(-Wt.prefs.movingwindow)[0]:e.score(),1335===n?1337:n):0},tt=function(){var e,t,n,o,i,r;n=0,t=0,r=Xt.users;for(e in r)i=r[e],i.active()&&i.active()&&(t++,i.lock&&n++);return o=Math.floor(t/2+1),2>=t||Xt.escalate>=Xt.acl.moderator?$(".lockvote").slideUp():($(".lockvote").slideDown(),o>n?$(".lockvote .electorate").text(""+(o-n)+" needed"):$(".lockvote .electorate").text(""+n+"/"+t+" votes")),$(".lockvote .status_icon").removeClass("icon-lock icon-unlock icon-flag"),$(".request-access button").disable(!!Wt.elect),$(".globalsettings").toggleClass("escalate",!(Xt.escalate>Xt.acl.unlocked)),Wt.authorized()?(Xt.locked()?$(".lockvote .status_icon").addClass("icon-flag"):$(".lockvote .status_icon").addClass("icon-unlock"),$(".globalsettings").removeClass("locked"),$(".globalsettings .checkbox, .globalsettings .expando").find("select, input").disable(!1)):($(".lockvote .status_icon").addClass("icon-lock"),$(".globalsettings").addClass("locked"),$(".globalsettings .checkbox, .globalsettings .expando").find("select, input").disable(!0))},Z=function(){var e,t,n,o,i,r,a,s,u,l,c,h,d,p,m,g,y,v,b,w,_,C,x,T,D,A,z,O,j,I,M,F,W,L,R,P,U,H,X,Y,K,G,Q,J,V,Z,et;if(Xt.users){O={},z="",b={},Y=Xt.users;for(c in Y)I=Y[c],b[I.name]||(b[I.name]=[]),b[I.name].push(c);for(v in b)if(h=b[v],h.length>1)for(x=h.sort(function(e,t){return Xt.users[e].last_session-Xt.users[t].last_session}),w=W=0,K=x.length;K>=0?K>W:W>K;w=K>=0?++W:--W)Xt.users[x[w]]._suffix="#"+(w+1);else delete Xt.users[h[0]]._suffix;G=Xt.users;for(c in G)I=G[c],I.team&&("t-"+I.team in O||(O["t-"+I.team]=[]),O["t-"+I.team].push(I.id),z+=I.team+I.id),S(I.id,!0),I.tribunal?k(I):($(".troll-"+I.id).slideUp("normal",function(){return $(this).remove()}),I.elect?E(I):$(".elect-"+I.id).slideUp("normal",function(){return $(this).remove()}));if(tt(),$(".teams").data("teamhash")!==z){$(".teams").data("teamhash",z),$(".teams").empty(),$(".teams")[0].options.add(new Option("Individual",""));for(D in O)g=O[D],D=D.slice(2),$(".teams")[0].options.add(new Option(""+D+" ("+g.length+")",D));$(".teams")[0].options.add(new Option("Create Team","__create")),Wt.id in Xt.users&&$(".teams").val(Xt.users[Wt.id].team)}if(d=$(".leaderboard tbody"),u=function(e){var t;return t=e.created||e.members[0].created,B(e)+(Xt.serverTime()-t)/1e15},s=function(){var e,t;e=Xt.users,t=[];for(c in e)I=e[c],t.push(I);return t}(),M=s.length,A=0,$(".teams").val()||"__"===Wt.id.slice(0,2)){s=function(){var e;e=[];for(D in O)g=O[D],D=D.slice(2),n={room:Xt},A++,n.members=function(){var e,t,n;for(n=[],e=0,t=g.length;t>e;e++)m=g[e],n.push(Xt.users[m]);return n}(),n.metrics=function(){var e,t,o,i,r,a,s,u,l,c;for(e={},l=n.members,r=0,s=l.length;s>r;r++)for(o=l[r],c=o.metrics(),i=a=0,u=c.length;u>a;i=++a)t=c[i],e[t]||(e[t]=0),e[t]+=i;return e},n.name=D,n.id="team-"+escape(D).toLowerCase().replace(/[^a-z0-9]/g,""),e.push(n);return e}(),Q=Xt.users;for(c in Q)I=Q[c],I.team||s.push(I)}for(s=s.sort(function(e,t){return u(t)-u(e)}),_=1,p=null,F=L=0,U=s.length;U>L;F=++L)I=s[F],s[F-1]&&B(I)<B(s[F-1])&&_++,I.rank=_,I.position=F,!p&&(J=Xt.users[Wt.id],f.call(I.members||[I],J)>=0)&&(p=I);for(d.find(".refreshed").removeClass("refreshed"),r=function(e,t){var n,o,i,a,s,l,c,h,p,g,y,b,w;if(null==t&&(t=!1),e){if(i=$(".row-"+e.id),s=i.length>0?i.first().empty():$("<tr>").addClass("row-"+e.id),s.addClass("refreshed").data("entity",e).appendTo(d).click(function(){return 1}),o=$("<span>").addClass("badge pull-right").text(B(e)),g=Xt.users[Wt.id],f.call(e.members||[e],g)>=0)o.addClass("badge-info").prop("title","You");else{for(a=0,n=0,y=e.members||[e],l=0,h=y.length;h>l;l++)m=y[l],m.online()&&(m.active()?n++:a++);n>0?o.addClass("badge-success").prop("title","Online"):a>0&&o.addClass("badge-warning").prop("title","Idle")}if(t?(s.addClass("subordinate"),$("<td>").addClass("rank").appendTo(s)):$("<td>").addClass("rank").append(e.rank).appendTo(s),$("<td>").addClass("score").append(o).appendTo(s),v=$("<td>").appendTo(s),$("<td>").addClass("negs").text(e.metrics().interrupts).appendTo(s),e.members){for(v.append($("<span>").text(e.name).css("font-weight","bold")).append(" ("+e.members.length+")"),b=e.members.sort(function(e,t){return u(t)-u(e)}),w=[],c=0,p=b.length;p>c;c++)e=b[c],w.push(r(e,!0));return w}return v.append($("<span>").append(S(e.id)))}},t=3,e=2,a=null,C=0,j=t+2*e,l=R=0;t>=0?t>R:R>t;l=t>=0?++R:--R)l<s.length&&(r(s[l]),C++);if(s.length>t&&(a=$("<tr>").addClass("ellipsis refreshed").appendTo(d)),p&&p.position>=t+2*e&&!Wt.prefs.leaderboard)for(o=Math.min(s.length,p.position+e)-(p.position-e),l=P=V=p.position-e,Z=p.position+e;Z>=V?Z>P:P>Z;l=Z>=V?++P:--P)l>=0&&l<s.length&&(r(s[l]),C++);else{for(l=H=t;j>=t?j>H:H>j;l=j>=t?++H:--H)l>=0&&l<s.length&&(r(s[l]),C++);if(Wt.prefs.leaderboard)for(l=X=j,et=s.length;et>=j?et>X:X>et;l=et>=j?++X:--X)r(s[l])}return d.find("tr:not(.refreshed)").remove(),a&&(T="(<b>"+(s.length-C)+"</b> hidden)",Wt.prefs.leaderboard&&(T="(hide <b>"+(s.length-C)+"</b>)"),y=$("<span>").css("position","relative").html(" <span class='badge badge-success'>"+Xt.active_count()+"</span> active <span class='badge'>"+M+"</span> users"),i=$("<td colspan=4>").appendTo(a).append($("<span>").html(T)).append(" ").append(y)),M>1&&(Nt()||("undefined"!=typeof eo&&null!==eo?eo.hide_disconnect:void 0))?$(".leaderboard").is(":hidden")&&($(".leaderboard").slideDown(),$(".singleuser").slideUp()):Xt.users[Wt.id]&&($(".singleuser .stats").empty().append(q(Xt.users[Wt.id],!!$(".singleuser").data("full"))),$(".singleuser").is(":hidden")&&($(".leaderboard").slideUp(),$(".singleuser").slideDown())),N()
}},Y=0,N=function(){var e,t,n,o;if(Nt()&&!Wt.muwave){e=0,o=Xt.users;for(t in o)n=o[t],n.online()&&Xt.serverTime()-n.last_action<6e5&&e++;if(1===e){if(Date.now()-Y<6e4)return;return Y=Date.now(),Wt.check_public("",function(e){var t,n,o,i;i=[];for(t in e)n=e[t],n>0&&t!==Xt.name&&i.push(t);return i.length>0?(o=function(){var n,o,r;for(r=[],n=0,o=i.length;o>n;n++)t=i[n],r.push(t.link("/"+t)+(" ("+e[t]+") "));return r}(),$(".foreveralone .roomlist").html(o.join(" or ")),$(".foreveralone").slideDown()):$(".foreveralone").slideUp()})}return $(".foreveralone").slideUp()}},q=function(e,t){return e.members?L(e,t):U(e,t)},U=function(t,n){var o,i,a,s,u,l,c;return l=$("<div>").addClass("pseudotable"),u=function(e,t){return $("<div>").addClass("pseudorow").appendTo(l).append($("<span>").addClass("left").text(e)).append($("<span>").addClass("right").append(t))},o=function(){var e;return e=1<=arguments.length?r.call(arguments,0):[],u.apply(null,e).addClass("full").toggle(n)},s=function(e,t){return" <span class='mini-stat' title='"+e+"'> / "+t+"</span>"},a=t.metrics(),u("Score",$("<span>").addClass("badge").text(B(t))),u("Correct",a.correct+s("Current Streak",t.streak)+s("Streak Record",t.streak_record)),("undefined"!=typeof Xt&&null!==Xt?null!=(c=Xt.scoring)?c.interrupt:void 0:void 0)?(u("Interrupts",a.interrupts+s("Current Streak",t.negstreak)+s("Streak Record",t.negstreak_record)),o("Early",a.early+s("Powermarked Seen",t.earlyseen))):u("Incorrect",a.wrong+s("Current Streak",t.negstreak)+s("Streak Record",t.negstreak_record)),u("Seen",t.seen+s("Guesses",a.guesses)),t.team&&u("Team",t.team),t.admin_name&&u("Auth",t.admin_name),o("ID",t.id.slice(0,10)),o("Last Seen","<span style='font-size:x-small'>"+e(t.last_action)+"</span>"),n&&t.id!==Wt.id&&Wt.authorized("moderator")&&(i=$("<span>"),i.append(b(t.id,!0)),u("Admin",i)),l},L=function(e,t){var n,o,i;return o=$("<div>").addClass("pseudotable"),n=function(e,t){return $("<div>").addClass("pseudorow").appendTo(o).append($("<span>").addClass("left").text(e)).append($("<span>").addClass("right").append(t))},n("Score",$("<span>").addClass("badge").text(B(e))),n("Correct",zt(function(){var t,n,o,r;for(o=e.members,r=[],t=0,n=o.length;n>t;t++)i=o[t],r.push(i.metrics().correct);return r}())),Xt.interrupts&&(n("Interrupts",zt(function(){var t,n,o,r;for(o=e.members,r=[],t=0,n=o.length;n>t;t++)i=o[t],r.push(i.metrics().interrupts);return r}())),t&&n("Early",zt(function(){var t,n,o,r;for(o=e.members,r=[],t=0,n=o.length;n>t;t++)i=o[t],r.push(i.metrics().early);return r}()))),n("Guesses",zt(function(){var t,n,o,r;for(o=e.members,r=[],t=0,n=o.length;n>t;t++)i=o[t],r.push(i.metrics().guesses);return r}())),n("Members",e.members.length),o},M=function(){return R(jQuery.extend(jQuery.extend(!0,{},Xt.info),{qid:Xt.qid,question:Xt.question,generated_time:Xt.generated_time,answer:Xt.answer}))},j=function(){var e,t,n,o,i,r,a;if(Xt.question&&Xt.generated_time){if(t=15,ft()&&(t=1),$(".bundle .ruling").tooltip("destroy"),$("#history .bundle").slice(t).find(".annotations").slideUp("normal",function(){return $(this).remove()}),$("#history .bundle").slice(t).slideUp("normal",function(){return $(this).is(".bookmarked")?($("#bookmarks").prepend($(this).slideDown()),$("#bookmarks .bundle").length?$("#whale").slideDown():void 0):$(this).remove()}),i=$("#history .bundle").first(),$(".bundle").removeClass("active"),i.find(".breadcrumb").click(function(){return 1}),e=M().width($("#history").width()),e.addClass("active"),$("#history").prepend(e.hide()),it(),$(".chat.typing").each(function(){var t,n;return t=$(this),Xt.serverTime()-t.data("last_update")>2e4?(t.removeClass("typing"),void 0):(n=t.clone().insertBefore(t),t.appendTo(e.find(".annotations")),n.slideUp("normal",function(){return $(this).remove()}))}),e.slideDown("normal").queue(function(){return e.width("auto"),$(this).dequeue()}),i.find(".readout").length>0){for(o=i.find(".readout .well>span"),r=0,a=o.length;a>r;r++)n=o[r],$(n).data("text")&&(n.childNodes[0].nodeValue=$(n).data("text"));i.find(".readout .well").append(o.contents()),o.remove(),i.find(".readout")[0].normalize(),i.queue(function(){return i.find(".readout").slideUp("normal"),$(this).dequeue()})}return at()}},H=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,f,p,m,g,y,v,b,w,k,_,x,E,T,D,A,S,z,O,j,I,q,N,M,F,W,L,R,P,U,B;for(l=$("<div>").addClass("alert alert-block alert-info report-form"),l.append($("<button>",{"data-dismiss":"alert",type:"button"}).html("&times;").addClass("close")),c=$("<form>"),c.addClass("form-horizontal").appendTo(l),b=$("<div>").addClass("control-group").appendTo(c),b.append($("<label>").addClass("control-label").text("Description")),a=$("<div>").addClass("controls").appendTo(b),L=["Wrong category","Incorrectly bolded","Change tags","Broken question"],S=0,I=L.length;I>S;S++)m=L[S],a.append($("<label>").addClass("radio").append($("<input type=radio name=description>").val(m.split(" ")[1].toLowerCase())).append(m));for(x=$("<button>",{type:"submit"}).addClass("btn btn-primary").text("Submit"),c.find(":radio").change(function(){return"category"===c.find(":radio:checked").val()?(s.slideDown(),$(i).trigger("change")):s.slideUp(),"bolded"===c.find(":radio:checked").val()?(t.slideDown(),x.disable(h())):t.slideUp(),"question"===c.find(":radio:checked").val()?(r.slideDown(),x.disable(!1)):r.slideUp(),"tags"===c.find(":radio:checked").val()?(D.slideDown(),x.disable(!1)):D.slideUp()}),D=$("<div>").addClass("control-group").appendTo(c).hide(),D.append($("<label>").addClass("control-label").text("Tags")),T=$("<select>"),D.append($("<div>").addClass("controls").append(T)),E={Science:["Biology","Chemistry","Physics","Math","Geology","Astronomy"],History:["American","Ancient","European","World"],"Fine Arts":["Art","Music","Other"],Literature:["American","European","Language Arts","World"],"Social Science":["Anthropology","Economics","Geography","Psychology"],Trash:["Film","Sports","Games","TV","Music"]},T.append(new Option("None","")),R=E[e.category]||[],z=0,q=R.length;q>z;z++)o=R[z],T.append(new Option(o));for(s=$("<div>").addClass("control-group").appendTo(c),s.append($("<label>").addClass("control-label").text("Category")),r=$("<div>").addClass("control-group").appendTo(c).hide(),r.append($("<label>").addClass("control-label").text("Comment")),y=$("<input type=text>").attr("placeholder","What needs to be fixed"),r.append($("<div>").addClass("controls").append(y)),t=$("<div>").addClass("control-group").appendTo(c).hide(),t.append($("<label>").addClass("control-label").text("Answer")),p=$("<ul>").addClass("nav nav-pills emboldinator"),t.append($("<div>").addClass("controls").append(p)),k=e.answer.replace(/([\{\}\[\]\(\)\-])/g,"`$1`").replace(/\ +/g," ` ").replace(/\ +/g," ").split("`"),u=!1,g=[],O=0,N=k.length;N>O;O++)w=k[O],"{"===w?u=!0:"}"===w?u=!1:w&&g.push([u,w]);for(h=function(){var t;return t=v(),console.log(t),t===e.answer?!0:-1===t.indexOf("{")?!0:!1},v=function(){return p.find("li a").map(function(){var e,t,n;return $(this).hasClass("bold")?(n=$(this).text(),t=n.match(/^\s*/)[0],e=n.match(/\s*$/)[0],""+t+"{"+n.trim()+"}"+e):$(this).text()}).toArray().join("~").replace(/~/g,"").replace(/\s+/g," ").replace(/\}\s*\{/g," ").replace(/\s([\]\)])/g,"$1").replace(/([\[\(])\s/g,"$1")},j=0,M=g.length;M>j;j++)P=g[j],f=P[0],A=P[1],d=$("<a>").toggleClass("bold",f).appendTo($("<li>").appendTo(p)).text(A).attr("href","#"),"["===(U=A.trim())||"]"===U||";"===U||","===U||"("===U||")"===U||'"'===U||""===U||"”"===U||"“"===U||"-"===U?(" "===A&&d.hide(),d.removeClass("bold").addClass("unboldable").click(function(){return!1})):d.click(function(){var e;return $(this).toggleClass("bold"),e=v(),x.disable(h()),!1});for(i=$("<select>"),s.append($("<div>").addClass("controls").append(i)),B=Xt.categories,W=0,F=B.length;F>W;W++)o=B[W],i.append(new Option(o));return $(i).change(function(){return x.disable(i.val()===e.category)}),i.val(e.category),$(i).change(),_=$("<div>").addClass("control-group").appendTo(c),n=$("<button>").addClass("btn").text("Cancel").click(function(e){return l.slideUp("normal",function(){return $(this).remove()}),e.stopPropagation(),e.preventDefault()}),$("<div>").addClass("controls").appendTo(_).append(x).append(" ").append(n),$(c).submit(function(){var t;return t=c.find(":radio:checked").val(),"bolded"===t?Wt.change_bold({id:e.qid,answer:v()}):"tags"===t?""===$(T).val()?Wt.tag_question({id:e.qid,tags:[]}):Wt.tag_question({id:e.qid,tags:[$(T).val()]}):("category"===t&&(e.fixed_category=i.val()),e.describe=t,e.comment=y.val(),Wt.report_question(e)),C("Reported Question","Protobowl has a new answer checking algorithm (finally!), it takes into account which words are bolded in the answer line to determine what to accept, prompt or reject. Please hit Edit and revise the bolding.").addClass("alert-success").insertAfter(l.parent().find(".annotations")),l.slideUp("normal",function(){return $(this).remove()}),!1}),a.find("input:radio")[0].checked=!0,l},R=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,f;if(o=$("<div>").addClass("bundle").addClass("qid-"+e.qid),o.toggleClass("semi",Xt.semi),o.data("info",e),n=$("<ul>"),u=$("<a>",{href:"#",rel:"tooltip",title:"Bookmark this question"}).addClass("bookmark").click(function(t){return t.stopPropagation(),t.preventDefault(),t.shiftKey?Lt(e.qid,function(t){return Zt(e.qid,t.bookmarked+1)}):o.hasClass("bookmarked")?Zt(e.qid,0):Zt(e.qid,1)}),"function"==typeof Ft&&Ft(e.qid),u.addClass("icon-star-empty"),n.append($("<li>").addClass("pull-right").append(u)),i=function(e){var t;return n.find("li:not(.pull-right)").last().append($("<span>").addClass("divider").text("/")),t=$("<li>").text(e).appendTo(n)},e.tournament&&e.date?i(e.date):e.tournament&&e.year?i(e.year+" "+e.tournament):e.year?i(e.year):e.tournament&&i(e.tournament),i(e.difficulty),i(e.category),e.group&&i(e.group).css("font-weight","bold"),e.tags)for(f=e.tags,h=0,d=f.length;d>h;h++)l=f[h],i(l);return n.find("li").last().append($("<span>").addClass("divider hidden-phone hidden-offline edit-button").text("/")),n.append($("<li>").addClass("clickable hidden-phone hidden-offline edit-button").text("Edit").click(function(t){return o.find(".report-form").length>0||H(e).insertBefore(o.find(".annotations")).hide().slideDown(),t.stopPropagation(),t.preventDefault()})),t=$("<li>").addClass("pull-right answer"),r=$("<li>").addClass("pull-right answer"),a=ot(e.answer),-1===(e.answer+"").indexOf("{")?(t.text(e.answer).css("font-weight","bold"),r.text(a).css("font-weight","bold")):(t.html(e.answer.replace(/\{/g,'<span class="bold">').replace(/\}/g,"</span>")),r.html(a.replace(/\{/g,'<span class="bold">').replace(/\}/g,"</span>"))),r.data("actual_answer",t),n.append(r),s=$("<div>").addClass("readout"),c=$("<div>").addClass("well").appendTo(s),c.append($("<span>").addClass("unread").text(e.question)),o.append($("<ul>").addClass("breadcrumb").append(n)).append(s).append($("<div>").addClass("sticky")).append($("<div>").addClass("annotations"))},at=function(){return $(".bundle").not(".active").add(".bundle.revealed").find(".answer").not(".done").replaceWith(function(){return $(this).data("actual_answer").addClass("done")})},G=null,K=-1,nt=function(){var e,t,n,o,i,r,a;if(Xt.question&&Xt.timing&&G){for(o=Xt.time()-Xt.begin_time,t=Math.max(0,K),e=t;o>Xt.cumulative[e];)e++;if(t>e)for(i=r=e;t>=e?t>r:r>t;i=t>=e?++r:--r)G[i].className="unread";for(i=a=t;e>=t?e>a:a>e;i=e>=t?++a:--a)G[i].className="",n=$(G[i]).data("text"),n&&(G[i].childNodes[0].nodeValue=n);return K=e-1}},rt={},W={},F=function(){var e,t,n,o,i,r,a;for(n=$("<div>").addClass("well"),t=$("<div>").css("overflow","hidden").css("width",0).css("height",0).appendTo("body").append(n),i=$("<span>").appendTo(n),e=a=33;126>a;e=++a)o=String.fromCharCode(e),i.text(o),r=i.width(),rt[r]=o,W[o]=r;return t.remove()},ot=function(e){var t,n;return W.x>0||F(),n=function(){var n,o,i;for(i=[],n=0,o=e.length;o>n;n++)t=e[n],t in W?i.push(rt[W[t]]):i.push(t);return i}(),n.join("")},it=function(){var e,t,n,o,i,r,a,s,u,l,c,h,d,p,m,g,y;if(Xt.question&&Xt.timing&&(d=Xt.question.split(" "),n=Xt.question.replace(/[^ \*]/g,"").indexOf("*"),e=$("#history .bundle.active"),l=e.data("starts")||[],c=e.data("stops")||[],u=e.find(".readout .well"),0!==u.length)){for(u.data("spots",l.join(",")),t=u.children(),i=[],r=e.data("finish_point"),a=p=0,g=d.length;g>=0?g>p:p>g;a=g>=0?++p:--p)o=$("<span>").addClass("unread"),-1!==d[a].indexOf("*")?o.append(" <span class='inline-icon'><span class='asterisk'>"+d[a]+"</span><i class='label icon-white icon-asterisk'></i></span> "):(h=d[a],o.data("text",h+" "),Xt.semi?o.append(h+" "):o.append(ot(h)+" ")),f.call(l,a)>=0?(s="label-important",a===d.length-1&&(s="label-info"),-1!==n&&n>a&&(s="label"),o.append(" <span class='inline-icon'><i class='label icon-white icon-bell  "+s+"'></i></span> ")):f.call(c,a)>=0?o.append(" <span class='inline-icon'><i class='label icon-white icon-pause label-warning'></i></span> "):r&&a===r&&o.append(" <span class='inline-icon'><i class='label icon-white icon-forward label-info'></i></span> "),i.push(o);for(a=m=0,y=d.length;y>=0?y>m:m>y;a=y>=0?++m:--m)t.eq(a).html()===i[a].html()?t.eq(a).addClass("unread"):t.eq(a).length>0?t.eq(a).replaceWith(i[a]):u.append(i[a]);return G=u[0].childNodes,K=-1,nt()}};var st,ut,lt,ht,ct,dt,ft,mt,pt,yt,gt,wt,bt,vt,kt,$t,_t,f=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};$("#username").keyup(function(e){var t,n;return 13===e.keyCode&&$(this).blur(),t=$(this).val(),t.length>0?(Wt.set_name(t),n="username"+(("undefined"!=typeof u&&null!==u?u.email:void 0)||""),localStorage[n]=t):void 0}),$(".generate-name").click(function(){return"undefined"!=typeof go&&null!==go?($("#username").val(go()),$("#username").keyup().focus()):void 0}),jQuery(".bundle .breadcrumb").live("click",function(){var e;return $(this).is(jQuery("#history .bundle .breadcrumb").first())?void 0:(e=$(this).parent().find(".readout"),e.width($("#history").width()).slideToggle("normal",function(){return e.width("auto")}))}),$(".new-room").mouseover(function(){return"undefined"!=typeof wo&&null!==wo?$(".new-room").attr("href",wo()):void 0}),st="",$t=function(e){return e!==st&&st&&$(".prompt_input, .guess_input, .chat_input").blur(),st=e,$(".actionbar").toggle(""===e),$(".chat_form").toggle("chat"===e),$(".guess_form").toggle("guess"===e),$(".prompt_form").toggle("prompt"===e),$(window).resize()},$(".chatbtn").click(function(){if(Wt.prefs.distraction){if($(".distraction-notice").length)return;return C("Distraction Free Mode is Enabled","Chat messages and other messages which are not necessarily important have been disabled. Disable this mode from the settings widget in order to send or receive chat messages.").addClass("alert-error distraction-notice").insertAfter(".buttonbar"),void 0}return $(".chat_input").val(""),pt()}),pt=function(e){if("@$> "===e)$(".chat_input").val(e);else if(!Wt.authorized(Xt.mute)||Wt.prefs.distraction)return;return"chat"!==st&&($t("chat"),$(".chat_input").data("input_session",Math.random().toString(36).slice(3)).data("begin_time",+new Date)),$(".chat_input").keyup().focus()},kt=[0],bt=0,vt=function(){var e,t,n,o,i,r,a;if("localhost"===location.hostname||"_"===Wt.id[0]||("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.development:void 0))return!1;if(!Nt())return!1;for(i=7,t=+new Date,n=[],o=!1,r=0,a=kt.length;a>r;r++)e=kt[r],5e3>t-e&&n.push(e);return n.length>=i&&(o=!0),bt>t&&(o=!0),kt=n.slice(-10),kt.push(t),o&&(bt=t+5e3,C("Rate Limited","You been rate limited for doing too many things in the past five seconds. ").addClass("alert-error").insertAfter(".bundle.active .annotations")),o},_t=function(){return vt()?void 0:Wt.skip()},mt=function(){return Xt.time()>=Xt.end_time&&!Xt.attempt?Wt.next():void 0},$(".skipbtn").click(_t),$(".nextbtn").click(mt),$(".buzzbtn").click(function(){var e;if(!$(".buzzbtn").prop("disabled")&&!vt())return $t("guess"),$(".guess_input").val("").addClass("disabled").focus(),e=+new Date,$(".sounds")[0].checked&&!$(".sounds").data("ding_sound")&&$(".sounds").data("ding_sound",new Audio("/sound/ding.wav")),Wt.buzz(Xt.qid,function(t){if("http://www.whosawesome.com/"===t){if($(".guess_input").removeClass("disabled"),$(".sounds")[0].checked&&$(".sounds").data("ding_sound").play(),window._gaq)return _gaq.push(["_trackEvent","Game","Response Latency","Buzz Accepted",new Date-e])}else if($t(""),window._gaq)return _gaq.push(["_trackEvent","Game","Response Latency","Buzz Rejected",new Date-e])})}),$(".reset-score .btn").click(function(){return Wt.score()>50?i.confirm("Are you sure you want to reset your score?",function(e){return e?Wt.reset_score():void 0}):Wt.reset_score()}),$(".lose-command").click(function(){return Wt.cincinnatus()}),$(".pausebtn").click(function(){return vt()?void 0:Xt.time_freeze?Wt.unpause():Wt.pause()}),$(".chat_input").keydown(function(e){var t,n;return 47!==(t=e.keyCode)&&111!==t&&191!==t||0!==$(this).val().length||e.shiftKey||e.preventDefault(),27===(n=e.keyCode)?($(".chat_input").val(""),$(".chat_form").submit()):void 0}),$("input").keydown(function(e){return e.stopPropagation(),$(this).hasClass("disabled")?e.preventDefault():void 0});try{$(".chat_input").typeahead({source:function(){return dt(this.query)},matcher:function(e){return"@"===this.query[0]&&0===e.toLowerCase().indexOf(this.query.toLowerCase())}})}catch(Et){}dt=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,p;a="@"+e.slice(1).split(",").slice(0,-1).join(","),t=function(){var t,n,o,i;for(o=e.slice(1).split(",").slice(0,-1),i=[],t=0,n=o.length;n>t;t++)r=o[t],i.push($.trim(r));return i}(),a.length>1&&(a+=", "),i=["individuals"],c=Xt.users;for(n in c)s=c[n],h=s.name,f.call(i,h)<0&&i.push(s.name),s.team&&(d=s.team,f.call(i,d)<0)&&i.push(s.team);for(p=[],u=0,l=i.length;l>u;u++)o=i[u],f.call(t,o)<0&&p.push(""+a+o);return p},lt=function(e){var t,n,o,i,r,a,s,u,l;a="@",t=!0,n={},u=Xt.users;for(o in u)l=u[o],r=l.name,s=l.team,n[r]="!@"+o+", ",s||(s="individuals"),n[s]="*@"+s+", ";for(;t===!0;){t=!1,e=e.replace(/^[@\s,]*/g,"");for(r in n)if(i=n[r],e.slice(0,r.length)===r){a+=i,e=e.slice(r.length),t=!0;break}}for(r in n)if(i=n[r],e.slice(0,r.length)===r&&e.length>0){a+=i,e=e.slice(r.length);break}return[a.replace(/[\s,]*$/g,""),e]},yt=!1,gt="",ct="",wt=function(e){var t,n,o;return t=0,n=Math.random().toString(36).slice(2),o=function(){return++t<=e.length?(_({text:e.slice(0,t),session:n,user:"__protobot",done:t===e.length,time:Xt.serverTime()}),setTimeout(o,1e4/(80+50*Math.random()))):void 0},o()},ut=function(e,t){var n,o,i,r,a,s;return e=e.slice(0,1e3),("lobby"===(s=Xt.name)||"b"===s)&&(e=e.slice(0,140)),e.length<15&&/lonely/i.test(e)&&/re |m /i.test(e)&&!/you/i.test(e)&&!yt?(yt=!0,gt=$(".chat_input").data("input_session"),wt("I'm lonely too. Plz talk to meeeee")):yt&&(i=function(e){return e[Math.floor(e.length*Math.random())]},t&&/stahp|stop|not lonely/i.test(e)?(wt("Protobot disengaged. Prepare to languish in your solitude."),yt=!1):"undefined"!=typeof omeglebot_replies&&null!==omeglebot_replies&&gt!==$(".chat_input").data("input_session")&&(e.replace(/[^a-z]/g,"")in omeglebot_replies&&Math.random()>.3?(wt(i(omeglebot_replies[e.replace(/[^a-z]/g,"")])),gt=$(".chat_input").data("input_session")):t&&(Math.random()<.1&&Xt.active_count()>1?wt('Looks like some other people exist. Just say "stahp" if you want me to die in a hole, or if you want to stop sounding schizophrenic.'):(a=i(Object.keys(omeglebot_replies)),a=i(omeglebot_replies[a]),wt(a))))),"@"===e.slice(0,1)&&"@$>"!==e.slice(0,3)&&(r=lt(e),"@"===r[0]?e="@"+r[1]:(o=e.trim().slice(0,e.trim().length-r[1].trim().length).trim(),o!=="@"+(Wt.team||"individuals")&&(ct=o+" "),e=r.join(" "))),n=!1,$(".chat_input").data("cached_session")!==$(".chat_input").data("input_session")&&($(".chat_input").data("cached_session",$(".chat_input").data("input_session")),n=!0),Wt.chat({text:e,session:$(".chat_input").data("input_session"),first:n,done:t})},$(".chat_input").keyup(function(e){var t;if(13!==e.keyCode)return t=$(".chat_input").val(),$(".livechat")[0].checked&&!Wt.muwave&&"@"!==t.slice(0,1)?($(".chat_input").data("sent_typing",""),ut(t,!1)):$(".chat_input").data("sent_typing")!==$(".chat_input").data("input_session")?("@$>"!==t.slice(0,3)&&ut("(typing)",!1),$(".chat_input").data("sent_typing",$(".chat_input").data("input_session"))):void 0}),$(".chat_form").submit(function(e){var t;return $t(""),ut($(".chat_input").val(),!0),e.preventDefault(),t=new Date-$(".chat_input").data("begin_time"),window._gaq?_gaq.push(["_trackEvent","Chat","Typing Time","Posted Message",t]):void 0}),$(".guess_input").keyup(function(e){return 13!==e.keyCode?Wt.guess({text:$(".guess_input").val().slice(0,100),done:!1}):void 0}),$(".guess_form").submit(function(e){return $t(""),Wt.guess({text:$(".guess_input").val().slice(0,100),done:!0}),e.preventDefault()}),$(".prompt_input").keyup(function(e){return 13!==e.keyCode?Wt.guess({text:$(".prompt_input").val().slice(0,140),done:!1}):void 0}),$(".prompt_form").submit(function(e){return $t(""),Wt.guess({text:$(".prompt_input").val().slice(0,140),done:!0}),e.preventDefault()}),$(".textbar-submit").click(function(){return $(this).parents("form").submit()}),ht=!0,$("body").keyup(function(e){var t;return 83===(t=e.keyCode)?ht=!0:void 0}),$("body").keydown(function(e){var t,n,o,i,r,a,s,u,l,c,h,d,f,p;return"chat"===st?$(".chat_input").focus():"guess"===st?$(".guess_input").focus():(50===e.keyCode&&e.shiftKey&&($(".chatbtn").click(),$(".chat_input").focus()),190===e.keyCode&&(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)&&(e.preventDefault(),pt("@$> ")),$(document.activeElement).is(":input")||e.shiftKey||e.ctrlKey||e.metaKey?void 0:(32===e.keyCode?(e.preventDefault(),1===$(".start-page").length?$(".nextbtn").click():$(".buzzbtn").click()):83===(t=e.keyCode)?ht&&(ht=!1,_t()):78===(n=e.keyCode)||74===n?mt():72===(s=e.keyCode)?$("#bookmarks .pager .previous a").click():76===(u=e.keyCode)?$("#bookmarks .pager .next a").click():75===(l=e.keyCode)?$(".bundle:not(.active):first .readout").slideToggle():80===(c=e.keyCode)||82===c?$(".pausebtn").click():47===(h=e.keyCode)||111===h||191===h||67===h||65===h||13===h?(e.preventDefault(),$(".chatbtn").click()):87===(d=e.keyCode)||222===d?(e.preventDefault(),$(".chat_input").val(ct||"@"),pt()):84===(f=e.keyCode)?(e.preventDefault(),$(".chat_input").val("@"+(Wt.team||"individuals")+" "),pt()):70===(p=e.keyCode)?Wt.finish():66===(o=e.keyCode)&&$(".bundle.active .bookmark").click(),("localhost"===location.hostname||"_"===(null!=(i=Wt.id)?i[0]:void 0)||"dev"in location.query)&&(68===(r=e.keyCode)?(Wt.buzz(Xt.qid),Wt.guess({text:Xt.answer.replace(/(\(|\[).*/,"").replace(/\{|\}/g,""),done:!0})):69===(a=e.keyCode)&&(Wt.buzz(Xt.qid),Wt.guess({text:"",done:!0}))),("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.development:void 0)?console.log(e.keyCode):void 0))}),$(".speed").change(function(){var e;return $(".speed").not(this).val($(this).val()),$(".speed").data("last_update",+new Date),e=12e3/Math.round($(this).val()),+$(".speed").val()>$(".speed").prop("max")-10?Wt.set_speed(.1):Wt.set_speed(e)}),$(".categories").change(function(){return Wt.set_category($(".categories").val())}),$(".difficulties").change(function(){return Wt.set_difficulty($(".difficulties").val())}),$("#make_button").click(function(){return"__create"===$("#team_input").val()&&($("#team_input").val("Boxxy"),T()),Wt.set_team($("#team_input").val()),$("#team_modal").data("set_team",!0).modal("hide"),$("#team_input").blur()}),$("#team_modal").on("hidden",function(){return $("#team_modal").data("set_team")?void 0:Wt.set_team(Wt.team)}),$("#team_modal").on("shown",function(){return $("#team_input").focus()}),$("#team_modal form").submit(function(e){return e.preventDefault(),$("#make_button").click()}),$(".teams").change(function(){return"__create"===$(".teams").val()?$("#team_modal").modal("show").data("set_team",!1).find("input").val(Wt.team):Wt.set_team($(".teams").val())}),$(".multibuzz").change(function(){return Wt.set_max_buzz($(".multibuzz")[0].checked?null:1)}),$(".allowskip").change(function(){return Wt.set_skip($(".allowskip")[0].checked)}),$(".allowpause").change(function(){return Wt.set_pause($(".allowpause")[0].checked)}),$(".showbonus").change(function(){return Wt.set_bonus($(".showbonus")[0].checked)}),$(".livechat").change(function(){return Wt.pref("typing",$(".livechat")[0].checked)}),$(".lock").change(function(){return Wt.set_lock($(".lock")[0].checked)}),$(".adhd").change(function(){return Wt.prefs.distraction=$(".adhd")[0].checked,Wt.pref("distraction",Wt.prefs.distraction),Wt.prefs.distraction?($("p.annoying").removeClass("annoying").slideUp("normal",function(){return $(this).addClass("annoying")}),$("body").addClass("distraction"),Wt.prefs.timer_hide?void 0:setTimeout(function(){return $(".timer-widget").addClass("pulse"),setTimeout(function(){return $(".timer-widget").removeClass("pulse")},1500)},500)):($("body").removeClass("distraction"),$("p.annoying").hide().slideDown())}),$(".request-access").click(function(){return Wt.nominate()}),$(".movingwindow").change(function(){return $(".movingwindow")[0].checked?Wt.pref("movingwindow",20):Wt.pref("movingwindow",!1)}),$(".sounds").change(function(){return Wt.pref("sounds",$(".sounds")[0].checked),$(".sounds").data("ding_sound",new Audio("/sound/ding.wav"))}),ft=function(){return window.matchMedia?matchMedia("(max-width: 768px)").matches:!1},Modernizr.touch||ft()||($(".actionbar button").tooltip(),$(".actionbar button").click(function(){return $(".actionbar button").tooltip("hide")}),$("#history, .settings").tooltip({selector:"[rel=tooltip]",placement:function(){return ft()?"error":"left"}})),$("body").click(function(e){return $(".bundle .ruling").tooltip("destroy"),0===$(e.target).parents(".leaderboard, .popover").length?($(".leaderboard tbody tr").popover("destroy"),$(".popover").remove()):void 0}),$(".singleuser").click(function(){var e;return e=!$(".singleuser").data("full"),$(".singleuser").data("full",e),$(".singleuser .stats .full").slideToggle(e)}),$(".show_image").live("click",function(e){return e.preventDefault(),$(this).parent().find(".chat_image").slideToggle()}),$(".username").live("click",function(e){var t;t=Xt.users[$(this).data("id")],t&&(e.shiftKey||e.ctrlKey||e.metaKey)&&(e.preventDefault(),"chat"===st&&"@"===$(".chat_input").val()[0]?-1===$(".chat_input").val().indexOf(t.name)&&$(".chat_input").val($(".chat_input").val().replace("@","@"+t.name+", ")):$(".chat_input").val("@"+t.name+" "),pt())}),$(".banhammer.make-tribunal").live("click",function(e){return e.preventDefault(),Wt.trigger_tribunal($(this).data("id"))}),$(".banhammer.instaban").live("click",function(e){return e.preventDefault(),Wt.ban_user($(this).data("id"))}),$(".banhammer.reprimand").live("click",function(e){return e.preventDefault(),Wt.reprimand({user:$(this).data("id"),reason:$(this).parents(".banham").data("reason")}),Xt.users[$(this).data("id")].__reprimanded=Date.now(),setTimeout(function(){return O()},15e3)}),$(".timer-widget").click(function(){return Wt.prefs.timer_hide=!$(".timer-widget").data("hidden"),X(),Wt.pref("timer_hide",Wt.prefs.timer_hide)}),$(".leaderboard tbody tr").live("click",function(e){var t,n,o,i;return $(this).is(".ellipsis")?(Wt.prefs.leaderboard=!Wt.prefs.leaderboard,Wt.pref("leaderboard",Wt.prefs.leaderboard),Z(),void 0):(o=$(this).data("entity"),e.shiftKey||e.ctrlKey||e.metaKey?(e.preventDefault(),"chat"===st&&"@"===$(".chat_input").val()[0]?-1===$(".chat_input").val().indexOf(o.name)&&$(".chat_input").val($(".chat_input").val().replace("@","@"+o.name+", ")):$(".chat_input").val("@"+o.name+" "),pt(),void 0):(n=null!=(i=$(this).data("popover"))?i.enabled:void 0,t=$(".leaderboard tbody tr").map(function(){var e;return null!=(e=$(this).data("popover"))?e.$tip[0]:void 0}),$(".popover").not(t).fadeOut("fast",function(){return $(this).remove()}),$(".leaderboard tbody tr").popover("destroy"),n?void 0:($(this).popover({placement:ft()?"top":"left",trigger:"manual",title:""+o.name,content:function(){return q(o,!0)}}),$(this).popover("toggle"))))}),Modernizr.touch?($(".show-keyboard").hide(),$(".show-touch").show()):($(".show-keyboard").show(),$(".show-touch").hide()),$(".show-sidebar").click(function(e){return $(".sidebar").toggleClass("shown"),$(".sidebar").hasClass("shown")?($(".show-sidebar i").removeClass("icon-circle-arrow-right"),$(".show-sidebar i").addClass("icon-circle-arrow-left")):($(".show-sidebar i").removeClass("icon-circle-arrow-left"),$(".show-sidebar i").addClass("icon-circle-arrow-right")),e.preventDefault()}),$("body").live("swiperight",function(){return $(".sidebar").addClass("shown")}),$("body").live("swipeleft",function(){return $(".sidebar").removeClass("shown")});var Ct,xt,At,Dt,Tt,Ot,It,St,zt,Ft,jt,Nt,Mt,qt,Lt,Ut,Rt,Ht,Bt,Pt,Yt,Wt,Gt,Kt,Qt,Jt,Vt,Xt,Zt,eo,to,oo,no,ao,ro,f=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},so={}.hasOwnProperty,uo=function(e,t){function n(){this.constructor=e}for(var o in t)so.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},r=[].slice;!function(){return"anachron"in location.query?window.WebSocket=function(){return 0}:void 0}(),function(){var e,t,n,o;try{n=new Date(protobowl_app_build),$("#version").text(""+(n.getMonth()+1)+"/"+n.getDate()+"/"+n.getFullYear()%100+" "+n.getHours()+":"+(n.getMinutes()/100).toFixed(2).slice(2))}catch(i){}try{return t=new Date(protobowl_app_build),e=new Date(protobowl_html_build),o=Math.abs(t-e)}catch(i){}}(),Ht=function(e){var t;return null==e&&(e=function(){}),Ht.initialized?e():(Ht.initialized=!0,t=(("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config["static"]:void 0)||"/")+"offline.js",("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.cache_breaker:void 0)&&(t+="?"+(new Date(protobowl_html_build)-0)),$.ajax({url:t,cache:!0,dataType:"script",success:e}))},Gt=function(){return Ht(function(){var e,t,n,o,i,r;if(e="offline",localStorage.hasOwnProperty("room-"+Xt.name))try{t=JSON.parse(localStorage["room-"+Xt.name]),"temporary"!==t.me_id?(e=t.me_id,Xt.deserialize(t)):t=null}catch(a){}if(Wt.__listeners.joined({id:e,name:"offline user"}),null!=t?t.users:void 0)try{for(r=t.users,o=0,i=r.length;i>o;o++)n=r[o],n.id===e&&Wt.deserialize(n)}catch(a){}return Xt.sync(5),Wt.verb("joined the room"),"undefined"!=typeof Zo&&null!==Zo?Zo():void 0})},setTimeout(function(){return Xt.active_count()<=1&&Math.random()<.001?_({text:'Feeling lonely? Just say "I\'m Lonely" and talk to me!',user:"__protobot",done:!0}):void 0},3e4),setTimeout(function(){return navigator.onLine?D():void 0},6e5),Rt=function(){var e;return e=$("<div>").addClass("alert alert-info"),e.append($("<div>").append("A  ",$('<span class="label label-info">').text("server restart")," will happen momentarily. This may result in a message indicating that you have been disconnected from the server. However, don't panic as a new connection will automatically be established shortly afterwards. ")),w($("<div>").addClass("log doom-notice").append(e))},qt=function(){var e,t;return"undefined"!=typeof Zo&&null!==Zo&&Zo(),$("#reload, #disconnect, #reconnect").hide(),$("#reconnect").show(),(null!=(t=Xt.attempt)?t.user:void 0)!==Wt.id&&(Xt.attempt=null),e=$("<div>").addClass("alert alert-error"),e.append($("<p>").append("You were ",$('<span class="label label-important">').text("disconnected")," from the server for some reason. ",$("<em>").text(new Date))),e.append($("<div>").append("This may be due to a drop in the network 			connectivity or a malfunction in the server. The client will automatically 			attempt to reconnect to the server and in the mean time, the app has automatically transitioned			into <b>offline mode</b>. You can continue playing alone with a limited offline set			of questions without interruption. However, you might want to try <a href=''>reloading</a>.")),w($("<div>").addClass("log disconnect-notice").append(e)),$.getJSON("https://api.github.com/gists/4272390?callback=?",function(e){var t,n,o,i,r,a;
return t=e.data,o=e.meta,"Nothing"!==(i=null!=t?null!=(r=t.files)?null!=(a=r["protobowl-status.html"])?a.content:void 0:void 0:void 0)&&null!==i?(n=$("<div>").addClass("emergency-message"),n.append($("<div>").addClass("alert alert-info").html(t.files["protobowl-status.html"].content)),$(".emergency-message").remove(),$("#history").before(n)):void 0}),Z(),V()},Ut=!1,eo=null,to=0,Mt=null,Kt=function(){var e,t,n,o,i,r,a,s,u,l,c,h,d,p;o=5e3,d="undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.sockets[to]:void 0,l=null,r=null,a=d[0],c=d[1],"sock"in location.query&&(a=location.query.sock),u=function(){var e,t,n,o,i,r,a;t=location.query.id||jQuery.cookie("protocookie"),e=null,("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.auth:void 0)&&(e=jQuery.cookie("protoauth")),"ninja"in location.query&&(r=new XMLHttpRequest,r.open("get",protobowl_config.sockets[0][0]+"stalkermode/ninjacode",!1),r.send(),e=r.responseText),t||(n="",t="PB4CL"+function(){var e,t;for(t=[],o=e=0;8>=e;o=++e)t.push(Math.random().toString(36).slice(2,6));return t}().join(""),jQuery.cookie("protocookie",t));try{i=JSON.parse(localStorage.referrers||"[]")||[],document.referrer&&(a=document.referrer,f.call(i,a)<0)&&i.push(document.referrer),localStorage.referrers=JSON.stringify(i)}catch(s){}return eo.emit("join",{cookie:t,auth:e,question_type:Xt.type,room_name:Xt.name,muwave:"muwave"in location.query,custom_id:location.query.id,referrers:i,version:8}),$(".disconnect-notice, .doom-notice").slideUp(),$("#reload, #disconnect, #reconnect").hide(),$("#disconnect").show()},h=function(e){var t,n,o;eo&&eo!==e&&eo.disconnect(),eo&&eo.removeAllListeners(),eo=e,eo===l?(z({verb:"established a connection to the secure server"}),Mt=c):(Mt=a,eo.socket.options.secure?z({verb:"established a connection to the server (secure)"}):z({verb:"established a connection to the server"})),eo.on("disconnect",function(){return(null!=eo?eo.hide_disconnect:void 0)?void 0:qt()}),o=Wt.__listeners;for(n in o)t=o[n],eo.on(n,t);return u()},e=function(e){return $("#load_error").remove(),eo?eo===e?u():setTimeout(function(){return eo.socket.connected===!0?(e.disconnect(),e.removeAllListeners()):h(e)},2718):h(e)},t=function(e){return e.socket.transport||console.log("ran out of options sir"),console.log("connect fail",e)},p=0,s=0,n=function(){var e;return s++,s===p?("undefined"!=typeof protobowl_config&&null!==protobowl_config?null!=(e=protobowl_config.sockets)?e.length:void 0:void 0)>to+1?(to++,Kt()):(console.log("errythings failed capn"),Gt()):void 0};try{p++,r=io.connect(a||location.hostname,{"connect timeout":o,"force new connection":!0}),r.on("connect",function(){return e(r)}),r.on("connect_failed",function(){return t(r)}),r.on("error",n)}catch(m){i=m,n()}if("http:"===location.protocol&&c)try{return p++,l=io.connect(c,{port:443,"connect timeout":o,"force new connection":!0,secure:!0}),l.on("connect",function(){return e(l)}),l.on("connect_failed",function(){return t(l)}),l.on("error",n)}catch(m){return i=m,n()}},Nt=function(){return null!=eo&&eo.socket.connected},Tt=function(e){function t(){return ro=t.__super__.constructor.apply(this,arguments)}return uo(t,e),t.prototype.online=function(){return this.online_state},t.prototype.emit=function(){var e;return e=1<=arguments.length?r.call(arguments,0):[],this.id===Wt.id?Wt.emit.apply(Wt,e):void 0},t}(d),Ot=function(e){function t(e,n){var o,i,r;t.__super__.constructor.call(this,e,n),this.__listeners={},o=["envelop_action","level","score","metrics","online","active","authorized","emit"];for(r in this)i=this[r],"function"==typeof i&&f.call(o,r)<0&&this.envelop_action(r)}return uo(t,e),t.prototype.emit=function(e,t){return"undefined"!=typeof Mo&&null!==Mo&&Mo()?No(e,t):this.__listeners[e](t)},t.prototype.authorized=function(e){return Nt()?t.__super__.authorized.call(this,e):!0},t.prototype.envelop_action=function(e){return this[e]=function(t,n){var o;return Nt()?eo.emit(e,t,n):"undefined"!=typeof Mo&&null!==Mo&&Mo()?qo(e,t,n):null!=(o=Xt.users[Wt.id])?"function"==typeof o[e]?o[e](t,n):void 0:void 0}},t}(Tt),It=function(e){function t(e){t.__super__.constructor.call(this,e)}return uo(t,e),t.prototype.emit=function(){var e;return e=1<=arguments.length?r.call(arguments,0):[],Wt.emit.apply(Wt,e)},t.prototype.load_questions=function(e){var t=this;return"undefined"!=typeof ei&&null!==ei?ei(e):setTimeout(function(){return t.load_questions(e)},100)},t.prototype.check_answer=function(e,t,n){return checkAnswer(e,t,n)},t.prototype.get_parameters=function(e,t,n){return this.load_questions(function(){return Po(e,t,n)})},t.prototype.count_questions=function(e,t,n,o){return this.load_questions(function(){return Fo(e,t,n,o)})},t.prototype.get_question=function(e){var t=this;return this.load_questions(function(){var n;return n="custom"===t.category?t.distribution:t.category,Yo(t.type,t.difficulty,n,function(t){return e(t||y)})})},t.prototype.deserialize=function(e){var t,n,o,i;n=["users","attempt","generating_question","acl"],i=[];for(t in e)o=e[t],f.call(n,t)<0&&i.push(this[t]=o);return i},t}(m),Xt=new It(location.pathname.replace(/^\/*/g,"").toLowerCase()||"temporary"),Xt.type=2===Xt.name.split("/").length?Xt.name.split("/")[0]:"qb",Wt=new Ot(Xt,"temporary"),function(){var e;return document.title=""+Xt.name+" - Protobowl",e={qb:"Quizbowl",jeopardy:"Jeopardy!",scibowl:"Science Bowl"},Xt.name.split("/").length>1?$("<span>").addClass("label label-info").text(e[Xt.type]||Xt.type.toTitleCase()).insertAfter(".logo").after(" "):void 0}(),Yt=function(e,t){return Wt.__listeners[e]=t},Yt("echo",function(e,t){return t("alive")}),Yt("application_update",function(){return"function"==typeof Oo?Oo():void 0}),Yt("force_application_update",function(){return"function"==typeof Oo?Oo():void 0}),Yt("impending_doom",function(){return Rt()}),Yt("redirect",function(e){return Xt._redirected=!0,window.location=e}),Yt("alert",function(e){return window.alert(e)}),Yt("chat",function(e){return _(e)}),Yt("log",function(e){return z(e)}),Yt("bold",function(e){return v(e)}),Yt("reprimand",function(e){return I(e)}),Yt("debug",function(e){return A(e)}),Yt("sync",function(e){return no(e)}),Yt("throttle",function(){return C("Throttled","The server is ignoring you for a while because you've been doing too many things too quickly. ").addClass("alert-error").insertAfter(".bundle.active .annotations")}),Yt("verify",function(e){return"function"==typeof h?h(e):void 0}),Yt("rename_user",function(e){var t,n;return n=e.old_id,t=e.new_id,Wt.id===n&&(Wt.id=t,Xt.users[Wt.id]=Xt.users[n]),$(".user-"+n).removeClass("user-"+n).addClass("user-"+t),delete Xt.users[n]}),Yt("delete_user",function(e){return delete Xt.users[e],Z()}),Yt("joined",function(e){var t;if("undefined"!=typeof s&&null!==s&&s&&Wt.link(s),Ut=!0,$("#slow").slideUp(),$(".disconnect-notice").slideUp(),Wt.id=e.id,Wt.ip=e.ip,"function"==typeof a&&a(e.ip),Xt.users[Wt.id]=new Tt(Xt,Wt.id),Wt.name=e.name,"_"!==Wt.id[0]&&"temporary"!==Wt.id){t="username"+(("undefined"!=typeof u&&null!==u?u.email:void 0)||"");try{localStorage[t]?e.existing||setTimeout(function(){return Wt.name=localStorage[t],Wt.set_name(Wt.name),$("#username").val(Wt.name)},137):localStorage[t]=e.name}catch(n){}}return e.muwave&&e.muwave<=34&&(window.WebSocket||$(".no-websocket").show(),$("#polling").slideDown()),$(".actionbar button").disable(!1),$("#username").val(Wt.name),$("#username").disable(!1),setTimeout(Ht,100)}),oo=[],Pt=[],Bt=-1,no=function(e){var t,n,o,i,r,a,s,u,l,c,h,d,p,m,g,y;n=["real_time","users"],oo.push(+new Date-e.real_time),jt(),"realm"in e&&e.realm&&f.call(e.realm,Mt)<0&&(null!=(p=e.realm)?p.join(";"):void 0)!==(null!=(m=Xt.realm)?m.join(";"):void 0)&&w($("<div>").html("<strong>Warning</strong> You are currently connected to a server which is not registered as this room's proper realm.").addClass("alert"));for(t in e)l=e[t],f.call(n,t)<0&&(Xt[t]=l);if(Nt()&&("timing"in e||Xt.__last_rate!==Xt.rate)&&(o=function(e,t){var n,o,i,r,a,s;for(o=0,a=[5].concat(e).slice(0,-1),s=[],i=0,r=a.length;r>i;i++)n=a[i],s.push(o+=Math.round(n*t));return s},Xt.cumulative=o(Xt.timing,Xt.rate),Xt.__last_rate=Xt.rate),"users"in e)for(u=["id"],g=e.users,h=0,d=g.length;d>h;h++){s=g[h],s.id in Xt.users||(Xt.users[s.id]=new Tt(Xt,s.id));for(t in s)l=s[t],f.call(u,t)<0&&(Xt.users[s.id][t]=l);if(s.id===Wt.id)for(t in s)l=s[t],f.call(u,t)<0&&(Wt[t]=l)}if($("body").toggleClass("offline",!Nt()),"difficulties"in e&&Q(),X(),J(),O(),Bt!==Xt.time_freeze){for(Bt=Xt.time_freeze,c=Xt.attempt?"starts":"stops",i=Xt.time_freeze-Xt.begin_time,r=0;i>Xt.cumulative[r];)r++;a=$(".bundle.active").data(c)||[],y=r-1,f.call(a,y)<0&&a.push(r-1),$(".bundle.active").data(c,a),it()}return"users"in e?Z():void 0},Yt("finish_question",function(e){var t,n;for(t=e-Xt.begin_time,n=0;t>Xt.cumulative[n];)n++;return $(".bundle.active").data("finish_point",n-1),it()}),Ct=function(e){return zt(e)/e.length},zt=function(e){var t,n,o,i;for(n=0,o=0,i=e.length;i>o;o++)t=e[o],n+=t;return n},St=function(e){var t,n;return n=Ct(e),Math.sqrt(Ct(function(){var o,i,r;for(r=[],o=0,i=e.length;i>o;o++)t=e[o],r.push((t-n)*(t-n));return r}()))},Dt=function(e){var t;return t=e.sort(function(e,t){return e-t}),t[Math.floor(t.length/2)]||0},xt=function(e){var t;return t=e.sort(function(e,t){return e-t}),t[~~(.75*t.length)]-t[~~(.25*t.length)]||0},At=function(e){var t,n;return n=e.sort(function(e,t){return e-t}),Dt(function(){var e,o,i;for(i=[],e=0,o=n.length;o>e;e++)t=n[e],i.push(Math.abs(t-mu));return i}())},jt=function(){var e,t,n,o;return oo=oo.slice(-20),o=Ct(oo),e=function(){var e,n,i;for(i=[],e=0,n=oo.length;n>e;e++)t=oo[e],o>=t&&i.push(t);return i}(),n=Ct(e),o=Ct(e),e=function(){var e,n,i;for(i=[],e=0,n=oo.length;n>e;e++)t=oo[e],o>=t&&i.push(t);return i}(),Xt.sync_offset=Ct(e),$("#sync_offset").text(Xt.sync_offset.toFixed(1)+"±"+St(e).toFixed(1)+" ("+oo.length+")")},$(window).unload(function(){var e;return Xt._redirected?delete localStorage["room-"+Xt.name]:(e=Xt.serialize(),e.me_id=Wt.id,e.archive_time=Date.now(),localStorage["room-"+Xt.name]=JSON.stringify(e))}),Qt=Date.now(),ao=function(){var e,t;if(Nt())return e=36e5,Xt.serverTime()-Wt.last_action>e&&Date.now()-Qt>e&&(eo.disconnect(),i.dialog("<h4>Disconnected for Inactivity</h4> <p>You have been disconnected from the server for an extended period of inactivity.</p> <p>Simply press <span class='label label-info'>Reconnect</span> if you wish to reestablish a connection to the server to resume from the previous state, or press <span class='label'>Cancel</span> if you would like to continue using protobowl offline.</p> ",[{label:"Cancel"},{label:"Reconnect","class":"btn-primary",callback:function(){return eo.socket.reconnect(),Qt=Date.now()}}])),t=+new Date,eo.emit("echo",{},function(e){var n,o;return o=+new Date,n=o-t,Pt.push(n),oo.push(o-e),eo.emit("echo",{avg:Ct(Pt.slice(-10)),std:St(Pt.slice(-10)),n:Pt.length},function(t){var n,i,r;return r=+new Date,n=r-o,i=t-e,oo.push(r-t),Pt.push(i),Pt.push(n),jt(),Pt.length>0?$("#latency").text(Ct(Pt).toFixed(1)+"±"+St(Pt).toFixed(1)+(" ("+Pt.length+")")):void 0})})},setTimeout(function(){var e;return e=function(){var t;return ao(),t=3e4,Wt.muwave&&(t=18e4),setTimeout(e,t)},e()},8e3),Vt=[],Lt=function(e,t){return Vt.push([e,t]),"function"==typeof jo?jo():void 0},Zt=function(e,t){return console.log("setting book",e,t),Lt(e,function(n){return n?(n.bookmarked=t,n.modified=Date.now(),Co.put(n,function(){return Ft(e),"function"==typeof li?li():void 0},Wo)):console.log("question not found (set bookmark)",e)})},Ft=function(e){return Lt(e,function(t){var n,o;return t?(n=t.bookmarked,o=$(".qid-"+e).toggleClass("bookmarked",!!n).toggleClass("bookmark-2",2===n).toggleClass("bookmark-3",3===n).toggleClass("bookmark-4",n>=4),o.find(".bookmark").toggleClass("icon-star-empty",!n).toggleClass("icon-star",!!n)):void 0})},Jt=function(e,t){var n;return null==t&&(t={}),n=document.getElementById("_"+e),n||(n=$("<div>").attr("id","_"+e)),$(n).empty().append(jade[e](t))},function(){var e,t;return null!=document.hidden?(t="hidden",e="visibilitychange"):null!=document.mozHidden?(t="mozHidden",e="mozvisibilitychange"):null!=document.msHidden?(t="msHidden",e="msvisibilitychange"):null!=document.webkitHidden&&(t="webkitHidden",e="webkitvisibilitychange"),t?document.addEventListener(e,function(){return Wt.muwave?void 0:Wt.set_idle(document[t])},!1):void 0}(),"onLine"in navigator&&navigator.onLine===!1||"undefined"==typeof io||null===io||("undefined"!=typeof protobowl_config&&null!==protobowl_config?protobowl_config.offline:void 0)?Gt():(Kt(),setTimeout(function(){return Ut?void 0:$("#slow").slideDown()},3e3),setTimeout(Ht,2e3)),$("#load_error").remove(),$("#disconnect").click(function(e){return eo.disconnect(),e.preventDefault()}),$("#reconnect").click(function(e){return eo.socket.reconnect(),e.preventDefault()});